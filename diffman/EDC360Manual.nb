(* Content-type: application/mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 7.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       145,          7]
NotebookDataLength[    365271,      11957]
NotebookOptionsPosition[    315419,      10645]
NotebookOutlinePosition[    340315,      11124]
CellTagsIndexPosition[    340272,      11121]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
\t 
\
\>", "Text"],

Cell[CellGroupData[{

Cell["\<\
Exterior Differential Calculus
and
Symbolic Matrix Algebra\
\>", "Text",
 ShowGroupOpener->True,
 TextAlignment->Center,
 TextJustification->0,
 FontFamily->"Times",
 FontSize->36,
 FontWeight->"Bold",
 FontSlant->"Italic",
 FontColor->GrayLevel[1],
 Background->RGBColor[0, 0, 1]],

Cell["\<\

version 3.6.0 - May 2007\
\>", "Text",
 TextAlignment->Center,
 TextJustification->0,
 FontSlant->"Italic"],

Cell[TextData[{
 StyleBox["\n",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 ButtonBox["S. Bonanos",
  BaseStyle->"Hyperlink",
  ButtonData:>{
    URL["http://www.inp.demokritos.gr/~sbonano/SB.html"], None}],
 StyleBox["\n",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["\n",
  FontWeight->"Bold"],
 StyleBox[ButtonBox["Institute of Nuclear Physics",
  BaseStyle->"Hyperlink",
  ButtonData:>{
    URL["http://www.inp.demokritos.gr/"], None}],
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[",  ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[ButtonBox["NCSR \"Demokritos\"",
  BaseStyle->"Hyperlink",
  ButtonData:>{
    URL["http://www.demokritos.gr/index_muk.asp"], None}],
  FontSlant->"Italic"],
 StyleBox[", \nAghia Paraskevi 15310, Greece. ",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["\n",
  FontSize->14,
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox["\n",
  FontWeight->"Bold"],
 "Please send comments, suggestions, bug reports to:  ",
 ButtonBox["sbonano@inp.demokritos.gr",
  BaseStyle->"Hyperlink",
  ButtonData:>{
    URL["mailto:sbonano@inp.demokritos.gr"], None}],
 StyleBox[" \t",
  FontWeight->"Bold"]
}], "Text",
 TextAlignment->Center,
 TextJustification->0,
 FontFamily->"Times",
 FontSize->16]
}, Closed]],

Cell["\<\

\
\>", "Text"],

Cell[CellGroupData[{

Cell["Overview", "Text",
 ShowGroupOpener->True,
 FontFamily->"Times",
 FontSize->24,
 FontWeight->"Bold",
 FontSlant->"Italic",
 FontColor->GrayLevel[1],
 Background->RGBColor[0, 0, 1]],

Cell[TextData[{
 "\n\tThis package enables ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " to carry out calculations with differential forms. It defines the two \
basic operations - ",
 StyleBox["Exterior Product",
  FontWeight->"Bold"],
 " ",
 StyleBox["(Wedge)",
  FontWeight->"Bold"],
 " and ",
 StyleBox["Exterior Derivative (d)",
  FontWeight->"Bold"],
 " - in such a way that:\n (1)  they can act on any valid ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " expression\n (2)  they allow the use of any symbols to denote differential \
forms\n (3)  input - output notation is as close as possible to standard usage"
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->16],

Cell[TextData[{
 " \tThere are two versions of this package: ",
 StyleBox["scalarEDCcode.nb",
  FontWeight->"Bold"],
 " and ",
 StyleBox["matrixEDCcode.nb",
  FontWeight->"Bold"],
 ". The first can handle scalar differential-form expressions only, while the \
second can also handle matrix-valued differential forms, i.e., matrices whose \
components are (scalar) differential forms.  ",
 StyleBox["matrixEDCcode.nb",
  FontWeight->"Bold"],
 " can be used for calculations with scalar forms, but it is  ~15% slower \
than  ",
 StyleBox["scalarEDCcode.nb",
  FontWeight->"Bold"],
 ".\n \tThe matrix package, allowing user-controlled application of trace \
identities and the Cayley-Hamilton theorem, can also be used for symbolic \
matrix calculations (see sample calculations (2) and (3) in the last section)."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->16],

Cell[TextData[{
 "  \tFor exterior multiplication we use the infix operator symbol \[Wedge] \
(Wedge). This symbol is included in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " (see Sections 3.10.1, 3.10.4) but does not have a pre\[Hyphen]defined \
meaning. It can be input by typing  \[EscapeKey] ^ \[EscapeKey]  (where ^ is \
the symbol for exponent) or  \\ [Wedge] (without space after \\). Finally, it \
can be input by clicking the appropriate button in the notebook ",
 StyleBox["SymbolPalette.nb. \n  \t",
  FontWeight->"Bold"],
 "The same symbol (instead of Dot) is used to denote matrix multiplication."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->16],

Cell[TextData[{
 "\tAll expressions are treated as sums of terms, which may have factors that \
are special symbols (declared by the user as denoting differential forms or \
matrices) or have ",
 StyleBox["Head",
  FontFamily->"Courier"],
 " ",
 StyleBox["Wedge",
  FontWeight->"Bold"],
 " or ",
 StyleBox["d",
  FontWeight->"Bold"],
 ", and rules are given for manipulating such expressions. ",
 StyleBox["All other (undeclared) symbols are treated as scalar 0-forms",
  FontSlant->"Italic"],
 ". The ordering of terms in an expression is determined by the built-in ",
 StyleBox["Mathematica",
  FontSlant->"Italic"],
 " rules for ",
 StyleBox["Plus",
  FontFamily->"Courier"],
 " and ",
 StyleBox["Times",
  FontFamily->"Courier"],
 ", which sometimes results in an unexpected ordering of terms. ",
 StyleBox["All terms in a sum, and all components of a matrix, must be of the \
same (differential-form) degree.",
  FontSlant->"Italic"]
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->16],

Cell[TextData[{
 "\t",
 StyleBox["Warning",
  FontWeight->"Bold"],
 ": The executable cells in this Manual must be evaluated ",
 StyleBox["in the order they appear",
  FontSlant->"Italic"],
 ", after evaluating ",
 StyleBox["matrixEDCcode.nb",
  FontWeight->"Bold"],
 " first."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->16],

Cell[TextData[{
 StyleBox["Important Note",
  FontWeight->"Bold"],
 ": The notebooks are in the form of \"open code\", and the many global \
variables introduced are not protected. This is intentional, in order to \
allow the user to add new definitions on the fly, as required in a \
calculation, without having to go through ",
 StyleBox["Unprotect",
  FontFamily->"Courier"],
 ". However, it also carries the danger that an unprotected symbol might be \
used in a way that was not intended.",
 StyleBox[" If one obtains results that don't make sense, it is most likely \
that some global variable is used inappropriately (e.g.,  a symbol, declared \
to represent a matrix, is used in a later calculation as a scalar).  ",
  FontSlant->"Italic"],
 "Reevaluating the relevant EDCcode.nb notebook clears all variables and \
allows a fresh start."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->16],

Cell[TextData[{
 "\t",
 StyleBox["Acknowledgement",
  FontWeight->"Bold"],
 ": I wish to thank ",
 ButtonBox["Wolfram Research",
  BaseStyle->"Hyperlink",
  ButtonData:>{
    URL["http://www.wolfram.com/"], None}],
 " for a ",
 ButtonBox["Visiting Scholar Grant",
  BaseStyle->"Hyperlink",
  ButtonData:>{
    URL["http://www.wolfram.com/company/opportunities/"], None}],
 ", during which version 2.6.1 of this package was developed."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->16],

Cell[TextData[{
 StyleBox["\tThe present version - 3.6.0 - is an update to make EDC \
compatible with Mathematica 6. See version history in the ",
  FontSlant->"Italic"],
 StyleBox[ButtonBox["EDC web page",
  BaseStyle->"Hyperlink",
  ButtonData:>{
    URL["http://www.inp.demokritos.gr/~sbonano/EDC/"], None}],
  FontSlant->"Italic"],
 "."
}], "Text",
 FontSize->16]
}, Open  ]],

Cell["\<\

\
\>", "Text"],

Cell[CellGroupData[{

Cell["scalarEDC", "Text",
 ShowGroupOpener->True,
 FontFamily->"Times",
 FontSize->24,
 FontWeight->"Bold",
 FontSlant->"Italic",
 FontColor->GrayLevel[1],
 Background->RGBColor[0, 0, 1]],

Cell[TextData[{
 "\n\t",
 StyleBox["The notebook ",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["scalarEDCcode.nb",
  FontWeight->"Bold",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[" allows calculations with scalar differential forms only. The \
following functions / operations are defined (examples are given in the cells \
in brackets. Sections marked by  \[FilledSquare]  can be skipped on a first \
reading):",
  FontColor->RGBColor[0, 0, 1]]
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Wedge",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_,y_,...] ",
  FontFamily->"Courier"],
 " or  ",
 StyleBox[" x_\[Wedge]y_\[Wedge]...",
  FontFamily->"Courier"],
 " :: gives the exterior product of the expressions ",
 StyleBox["x,y,... Wedge",
  FontFamily->"Courier"],
 " reduces to",
 StyleBox[" Times",
  FontFamily->"Courier"],
 " when acting on 0-forms."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Wedge", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"2", "a", " ", 
     RowBox[{"d", "[", "x", "]"}]}], "+", 
    RowBox[{"3", "b", " ", 
     RowBox[{"d", "[", "y", "]"}]}], "+", 
    RowBox[{"5", "c", " ", 
     RowBox[{"d", "[", "z", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"a", " ", "x"}], "+", 
      RowBox[{"b", " ", "y"}]}], "]"}], 
    RowBox[{"d", "[", "y", "]"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "a", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "y", "]"}]}]}], "-", 
  RowBox[{"5", " ", "c", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "z", "]"}]}]}]}]], "Output",
 CellChangeTimes->{3.5746412573037443`*^9, 3.574641545277215*^9}]
}, Open  ]],

Cell[TextData[{
 "Note that Wedge products are ordered alphabetically.  Instead of ",
 StyleBox["Wedge[...]",
  FontFamily->"Courier"],
 " one can use the infix symbol ",
 StyleBox["\[Wedge]",
  FontFamily->"Courier"],
 ":"
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"2", "a", " ", 
     RowBox[{"d", "[", "x", "]"}]}], "+", 
    RowBox[{"3", "b", " ", 
     RowBox[{"d", "[", "y", "]"}]}], "+", 
    RowBox[{"5", "c", " ", 
     RowBox[{"d", "[", "z", "]"}]}]}], ")"}], 
  StyleBox["\[Wedge]",
   FontFamily->"Courier"], 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Cos", "[", 
     RowBox[{
      RowBox[{"a", " ", "x"}], "+", 
      RowBox[{"b", " ", "y"}]}], "]"}], 
    RowBox[{"d", "[", "y", "]"}]}], ")"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", "a", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "y", "]"}]}]}], "-", 
  RowBox[{"5", " ", "c", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "z", "]"}]}]}]}]], "Output",
 CellChangeTimes->{3.574641257498953*^9, 3.574641545388259*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["d",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 " :: gives the exterior derivative of the expression ",
 StyleBox["x",
  FontFamily->"Courier"],
 ", assuming all symbols are variable."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d", "/@", 
  RowBox[{"{", 
   RowBox[{"A", ",", 
    RowBox[{"A", "[", "0", "]"}], ",", 
    RowBox[{"A", "[", "x", "]"}], ",", 
    RowBox[{
     RowBox[{"A", "[", "2", "]"}], "[", 
     RowBox[{"x", ",", "y"}], "]"}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"d", "[", "A", "]"}], ",", 
   RowBox[{"d", "[", 
    RowBox[{"A", "[", "0", "]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"d", "[", "x", "]"}], " ", 
    RowBox[{
     SuperscriptBox["A", "\[Prime]",
      MultilineFunction->None], "[", "x", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "[", "y", "]"}], " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"A", "[", "2", "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"d", "[", "x", "]"}], " ", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"A", "[", "2", "]"}], 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"x", ",", "y"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.574641257533308*^9, 3.5746415454272537`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d", "[", "%%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"2", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "a", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "y", "]"}]}]}], "-", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "a", " ", "x", " ", 
      RowBox[{
       RowBox[{"d", "[", "a", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "y", "]"}]}]}], "+", 
     RowBox[{"2", " ", "a", " ", "y", " ", 
      RowBox[{
       RowBox[{"d", "[", "b", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "y", "]"}]}]}]}], ")"}]}], "-", 
  RowBox[{"5", " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "c", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "z", "]"}]}]}], "-", 
  RowBox[{
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "5"}], " ", "c", " ", "x", " ", 
      RowBox[{
       RowBox[{"d", "[", "a", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "z", "]"}]}]}], "-", 
     RowBox[{"5", " ", "c", " ", "y", " ", 
      RowBox[{
       RowBox[{"d", "[", "b", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "z", "]"}]}]}], "-", 
     RowBox[{"5", " ", "a", " ", "c", " ", 
      RowBox[{
       RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "z", "]"}]}]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.574641257564774*^9, 3.574641545470469*^9}]
}, Open  ]],

Cell["Constants must be explicitly declared:", "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "a", "]"}], "=", "0"}], ";", 
  RowBox[{
   RowBox[{"d", "[", "b", "]"}], "=", "0"}], ";", "%"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "5"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "c", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "z", "]"}]}]}], "+", 
  RowBox[{"5", " ", "a", " ", "c", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "z", "]"}]}]}]}]], "Output",
 CellChangeTimes->{3.574641257595793*^9, 3.574641545559065*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d", "[", 
  RowBox[{"x", "^", "n"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"n", " ", 
   SuperscriptBox["x", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "n"}]], " ", 
   RowBox[{"d", "[", "x", "]"}]}], "+", 
  RowBox[{
   SuperscriptBox["x", "n"], " ", 
   RowBox[{"d", "[", "n", "]"}], " ", 
   RowBox[{"Log", "[", "x", "]"}]}]}]], "Output",
 CellChangeTimes->{3.57464125763169*^9, 3.5746415456267643`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "n", "]"}], "=", "0"}], ";", "%"}]], "Input"],

Cell[BoxData[
 RowBox[{"n", " ", 
  SuperscriptBox["x", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "n"}]], " ", 
  RowBox[{"d", "[", "x", "]"}]}]], "Output",
 CellChangeTimes->{3.5746412576848783`*^9, 3.57464154568921*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["reWrite",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 " :: rewrites the expression ",
 StyleBox["x,",
  FontFamily->"Courier"],
 " collecting together all terms having identical ",
 StyleBox["Wedge[_]",
  FontFamily->"Courier"],
 " or ",
 StyleBox["d[_]",
  FontFamily->"Courier"],
 " factors, applies the simplification rules defined in the list ",
 StyleBox["simpRules", "Inputt",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 ", and factors the coefficient of each such ",
 StyleBox["Wedge[_]",
  FontFamily->"Courier"],
 " or ",
 StyleBox["d[_]",
  FontFamily->"Courier"],
 " term. In complicated expressions, one can define a set of variables in the \
list ",
 StyleBox["varList", "Inputt",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 " to be used to collect terms in these coefficients so as to further \
simplify the result - see next section. ",
 StyleBox["The proper choice of rules in ",
  FontSlant->"Italic"],
 StyleBox["simpRules",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[" and of variables in ",
  FontSlant->"Italic"],
 StyleBox["varList",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[" is crucial for the effective simplification of complicated \
expressions",
  FontSlant->"Italic"],
 ". The default values of the global variables ",
 StyleBox["simpRules",
  FontFamily->"Courier"],
 " and ",
 StyleBox["varList",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 " are: ",
 Cell[BoxData[
  RowBox[{"simpRules", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x_.", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "z_", "]"}], "2"]}], "+", 
      RowBox[{"x_.", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "z_", "]"}], "2"]}]}], "->", "x"}], "}"}]}]]],
 "; ",
 StyleBox["varList = {}",
  FontFamily->"Courier"],
 StyleBox[";", "OutputL"]
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"%%%", "-", 
   RowBox[{"3", "%%%", "*", 
    RowBox[{"a", "/", "5"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "5"}], "+", 
     RowBox[{"3", " ", "a"}]}], ")"}], " ", 
   RowBox[{"Cos", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "c", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "z", "]"}]}]}], "-", 
  RowBox[{"a", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "5"}], "+", 
     RowBox[{"3", " ", "a"}]}], ")"}], " ", "c", " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     RowBox[{"a", " ", "x"}], "+", 
     RowBox[{"b", " ", "y"}]}], "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "z", "]"}]}]}]}]], "Output",
 CellChangeTimes->{3.574641257718877*^9, 3.574641545768223*^9}]
}, Open  ]],

Cell[TextData[{
 "Another application of ",
 StyleBox["reWrite",
  FontFamily->"Courier"],
 ", where the default value of ",
 StyleBox["simpRules",
  FontFamily->"Courier"],
 " is applied: "
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
   RowBox[{"d", "[", "y", "]"}], "\[Wedge]", 
   RowBox[{"d", "[", "z", "]"}]}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", "->", 
     RowBox[{"r", " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Cos", "[", "\[Phi]", "]"}]}]}], ",", 
    RowBox[{"y", "->", 
     RowBox[{"r", " ", 
      RowBox[{"Sin", "[", "\[Theta]", "]"}], 
      RowBox[{"Sin", "[", "\[Phi]", "]"}]}]}], ",", 
    RowBox[{"z", "->", 
     RowBox[{"r", " ", 
      RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["r", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Phi]", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "r", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "\[Theta]", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "\[Phi]", "]"}]}]}], "+", 
  RowBox[{
   SuperscriptBox["r", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Phi]", "]"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "3"], " ", 
   RowBox[{
    RowBox[{"d", "[", "r", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "\[Theta]", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "\[Phi]", "]"}]}]}], "+", 
  RowBox[{
   SuperscriptBox["r", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"], " ", 
   RowBox[{
    RowBox[{"d", "[", "r", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "\[Theta]", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "\[Phi]", "]"}]}]}], "+", 
  RowBox[{
   SuperscriptBox["r", "2"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Theta]", "]"}], "3"], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Phi]", "]"}], "2"], " ", 
   RowBox[{
    RowBox[{"d", "[", "r", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "\[Theta]", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "\[Phi]", "]"}]}]}]}]], "Output",
 CellChangeTimes->{3.57464125776519*^9, 3.574641545805747*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["r", "2"], " ", 
  RowBox[{"Sin", "[", "\[Theta]", "]"}], " ", 
  RowBox[{
   RowBox[{"d", "[", "r", "]"}], "\[Wedge]", 
   RowBox[{"d", "[", "\[Theta]", "]"}], "\[Wedge]", 
   RowBox[{"d", "[", "\[Phi]", "]"}]}]}]], "Output",
 CellChangeTimes->{3.574641257797474*^9, 3.574641545840489*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox[" ", "Text",
  FontFamily->"Times",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["The use of ", "Text",
  FontFamily->"Times",
  FontSlant->"Italic"],
 StyleBox["varList", "Text",
  FontFamily->"Courier",
  FontSlant->"Italic"],
 StyleBox[" ", "Text",
  FontFamily->"Times",
  FontWeight->"Plain"]
}], "Subsubsection"],

Cell[TextData[{
 "\tSuppose the function  ",
 StyleBox["g",
  FontFamily->"Courier"],
 "  of ",
 StyleBox["x,",
  FontFamily->"Courier"],
 " ",
 StyleBox["y,",
  FontFamily->"Courier"],
 " ",
 StyleBox["z",
  FontFamily->"Courier"],
 "  is known to depend on ",
 StyleBox["x,",
  FontFamily->"Courier"],
 " ",
 StyleBox["y",
  FontFamily->"Courier"],
 " through the two particular combinations - \n",
 StyleBox["(x",
  FontFamily->"Courier"],
 " ",
 StyleBox["+",
  FontFamily->"Courier"],
 " ",
 StyleBox["y)/(",
  FontFamily->"Courier"],
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["x", "2"], "+", 
   SuperscriptBox["y", "2"]}]]],
 StyleBox[")",
  FontFamily->"Courier"],
 " and ",
 StyleBox["(x",
  FontFamily->"Courier"],
 " ",
 StyleBox["y",
  FontFamily->"Courier"],
 " ",
 StyleBox["+",
  FontFamily->"Courier"],
 " ",
 StyleBox["1)/(",
  FontFamily->"Courier"],
 Cell[BoxData[
  RowBox[{
   SuperscriptBox["x", "2"], "+", 
   SuperscriptBox["y", "2"]}]]],
 StyleBox[")",
  FontFamily->"Courier"],
 " -  and ",
 StyleBox["g",
  FontFamily->"Courier"],
 " is written with these as arguments. Then"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dg", "=", 
  RowBox[{"d", "[", 
   RowBox[{"g", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "+", "y"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"x", " ", "y"}], " ", "+", "1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"]}], ")"}]}], ",", "z"}], "]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "z", "]"}], " ", 
   RowBox[{
    SuperscriptBox["g", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{
     FractionBox[
      RowBox[{"x", "+", "y"}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", 
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{"x", " ", "y"}]}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"y", " ", 
       RowBox[{"d", "[", "x", "]"}]}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], "+", 
     FractionBox[
      RowBox[{"x", " ", 
       RowBox[{"d", "[", "y", "]"}]}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", "x", " ", 
        RowBox[{"d", "[", "x", "]"}]}], "+", 
       RowBox[{"2", " ", "y", " ", 
        RowBox[{"d", "[", "y", "]"}]}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], ")"}], "2"]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["x", "2"], " ", "y", " ", 
        RowBox[{"d", "[", "x", "]"}]}], "+", 
       RowBox[{"2", " ", "x", " ", 
        SuperscriptBox["y", "2"], " ", 
        RowBox[{"d", "[", "y", "]"}]}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], ")"}], "2"]]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["g", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "1", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{
     FractionBox[
      RowBox[{"x", "+", "y"}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", 
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{"x", " ", "y"}]}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"d", "[", "x", "]"}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], "+", 
     FractionBox[
      RowBox[{"d", "[", "y", "]"}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["x", "2"], " ", 
        RowBox[{"d", "[", "x", "]"}]}], "+", 
       RowBox[{"2", " ", "x", " ", "y", " ", 
        RowBox[{"d", "[", "y", "]"}]}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], ")"}], "2"]], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", "x", " ", "y", " ", 
        RowBox[{"d", "[", "x", "]"}]}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["y", "2"], " ", 
        RowBox[{"d", "[", "y", "]"}]}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], ")"}], "2"]]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["g", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"1", ",", "0", ",", "0"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{
     FractionBox[
      RowBox[{"x", "+", "y"}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", 
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{"x", " ", "y"}]}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.574641257831744*^9, 3.574641545896208*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", "dg", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "z", "]"}], " ", 
   RowBox[{
    SuperscriptBox["g", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{
     FractionBox[
      RowBox[{"x", "+", "y"}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", 
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{"x", " ", "y"}]}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
  RowBox[{
   FractionBox["1", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}], ")"}], "2"]], 
   RowBox[{
    RowBox[{"d", "[", "y", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["x", "3"], " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "+", "y"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "-", 
      RowBox[{"2", " ", "y", " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "+", "y"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "-", 
      RowBox[{"x", " ", 
       SuperscriptBox["y", "2"], " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "+", "y"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["x", "2"], " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "+", "y"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "-", 
      RowBox[{"2", " ", "x", " ", "y", " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "+", "y"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["y", "2"], " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "+", "y"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}]}], ")"}]}]}], "-", 
  RowBox[{
   FractionBox["1", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}], ")"}], "2"]], 
   RowBox[{
    RowBox[{"d", "[", "x", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "x", " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "+", "y"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["x", "2"], " ", "y", " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "+", "y"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["y", "3"], " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "+", "y"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
      RowBox[{
       SuperscriptBox["x", "2"], " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "+", "y"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
      RowBox[{"2", " ", "x", " ", "y", " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "+", "y"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "-", 
      RowBox[{
       SuperscriptBox["y", "2"], " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "+", "y"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{3.574641257867437*^9, 3.5746415459408693`*^9}]
}, Open  ]],

Cell[TextData[{
 "Note that ",
 StyleBox["reWrite",
  FontFamily->"Courier"],
 " collects together all terms having  ",
 StyleBox["d[x],",
  FontFamily->"Courier"],
 " ",
 StyleBox["d[y]",
  FontFamily->"Courier"],
 " as factors, but it does not group together terms with the same derivatives \
of ",
 StyleBox["g",
  FontFamily->"Courier"],
 " in the coefficients of ",
 StyleBox["d[x],",
  FontFamily->"Courier"],
 " ",
 StyleBox["d[y]",
  FontFamily->"Courier"],
 ". Therefore, choose"
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"varList", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Derivative", "[", "__", "]"}], "[", "g", "]"}], "[", "__", 
     "]"}], "}"}]}], ";"}]], "Input"],

Cell[TextData[{
 "Now ",
 StyleBox["reWrite",
  FontFamily->"Courier"],
 " gives:"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", "dg", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "z", "]"}], " ", 
   RowBox[{
    SuperscriptBox["g", 
     TagBox[
      RowBox[{"(", 
       RowBox[{"0", ",", "0", ",", "1"}], ")"}],
      Derivative],
     MultilineFunction->None], "[", 
    RowBox[{
     FractionBox[
      RowBox[{"x", "+", "y"}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", 
     FractionBox[
      RowBox[{"1", "+", 
       RowBox[{"x", " ", "y"}]}], 
      RowBox[{
       SuperscriptBox["x", "2"], "+", 
       SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], "+", 
  RowBox[{
   RowBox[{"d", "[", "y", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "3"], "-", 
         RowBox[{"2", " ", "y"}], "-", 
         RowBox[{"x", " ", 
          SuperscriptBox["y", "2"]}]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"0", ",", "1", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "+", "y"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], ")"}], "2"]], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "-", 
         RowBox[{"2", " ", "x", " ", "y"}], "-", 
         SuperscriptBox["y", "2"]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "+", "y"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], ")"}], "2"]]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"d", "[", "x", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "x"}], "+", 
          RowBox[{
           SuperscriptBox["x", "2"], " ", "y"}], "-", 
          SuperscriptBox["y", "3"]}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["g", 
          TagBox[
           RowBox[{"(", 
            RowBox[{"0", ",", "1", ",", "0"}], ")"}],
           Derivative],
          MultilineFunction->None], "[", 
         RowBox[{
          FractionBox[
           RowBox[{"x", "+", "y"}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", 
          FractionBox[
           RowBox[{"1", "+", 
            RowBox[{"x", " ", "y"}]}], 
           RowBox[{
            SuperscriptBox["x", "2"], "+", 
            SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["x", "2"], "+", 
          SuperscriptBox["y", "2"]}], ")"}], "2"]]}], "-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         RowBox[{"2", " ", "x", " ", "y"}], "-", 
         SuperscriptBox["y", "2"]}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["g", 
         TagBox[
          RowBox[{"(", 
           RowBox[{"1", ",", "0", ",", "0"}], ")"}],
          Derivative],
         MultilineFunction->None], "[", 
        RowBox[{
         FractionBox[
          RowBox[{"x", "+", "y"}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", 
         FractionBox[
          RowBox[{"1", "+", 
           RowBox[{"x", " ", "y"}]}], 
          RowBox[{
           SuperscriptBox["x", "2"], "+", 
           SuperscriptBox["y", "2"]}]], ",", "z"}], "]"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"]}], ")"}], "2"]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.574641257928627*^9, 3.57464154601998*^9}]
}, Open  ]],

Cell["Verify that it is a closed form:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"d", "[", "%", "]"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.5746412579651833`*^9, 3.574641546081607*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"varList", "=", 
   RowBox[{"{", "}"}]}], ";"}]], "Input"]
}, Open  ]],

Cell[TextData[{
 StyleBox["FormDegree",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 ":: returns the (differential-form) degree of the expression ",
 StyleBox["x",
  FontFamily->"Courier"],
 ". It assumes that all terms in a sum have the same degree."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["DeclareForms",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[{p1_,x__},{p2_,y__},...]",
  FontFamily->"Courier"],
 " :: allows the user to introduce his particular notation for fundamental \
(undefined) p-forms. ",
 StyleBox["p1, p2",
  FontFamily->"Courier"],
 " must be positive integers (denoting the degree of the differential form(s) \
",
 StyleBox["x__, y__",
  FontFamily->"Courier"],
 ") and ",
 StyleBox["x__, y__",
  FontFamily->"Courier"],
 "  sequences of one or more symbols separated by commas. For example, \
evaluating the command ",
 StyleBox["DeclareForms[{1,a1,q[_]},{2,a2,b2,c2}]",
  FontFamily->"Courier"],
 " implies that, in all subsequent calculations, the symbols ",
 StyleBox["a1,",
  FontFamily->"Courier"],
 " ",
 StyleBox["q[1],",
  FontFamily->"Courier"],
 " ",
 StyleBox["q[2]",
  FontFamily->"Courier"],
 ",  etc., will be treated as 1-forms and the symbols ",
 StyleBox["a2,",
  FontFamily->"Courier"],
 " ",
 StyleBox["b2,",
  FontFamily->"Courier"],
 " ",
 StyleBox["c2",
  FontFamily->"Courier"],
 "  as 2-forms. If only forms of the same degree are introduced, the curly \
brackets can be omitted: ",
 StyleBox["DeclareForms[1,a1,q[_]]",
  FontFamily->"Courier"],
 " is the same as ",
 StyleBox["DeclareForms[{1,a1,q[_]}]",
  FontFamily->"Courier"],
 ". ",
 StyleBox["DeclareForms",
  FontFamily->"Courier"],
 " also assigns the appropriate ",
 StyleBox["FormDegree",
  FontFamily->"Courier"],
 " to the newly introduced forms, and makes appropriate changes to other \
internal variables.",
 StyleBox[" All other undefined symbols are treated as scalars (0-forms)",
  FontSlant->"Italic"],
 ". \n",
 StyleBox["Note",
  FontWeight->"Bold"],
 ": Only ",
 StyleBox["undefined",
  FontSlant->"Italic"],
 " symbols should be declared as forms using ",
 StyleBox["DeclareForms",
  FontFamily->"Courier"],
 ". If all forms are expressed in terms of the coordinate differentials (",
 StyleBox["d[x]", "OutputL"],
 ", ",
 StyleBox["d[x]\[Wedge]d[y]", "OutputL"],
 ", etc.) ",
 StyleBox["DeclareForms",
  FontFamily->"Courier"],
 " should not be used.",
 StyleBox[" The effects of ",
  FontSlant->"Italic"],
 StyleBox["DeclareForms",
  FontFamily->"Courier",
  FontSlant->"Italic"],
 StyleBox["  cannot be undone",
  FontSlant->"Italic"],
 "."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[BoxData[
 StyleBox[
  RowBox[{"DeclareForms", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "a1", ",", 
      RowBox[{"q", "[", "_", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"2", ",", "a2", ",", "b2", ",", "c2"}], "}"}]}], "]"}],
  FontFamily->"Courier"]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"q", "[", "1", "]"}], "\[Wedge]", "a1"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{"a1", "\[Wedge]", 
    RowBox[{"q", "[", "1", "]"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.5746412580650787`*^9, 3.5746415461722717`*^9}]
}, Open  ]],

Cell[TextData[{
 "Wedge orders forms in canonical order ",
 StyleBox["by degree",
  FontSlant->"Italic"],
 " (lower order forms first):"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"c2", "\[Wedge]", "%", "\[Wedge]", "a2"}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  RowBox[{"(", 
   RowBox[{"a1", "\[Wedge]", 
    RowBox[{"q", "[", "1", "]"}], "\[Wedge]", "a2", "\[Wedge]", "c2"}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.574641258098505*^9, 3.574641546206882*^9}]
}, Open  ]],

Cell["\<\
One can give arbitrary, but consistent, definitions for the exterior \
derivatives of undefined forms:\
\>", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"q", "[", "1", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"q", "[", "2", "]"}], "\[Wedge]", 
    RowBox[{"q", "[", "3", "]"}]}]}], ";", 
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"q", "[", "2", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"q", "[", "3", "]"}], "\[Wedge]", 
    RowBox[{"q", "[", "1", "]"}]}]}], ";", 
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"q", "[", "3", "]"}], "]"}], "=", 
   RowBox[{
    RowBox[{"q", "[", "1", "]"}], "\[Wedge]", 
    RowBox[{"q", "[", "2", "]"}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"q", "[", "2", "]"}], "\[Wedge]", 
      RowBox[{"q", "[", "3", "]"}]}], ",", 
     RowBox[{
      RowBox[{"q", "[", "3", "]"}], "\[Wedge]", 
      RowBox[{"q", "[", "1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"q", "[", "1", "]"}], "\[Wedge]", 
      RowBox[{"q", "[", "2", "]"}]}]}], "}"}], "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"Verify", " ", "consistency"}], " ", "*)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.5746412581828527`*^9, 3.574641546286332*^9}]
}, Open  ]],

Cell[TextData[{
 StyleBox["Warning",
  FontWeight->"Bold"],
 ": One must not use ",
 StyleBox["Set",
  FontFamily->"Courier"],
 " (=) for relations between udefined forms. For example, if one discovers, \
in the course of a calculation, that the equations satisfied by an undefined \
form (say ",
 StyleBox["q[3]",
  FontFamily->"Courier"],
 ") imply that it can be expressed in terms of scalars as, say,  u d[v] + \
d[w], one must avoid making the assignment ",
 StyleBox["q[3]",
  FontFamily->"Courier"],
 " ",
 StyleBox["=",
  FontFamily->"Courier"],
 " ",
 StyleBox["u",
  FontFamily->"Courier"],
 " ",
 StyleBox["d[v]",
  FontFamily->"Courier"],
 " ",
 StyleBox["+",
  FontFamily->"Courier"],
 " ",
 StyleBox["d[w]",
  FontFamily->"Courier"],
 " because it may lead to infinite loops (depending on previous calculations \
using ",
 StyleBox["q[3]",
  FontFamily->"Courier"],
 "). One must instead use the replacement rule ",
 StyleBox["q[3]",
  FontFamily->"Courier"],
 " ",
 StyleBox["->",
  FontFamily->"Courier"],
 " ",
 StyleBox["u",
  FontFamily->"Courier"],
 " ",
 StyleBox["d[v]",
  FontFamily->"Courier"],
 " ",
 StyleBox["+",
  FontFamily->"Courier"],
 " ",
 StyleBox["d[w]",
  FontFamily->"Courier"],
 " where needed, or restart the calculations using a different notation for \
",
 StyleBox["q[3]",
  FontFamily->"Courier"],
 " (say ",
 StyleBox["q3",
  FontFamily->"Courier"],
 ", ",
 StyleBox["which must not be declared as an 1-form",
  FontSlant->"Italic"],
 "), and then setting  ",
 StyleBox["q3",
  FontFamily->"Courier"],
 " ",
 StyleBox["=",
  FontFamily->"Courier"],
 " ",
 StyleBox["u",
  FontFamily->"Courier"],
 " ",
 StyleBox["d[v]+d[w]",
  FontFamily->"Courier"],
 "."
}], "Text"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Bar",
  FontWeight->"Bold"],
 "[x_]:: returns the complex conjugate of the expression x, assuming all \
symbols are complex. If some symbols are real, the user must set ",
 StyleBox["Bar[ai]=ai",
  FontFamily->"Courier"],
 ", for each real symbol ",
 StyleBox["ai",
  FontFamily->"Courier"],
 ". If most symbols are real one can define ",
 StyleBox["Bar[x_Symbol]:=x",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 ", and still set ",
 StyleBox["Bar[ci]=ciB;Bar[ciB]=ci;",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 " for pairs of complex-conjugate symbols ",
 StyleBox["ci,ciB",
  FontFamily->"Courier"],
 "."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r1", "=", 
  RowBox[{"{", 
   RowBox[{"z", "->", 
    RowBox[{"x", "+", 
     RowBox[{"I", " ", "y"}]}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"z", "\[Rule]", 
   RowBox[{"x", "+", 
    RowBox[{"\[ImaginaryI]", " ", "y"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.57464125821504*^9, 3.574641546372151*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"r2", "=", 
  RowBox[{"Join", "[", 
   RowBox[{"r1", ",", 
    RowBox[{"Bar", "[", "r1", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"z", "\[Rule]", 
    RowBox[{"x", "+", 
     RowBox[{"\[ImaginaryI]", " ", "y"}]}]}], ",", 
   RowBox[{
    RowBox[{"Bar", "[", "z", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"Bar", "[", "x", "]"}], "-", 
     RowBox[{"\[ImaginaryI]", " ", 
      RowBox[{"Bar", "[", "y", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.574641258436264*^9, 3.5746415464069023`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Bar", "[", "x_Symbol", "]"}], ":=", "x"}], ";", 
  RowBox[{
   RowBox[{"Bar", "[", "z", "]"}], "=", "zB"}], ";", 
  RowBox[{
   RowBox[{"Bar", "[", "zB", "]"}], "=", "z"}], ";", "r2"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"z", "\[Rule]", 
    RowBox[{"x", "+", 
     RowBox[{"\[ImaginaryI]", " ", "y"}]}]}], ",", 
   RowBox[{"zB", "\[Rule]", 
    RowBox[{"x", "-", 
     RowBox[{"\[ImaginaryI]", " ", "y"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.5746412585302877`*^9, 3.5746415464224043`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["ScalFormQ",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_], ",
  FontFamily->"Courier"],
 StyleBox["BasicScalFormQ",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 ": return ",
 StyleBox["True",
  FontFamily->"Courier"],
 " if ",
 StyleBox["x",
  FontFamily->"Courier"],
 " is a (basic) differential-form expression and ",
 StyleBox["False",
  FontFamily->"Courier"],
 " otherwise. Basic means not expressible ",
 "(as sum or product)",
 " in terms of other forms."
}], "Text",
 TextJustification->0],

Cell[BoxData[
 RowBox[{
  RowBox[{"testExpr", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"d", "[", "x", "]"}], ",", 
     RowBox[{"3", " ", 
      RowBox[{"d", "[", "x", "]"}]}], ",", "a1", ",", 
     RowBox[{"a1", "+", 
      RowBox[{"q", "[", "1", "]"}]}], ",", 
     RowBox[{"a1", "\[Wedge]", 
      RowBox[{"q", "[", "1", "]"}]}]}], "}"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ScalFormQ", "/@", "testExpr"}], "\n"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "False", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.5746412585798063`*^9, 3.574641546473547*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasicScalFormQ", "/@", "testExpr"}], "\n"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "False", ",", "True", ",", "False", ",", "True", ",", "False", ",", 
   "False"}], "}"}]], "Output",
 CellChangeTimes->{3.5746412586194468`*^9, 3.574641546527193*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox[" ", "Text",
  FontFamily->"Times",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["Calculations with Series", "Text",
  FontFamily->"Times",
  FontSlant->"Italic"]
}], "Subsubsection"],

Cell[TextData[{
 "\tWhen working with series expansions, one must keep in mind that the \
notation ",
 StyleBox["d[x]",
  FontFamily->"Courier"],
 " for the differential of the expansion symbol (coordinate) cannot be used \
because ",
 StyleBox["Series",
  FontFamily->"Courier"],
 " will consider ",
 StyleBox["d[x]",
  FontFamily->"Courier"],
 " a function of ",
 StyleBox["x",
  FontFamily->"Courier"],
 " and formally expand it (using ",
 StyleBox["d[0]=0",
  FontFamily->"Courier"],
 "):"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", "x", "]"}], "/", 
    RowBox[{"(", 
     RowBox[{"1", "-", "x"}], ")"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "0", ",", "3"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{
     SuperscriptBox["d", "\[Prime]",
      MultilineFunction->None], "[", "0", "]"}], " ", "x"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "\[Prime]",
        MultilineFunction->None], "[", "0", "]"}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "0", "]"}], "2"]}], ")"}], " ", 
    SuperscriptBox["x", "2"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["d", "\[Prime]",
        MultilineFunction->None], "[", "0", "]"}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["d", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "0", "]"}], "2"], "+", 
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{
        SuperscriptBox["d", 
         TagBox[
          RowBox[{"(", "3", ")"}],
          Derivative],
         MultilineFunction->None], "[", "0", "]"}]}]}], ")"}], " ", 
    SuperscriptBox["x", "3"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "4"],
    SeriesData[$CellContext`x, 0, {}, 1, 4, 1],
    Editable->False]}],
  SeriesData[$CellContext`x, 0, {
    Derivative[1][$CellContext`d][0], Derivative[1][$CellContext`d][0] + 
    Rational[1, 2] Derivative[2][$CellContext`d][0], 
    Derivative[1][$CellContext`d][0] + 
    Rational[1, 2] Derivative[2][$CellContext`d][0] + 
    Rational[1, 6] Derivative[3][$CellContext`d][0]}, 1, 4, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.574641258936303*^9, 3.5746415465576153`*^9}]
}, Open  ]],

Cell[TextData[{
 "\tOne must therefore use ",
 StyleBox["DeclareForms",
  FontFamily->"Courier"],
 " to introduce a new symbol for the differential of that scalar variable \
(and appropriately define its exterior derivative). For example:"
}], "Text"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"DeclareForms", "[", 
   RowBox[{"1", ",", "dx"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", "x", "]"}], "=", "dx"}], ";", 
  RowBox[{
   RowBox[{"d", "[", "dx", "]"}], "=", "0"}], ";"}]}], "Input"],

Cell[TextData[{
 "Then one can do calculations with series (one can still input ",
 StyleBox["d[x]",
  FontFamily->"Courier"],
 "):"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ser1", "=", 
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "[", "x", "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", "x"}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", "0", ",", "3"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"dx", "+", 
   RowBox[{"dx", " ", "x"}], "+", 
   RowBox[{"dx", " ", 
    SuperscriptBox["x", "2"]}], "+", 
   RowBox[{"dx", " ", 
    SuperscriptBox["x", "3"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "4"],
    SeriesData[$CellContext`x, 0, {}, 0, 4, 1],
    Editable->False]}],
  SeriesData[$CellContext`x, 
   0, {$CellContext`dx, $CellContext`dx, $CellContext`dx, $CellContext`dx}, 0,
    4, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.574641258981483*^9, 3.5746415466368523`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d", "[", "ser1", "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox[
   RowBox[{"O", "[", "x", "]"}], "3"],
  SeriesData[$CellContext`x, 0, {}, 3, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.574641259021002*^9, 3.574641546695258*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ser1", 
  StyleBox["\[Wedge]",
   FontFamily->"Courier"], "ser1"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox[
   RowBox[{"O", "[", "x", "]"}], "4"],
  SeriesData[$CellContext`x, 0, {}, 4, 4, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.57464125905189*^9, 3.574641546729188*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d", "[", 
  RowBox[{
   RowBox[{"y", "^", "2"}], " ", "ser1"}], "]"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"y", " ", 
       RowBox[{"dx", "\[Wedge]", 
        RowBox[{"d", "[", "y", "]"}]}]}], ")"}]}]}], "-", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"y", " ", 
      RowBox[{"dx", "\[Wedge]", 
       RowBox[{"d", "[", "y", "]"}]}]}], ")"}], " ", "x"}], "-", 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"y", " ", 
      RowBox[{"dx", "\[Wedge]", 
       RowBox[{"d", "[", "y", "]"}]}]}], ")"}], " ", 
    SuperscriptBox["x", "2"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "3"],
    SeriesData[$CellContext`x, 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`x, 0, {(-2) $CellContext`y Wedge[$CellContext`dx, 
      $CellContext`d[$CellContext`y]], (-2) $CellContext`y 
    Wedge[$CellContext`dx, 
      $CellContext`d[$CellContext`y]], (-2) $CellContext`y 
    Wedge[$CellContext`dx, 
      $CellContext`d[$CellContext`y]]}, 0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.574641259104602*^9, 3.574641546775283*^9}]
}, Open  ]],

Cell["\<\
\tSeries has been modified to automatically expand (to the appropriate order) \
series coefficients that depend on x:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{"y", "->", 
   RowBox[{
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", "-", "x"}], "]"}], "u"}]}]}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"u", " ", 
       RowBox[{"dx", "\[Wedge]", 
        RowBox[{"d", "[", "u", "]"}]}]}], ")"}]}]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "x", "]"}], "3"],
    SeriesData[$CellContext`x, 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`x, 0, {(-2) $CellContext`u Wedge[$CellContext`dx, 
      $CellContext`d[$CellContext`u]]}, 0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.574641259132435*^9, 3.5746415468321657`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell["\<\

\
\>", "Text"],

Cell[CellGroupData[{

Cell["matrixEDC", "Text",
 ShowGroupOpener->True,
 FontFamily->"Times",
 FontSize->24,
 FontWeight->"Bold",
 FontSlant->"Italic",
 FontColor->GrayLevel[1],
 Background->RGBColor[0, 0, 1]],

Cell[TextData[{
 "\n\t",
 StyleBox["The notebook ",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["matrixEDCcode.nb",
  FontWeight->"Bold",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[" allows calculations with differential form ",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["matrices",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[" - both explicit (list of lists) and symbolic (special symbols \
denoting matrices).",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[" ",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["In addition to the functions defined in ",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["scalarEDCcode.nb",
  FontWeight->"Bold",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[", which can now have ",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["matrices",
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[" as arguments (except for ",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["DeclareForms",
  FontFamily->"Courier",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["), the following functions / operations are defined (examples are \
given in the cells in brackets. Sections marked by  \[FilledSquare]  can be \
skipped on a first reading):",
  FontColor->RGBColor[0, 0, 1]]
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["DeclareMatrixForms",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[{p1_,x_,xt_},{p2_,y_,yt_},...]",
  FontFamily->"Courier"],
 " :: allows the user to introduce his particular notation for fundamental \
(undefined) p-form ",
 StyleBox["matrices",
  FontSlant->"Italic"],
 ". ",
 StyleBox["p1",
  FontFamily->"Courier"],
 " must be a positive integer or zero (denoting the differential form degree \
of ",
 StyleBox["x_,",
  FontFamily->"Courier"],
 " ",
 StyleBox["xt_",
  FontFamily->"Courier"],
 ") and ",
 StyleBox["x_,",
  FontFamily->"Courier"],
 " ",
 StyleBox["xt_",
  FontFamily->"Courier"],
 "  are symbols denoting a p1-form matrix and its transpose, respectively. \
For example, evaluating the command ",
 StyleBox["DeclareMatrixForms[{0,S,S},{1,U,-U},{1,Q,Qt}]",
  FontFamily->"Courier"],
 " has the effect that, in all subsequent calculations, the symbol  ",
 StyleBox["S",
  FontFamily->"Courier"],
 "  will be treated as a 0-form symmetric matrix, the symbol  ",
 StyleBox["U",
  FontFamily->"Courier"],
 "  as an 1-form antisymmetric matrix, and the symbols  ",
 StyleBox["Q,",
  FontFamily->"Courier"],
 " ",
 StyleBox["Qt",
  FontFamily->"Courier"],
 "  as 1-form matrices which are transposes of each other. "
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DeclareMatrixForms", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "S", ",", "S"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     StyleBox["U",
      FontFamily->"Courier"], ",", 
     RowBox[{"-", 
      StyleBox["U",
       FontFamily->"Courier"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "Q", ",", "Qt"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"DeclareMatrixForms", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "S", ",", "S"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "U", ",", 
     RowBox[{"-", "U"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "Q", ",", "Qt"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.574641259188488*^9, 3.5746415468743973`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{"S", "\[Wedge]", 
   StyleBox["U",
    FontFamily->"Courier"]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{"S", " ", "U"}], "]"}]], "Output",
 CellChangeTimes->{3.574641259216453*^9, 3.574641546929549*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FormDegree", "[", "%", "]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641259253833*^9, 3.574641546962442*^9}]
}, Open  ]],

Cell["\<\
One can also use indexed variables to denote sets of matrices with common \
properties. For example, after evaluating the command \
\>", "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox[
  RowBox[{"DeclareMatrixForms", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"S0", "[", "_", "]"}], ",", 
      RowBox[{"S0", "[", "_", "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"A1", "[", "_", "]"}], ",", 
      RowBox[{"-", 
       RowBox[{"A1", "[", "_", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"N1", "[", "_", "]"}], ",", 
      RowBox[{"N1t", "[", "_", "]"}]}], "}"}]}], "]"}],
  FontFamily->"Courier"]], "Input"],

Cell[BoxData[
 RowBox[{"DeclareMatrixForms", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"S0", "[", "_", "]"}], ",", 
     RowBox[{"S0", "[", "_", "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"A1", "[", "_", "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"A1", "[", "_", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"N1", "[", "_", "]"}], ",", 
     RowBox[{"N1t", "[", "_", "]"}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.574641259283132*^9, 3.574641547008328*^9}]
}, Open  ]],

Cell[TextData[{
 "the symbols",
 StyleBox[" S0[1],",
  FontFamily->"Courier"],
 " ",
 StyleBox["S0[2],...",
  FontFamily->"Courier"],
 " are treated as ",
 StyleBox["symmetric 0-form",
  FontSlant->"Italic"],
 " matrices, the symbols ",
 StyleBox["A1[1],",
  FontFamily->"Courier"],
 " ",
 StyleBox["A1[2],...",
  FontFamily->"Courier"],
 " as ",
 StyleBox["antisymmetric 1-form",
  FontSlant->"Italic"],
 " matrices, and the symbols ",
 StyleBox["N1[1],",
  FontFamily->"Courier"],
 " ",
 StyleBox["N1[2],..., N1t[1],",
  FontFamily->"Courier"],
 " ",
 StyleBox["N1t[2],...",
  FontFamily->"Courier"],
 ", as ",
 StyleBox["1-form",
  FontSlant->"Italic"],
 " matrices which are, respectively, transposes of each other."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{
   RowBox[{"N1", "[", "2", "]"}], "\[Wedge]", 
   RowBox[{"S0", "[", "1", "]"}], "\[Wedge]", 
   RowBox[{"N1", "[", "1", "]"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{
   RowBox[{"N1", "[", "1", "]"}], " ", 
   RowBox[{"N1", "[", "2", "]"}], " ", 
   RowBox[{"S0", "[", "1", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.574641259321457*^9, 3.574641547062847*^9}]
}, Open  ]],

Cell[TextData[{
 "The minus sign is correct - the ",
 StyleBox["N1[i]",
  FontFamily->"Courier"],
 " are ",
 StyleBox["1-form",
  FontSlant->"Italic"],
 " matrices!\n",
 StyleBox["N",
  FontFamily->"Times",
  FontWeight->"Bold"],
 StyleBox["ote ",
  FontWeight->"Bold"],
 ": No special symbol is used for the identity matrix, as it is not needed in \
symbolic calculations. The functions ",
 StyleBox["tr",
  FontFamily->"Courier"],
 " and ",
 StyleBox["toComponents",
  FontFamily->"Courier"],
 " have been defined so as to take into account the missing identity matrix."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14]
}, Open  ]],

Cell[TextData[{
 StyleBox["Transpose",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 " :: the built-in definition of ",
 StyleBox["Transpose",
  FontFamily->"Courier"],
 " is extended so that it handles properly symbolic matrix expressions \
containing the symbols introduced with ",
 StyleBox["DeclareMatrixForms",
  FontFamily->"Courier"],
 ". "
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["SymQ",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 " :: returns ",
 StyleBox["True",
  FontFamily->"Courier"],
 " if ",
 StyleBox["Transpose[x]=x",
  FontFamily->"Courier"],
 " and ",
 StyleBox["False",
  FontFamily->"Courier"],
 " otherwise.",
 "\n",
 StyleBox["AntisymQ",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 " ::returns ",
 StyleBox["True",
  FontFamily->"Courier"],
 " if ",
 StyleBox["Transpose[x]=-x",
  FontFamily->"Courier"],
 " and ",
 StyleBox["False",
  FontFamily->"Courier"],
 " otherwise."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["\tIn ",
  FontWeight->"Plain"],
 StyleBox["SymQ/AntisymQ",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox["  equality is determined after taking into account the \
simplification rules contained in ",
  FontWeight->"Plain"],
 StyleBox["simpRules",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[".",
  FontWeight->"Plain"]
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cos", "[", "a", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "a", "]"}], "2"]}], ")"}], 
    RowBox[{
     RowBox[{"S0", "[", "1", "]"}], "\[Wedge]", 
     RowBox[{"A1", "[", "1", "]"}]}]}], "+", 
   RowBox[{
    RowBox[{"A1", "[", "1", "]"}], "\[Wedge]", 
    RowBox[{"S0", "[", "1", "]"}]}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Transpose", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"A1", "[", "1", "]"}], " ", 
    RowBox[{"S0", "[", "1", "]"}]}], "+", 
   RowBox[{
    RowBox[{"A1", "[", "1", "]"}], " ", 
    RowBox[{"S0", "[", "1", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"Cos", "[", "a", "]"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "a", "]"}], "2"]}], ")"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.574641259350964*^9, 3.574641547108643*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AntisymQ", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"AntisymQ", "[", 
  RowBox[{"Transpose", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"A1", "[", "1", "]"}], " ", 
     RowBox[{"S0", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"A1", "[", "1", "]"}], " ", 
     RowBox[{"S0", "[", "1", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", "a", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "a", "]"}], "2"]}], ")"}]}]}], "]"}], 
  "]"}]], "Output",
 CellChangeTimes->{3.5746412594058657`*^9, 3.5746415471412907`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["MatQ",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_], ",
  FontFamily->"Courier"],
 StyleBox["BasicMatQ",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 ": return ",
 StyleBox["True",
  FontFamily->"Courier"],
 " if ",
 StyleBox["x",
  FontFamily->"Courier"],
 " is a (basic) matrix expression and ",
 StyleBox["False",
  FontFamily->"Courier"],
 " otherwise. Basic means not expressible (as sum or product) in terms of \
other matrices."
}], "Text",
 TextJustification->0],

Cell[BoxData[
 RowBox[{
  RowBox[{"testExpr", "=", 
   RowBox[{"{", 
    RowBox[{"x", ",", 
     RowBox[{"d", "[", "x", "]"}], ",", "S", ",", 
     RowBox[{"d", "[", "S", "]"}], ",", 
     RowBox[{
      RowBox[{"N1", "[", "2", "]"}], "+", 
      RowBox[{"N1t", "[", "2", "]"}]}], ",", 
     RowBox[{"S", "\[Wedge]", "U"}], ",", 
     RowBox[{
      RowBox[{"d", "[", "x", "]"}], "\[Wedge]", "U"}], ",", 
     RowBox[{"Bar", "[", 
      RowBox[{"N1", "[", "_", "]"}], "]"}]}], "}"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"MatQ", "/@", "testExpr"}], "\n"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"MatQ", "[", "x", "]"}], ",", 
   RowBox[{"MatQ", "[", "dx", "]"}], ",", 
   RowBox[{"MatQ", "[", "S", "]"}], ",", 
   RowBox[{"MatQ", "[", 
    RowBox[{"d", "[", "S", "]"}], "]"}], ",", 
   RowBox[{"MatQ", "[", 
    RowBox[{
     RowBox[{"N1", "[", "2", "]"}], "+", 
     RowBox[{"N1t", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"MatQ", "[", 
    RowBox[{"S", " ", "U"}], "]"}], ",", 
   RowBox[{"MatQ", "[", 
    RowBox[{"dx", " ", "U"}], "]"}], ",", 
   RowBox[{"MatQ", "[", 
    RowBox[{"Bar", "[", 
     RowBox[{"N1", "[", "_", "]"}], "]"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.574641259467328*^9, 3.574641547221554*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"BasicMatQ", "/@", "testExpr"}], "\n"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"BasicMatQ", "[", "x", "]"}], ",", 
   RowBox[{"BasicMatQ", "[", "dx", "]"}], ",", 
   RowBox[{"BasicMatQ", "[", "S", "]"}], ",", 
   RowBox[{"BasicMatQ", "[", 
    RowBox[{"d", "[", "S", "]"}], "]"}], ",", 
   RowBox[{"BasicMatQ", "[", 
    RowBox[{
     RowBox[{"N1", "[", "2", "]"}], "+", 
     RowBox[{"N1t", "[", "2", "]"}]}], "]"}], ",", 
   RowBox[{"BasicMatQ", "[", 
    RowBox[{"S", " ", "U"}], "]"}], ",", 
   RowBox[{"BasicMatQ", "[", 
    RowBox[{"dx", " ", "U"}], "]"}], ",", 
   RowBox[{"BasicMatQ", "[", 
    RowBox[{"Bar", "[", 
     RowBox[{"N1", "[", "_", "]"}], "]"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.574641259581286*^9, 3.574641547282288*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["tr",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_]",
  FontFamily->"Courier"],
 " :: returns the trace of the matrix expression ",
 StyleBox["x",
  FontFamily->"Courier"],
 ". If  ",
 StyleBox["x",
  FontFamily->"Courier"],
 " is a scalar, it is assumed to multiply the identity matrix, and thus ",
 StyleBox["tr",
  FontFamily->"Courier"],
 " returns ",
 StyleBox["x*matDimension",
  FontFamily->"Courier"],
 ", where ",
 StyleBox["matDimension",
  FontFamily->"Courier"],
 " is a global variable to be assigned by the user. \nWhen ",
 StyleBox["tr",
  FontFamily->"Courier"],
 "  acts on products of symbolic matrices, it can apply the cyclic property \
of trace (as well as the fact that ",
 StyleBox["tr[Transpose[x]]=tr[x]",
  FontFamily->"Courier"],
 "), to reduce its argument to a \"canonical\" form. It can thus be made to \
recognize that the trace of the matrix expression ",
 StyleBox["2",
  FontFamily->"Courier"],
 " ",
 StyleBox["A\[Wedge]B\[Wedge]C-C\[Wedge]A\[Wedge]B-At\[Wedge]Ct\[Wedge]Bt",
  FontFamily->"Courier"],
 " is identically zero (for 0-form matrices ",
 StyleBox["A,B,C",
  FontFamily->"Courier"],
 " with transposes ",
 StyleBox["At,Bt,Ct",
  FontFamily->"Courier"],
 " respectively)."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DeclareMatrixForms", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "A", ",", "At"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "B", ",", "Bt"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "C", ",", "Ct"}], "}"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"DeclareMatrixForms", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "A", ",", "At"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "B", ",", "Bt"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "C", ",", "Ct"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.57464125962145*^9, 3.57464154732549*^9}]
}, Open  ]],

Cell[TextData[{
 "The behavior of ",
 StyleBox["tr",
  FontFamily->"Courier"],
 " is controlled by the value of the global variable ",
 StyleBox["traceOption",
  FontFamily->"Courier"],
 ",  as can be seen in the following examples:"
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[BoxData[
 RowBox[{
  RowBox[{"testExpr", "=", 
   RowBox[{"{", 
    RowBox[{"At", ",", 
     RowBox[{"Ct", "\[Wedge]", "Bt"}], ",", 
     RowBox[{"At", "\[Wedge]", "Ct", "\[Wedge]", "Bt"}], ",", 
     RowBox[{"At", "\[Wedge]", "Ct", "\[Wedge]", "Bt", "\[Wedge]", "At"}], 
     ",", 
     RowBox[{
      RowBox[{
       StyleBox["2",
        FontFamily->"Courier"], " ", 
       StyleBox[
        RowBox[{"A", "\[Wedge]", "B", "\[Wedge]", "C"}],
        FontFamily->"Courier"]}], 
      StyleBox["-",
       FontFamily->"Courier"], 
      StyleBox[
       RowBox[{"C", "\[Wedge]", "A", "\[Wedge]", "B"}],
       FontFamily->"Courier"], 
      StyleBox["-",
       FontFamily->"Courier"], 
      StyleBox[
       RowBox[{"At", "\[Wedge]", "Ct", "\[Wedge]", "Bt"}],
       FontFamily->"Courier"]}]}], "}"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"traceOption", "=", "0"}], ";", 
   RowBox[{"tr", "/@", "testExpr"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"*", 
     StyleBox[" ",
      FontColor->RGBColor[0, 1, 0]], 
     StyleBox["No",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["rules",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["applied",
      FontColor->RGBColor[0, 0, 1]]}], 
    StyleBox[",",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[
     RowBox[{"other", " ", "than", " ", "linearity"}],
     FontColor->RGBColor[0, 0, 1]]}], " ", "**)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"tr", "[", "At", "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{"Bt", " ", "Ct"}], "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{"At", " ", "Bt", " ", "Ct"}], "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{
     SuperscriptBox["At", "2"], " ", "Bt", " ", "Ct"}], "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{
     RowBox[{"A", " ", "B", " ", "C"}], "-", 
     RowBox[{"At", " ", "Bt", " ", "Ct"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.5746412596836987`*^9, 3.574641547438417*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"traceOption", "=", "1"}], ";", 
   RowBox[{"tr", "/@", "testExpr"}]}], 
  RowBox[{"(*", 
   RowBox[{"*", " ", 
    StyleBox["Only",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["cyclic",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["rule",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["applied",
     FontColor->RGBColor[0, 0, 1]]}], " ", "**)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"tr", "[", "At", "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{"Bt", " ", "Ct"}], "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{"At", " ", "Bt", " ", "Ct"}], "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{
     SuperscriptBox["At", "2"], " ", "Bt", " ", "Ct"}], "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{
     RowBox[{"A", " ", "B", " ", "C"}], "-", 
     RowBox[{"At", " ", "Bt", " ", "Ct"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.574641259718648*^9, 3.5746415474794807`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"traceOption", "=", "2"}], ";", 
   RowBox[{"tr", "/@", "testExpr"}]}], 
  RowBox[{"(*", 
   RowBox[{"*", " ", 
    StyleBox["Cyclic",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["and",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["Transpose",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["rules",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["applied",
     FontColor->RGBColor[0, 0, 1]]}], " ", "**)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"tr", "[", "At", "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{"Bt", " ", "Ct"}], "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{"At", " ", "Bt", " ", "Ct"}], "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{
     SuperscriptBox["At", "2"], " ", "Bt", " ", "Ct"}], "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{
     RowBox[{"A", " ", "B", " ", "C"}], "-", 
     RowBox[{"At", " ", "Bt", " ", "Ct"}]}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.574641259750164*^9, 3.574641547514909*^9}]
}, Open  ]],

Cell[TextData[{
 "Note that, for single matrices, ",
 StyleBox["tr[At]=tr[A]",
  FontFamily->"Courier"],
 " independently of ",
 StyleBox["traceOption. \n\t",
  FontFamily->"Courier"],
 StyleBox["Warning",
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0, 0]],
 ": ",
 StyleBox["The default value of ",
  FontWeight->"Plain",
  FontSlant->"Plain"],
 StyleBox["traceOption",
  FontFamily->"Courier",
  FontWeight->"Plain",
  FontSlant->"Plain"],
 StyleBox["  is ",
  FontWeight->"Plain",
  FontSlant->"Plain"],
 StyleBox["2",
  FontFamily->"Courier",
  FontWeight->"Plain",
  FontSlant->"Plain"],
 StyleBox[", to allow maximum simplification of complicated  ",
  FontWeight->"Plain",
  FontSlant->"Plain"],
 StyleBox["tr",
  FontFamily->"Courier",
  FontWeight->"Plain",
  FontSlant->"Plain"],
 StyleBox["  expressions. However,",
  FontWeight->"Plain",
  FontSlant->"Plain"],
 StyleBox[" ",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox["this value can sometimes lead to infinite loops",
  FontWeight->"Plain"],
 StyleBox[" if used together with a commutator rule like ",
  FontWeight->"Plain",
  FontSlant->"Plain"],
 StyleBox["S0[1]\[Wedge]S0[3]->S0[3]\[Wedge]S0[1]+2I",
  FontFamily->"Courier"],
 " ",
 StyleBox["S0[2]",
  FontFamily->"Courier"],
 " which reverses the canonical order of matrix products."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[TextData[{
 StyleBox["tr",
  FontFamily->"Courier"],
 " applies other rules also; for example, since ",
 StyleBox["S",
  FontFamily->"Courier"],
 " is a symmetric 0-form matrix and ",
 StyleBox["U",
  FontFamily->"Courier"],
 " antisymmetric, "
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"tr", "/@", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"S", "\[Wedge]", 
      StyleBox["U",
       FontFamily->"Courier"]}], ",", 
     RowBox[{"S", "\[Wedge]", 
      StyleBox["U",
       FontFamily->"Courier"], "\[Wedge]", "S", "\[Wedge]", "S"}]}], "}"}]}], 
  " "}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"tr", "[", 
    RowBox[{"S", " ", "U"}], "]"}], ",", 
   RowBox[{"tr", "[", 
    RowBox[{
     SuperscriptBox["S", "3"], " ", "U"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.574641259788928*^9, 3.574641547558977*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["toComponents",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[x_,rul_List]",
  FontFamily->"Courier"],
 ":: returns the component form of the symbolic matrix expression ",
 StyleBox["x",
  FontFamily->"Courier"],
 ", introducing the identity matrix where needed. The components of the basic \
symbolic matrices must be given as a set of replacement rules in the list ",
 StyleBox["rul",
  FontFamily->"Courier"],
 " and must satisfy the assumed matrix symmetries. If ",
 StyleBox["x",
  FontFamily->"Courier"],
 " is a scalar, ",
 StyleBox["toComponents",
  FontFamily->"Courier"],
 " returns ",
 StyleBox["x*IdentityMatrix[matDimension]",
  FontFamily->"Courier"],
 ".\n",
 StyleBox["Note",
  FontWeight->"Bold"],
 " : If the components of a p-form matrix are ",
 StyleBox["undefined",
  FontSlant->"Italic"],
 " scalar p-forms, ",
 StyleBox["DeclareForms",
  FontFamily->"Courier"],
 " must be used to introduce them. For example, if ",
 StyleBox["U",
  FontFamily->"Courier"],
 " has been declared an antisymmetric 1-form matrix, and ",
 StyleBox["rul",
  FontFamily->"Courier"],
 " gives the components of ",
 StyleBox["U",
  FontFamily->"Courier"],
 "  in terms of the ",
 StyleBox["undefined",
  FontSlant->"Italic"],
 " scalar 1-forms ",
 StyleBox["u1,",
  FontFamily->"Courier"],
 " ",
 StyleBox["u2,",
  FontFamily->"Courier"],
 " ",
 StyleBox["u3,",
  FontFamily->"Courier"],
 " one must evaluate ",
 StyleBox["DeclareForms[1,u1,u2,u3]",
  FontFamily->"Courier"],
 " before using ",
 StyleBox["toComponents",
  FontFamily->"Courier"],
 "."
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matDimension", "=", "3"}], ";"}], "\n", 
 RowBox[{"matComp", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"A", "->", 
     RowBox[{"Array", "[", 
      RowBox[{"Ac", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ",", 
    RowBox[{"At", "->", 
     RowBox[{"Transpose", "[", 
      RowBox[{"Array", "[", 
       RowBox[{"Ac", ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", "3"}], "}"}]}], "]"}], "]"}]}], ",", 
    RowBox[{"S", "->", 
     RowBox[{"Array", "[", 
      RowBox[{"Sc", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}], ",", 
    RowBox[{
     StyleBox["U",
      FontFamily->"Courier"], "->", 
     RowBox[{"Array", "[", 
      RowBox[{"ucomp", ",", 
       RowBox[{"{", 
        RowBox[{"3", ",", "3"}], "}"}]}], "]"}]}]}], "}"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"A", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"At", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "1"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "3"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "3"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"S", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"3", ",", "1"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"3", ",", "2"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"U", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ucomp", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"ucomp", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"ucomp", "[", 
         RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ucomp", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"ucomp", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"ucomp", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ucomp", "[", 
         RowBox[{"3", ",", "1"}], "]"}], ",", 
        RowBox[{"ucomp", "[", 
         RowBox[{"3", ",", "2"}], "]"}], ",", 
        RowBox[{"ucomp", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.574641259819085*^9, 3.574641547613492*^9}]
}, Open  ]],

Cell["\<\
The components must be made to satisfy the assumed matrix symmetries, and \
must be declared to have the appropriate differential form degree (if >0):\
\>", "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Sc", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Sc", "[", 
     RowBox[{"j", ",", "i"}], "]"}], "/;", 
    RowBox[{"i", ">", "j"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ucomp", "[", 
   RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Signature", "[", 
      RowBox[{"{", 
       RowBox[{"i", ",", "j", ",", "k"}], "}"}], "]"}], 
     RowBox[{"uc", "[", "k", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"k", ",", "3"}], "}"}]}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"DeclareForms", "[", 
  RowBox[{"1", ",", 
   RowBox[{"uc", "[", "_", "]"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData["matComp"], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"A", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"At", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "1"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "1"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ac", "[", 
         RowBox[{"1", ",", "3"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"2", ",", "3"}], "]"}], ",", 
        RowBox[{"Ac", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"S", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "1"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "2"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"2", ",", "2"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Sc", "[", 
         RowBox[{"1", ",", "3"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"2", ",", "3"}], "]"}], ",", 
        RowBox[{"Sc", "[", 
         RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"U", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"uc", "[", "3", "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"uc", "[", "2", "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"uc", "[", "3", "]"}]}], ",", "0", ",", 
        RowBox[{"uc", "[", "1", "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"uc", "[", "2", "]"}], ",", 
        RowBox[{"-", 
         RowBox[{"uc", "[", "1", "]"}]}], ",", "0"}], "}"}]}], "}"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.57464125992616*^9, 3.574641547724309*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"toComponents", "[", 
   RowBox[{
    RowBox[{"S", "\[Wedge]", 
     StyleBox["U",
      FontFamily->"Courier"]}], ",", "matComp"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"toComponents", "[", 
   RowBox[{
    RowBox[{"S", " ", "U"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"At", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "1"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "3"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "3"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"S", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "3"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "3"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"U", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"uc", "[", "3", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"uc", "[", "2", "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"uc", "[", "3", "]"}]}], ",", "0", ",", 
           RowBox[{"uc", "[", "1", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"uc", "[", "2", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"uc", "[", "1", "]"}]}], ",", "0"}], "}"}]}], "}"}]}]}], 
     "}"}]}], "]"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.574641259956737*^9, 3.574641547759856*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tr", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"tr", "[", 
  RowBox[{"toComponents", "[", 
   RowBox[{
    RowBox[{"S", " ", "U"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"At", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "1"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "3"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "3"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"S", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "3"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "3"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"U", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"uc", "[", "3", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"uc", "[", "2", "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"uc", "[", "3", "]"}]}], ",", "0", ",", 
           RowBox[{"uc", "[", "1", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"uc", "[", "2", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"uc", "[", "1", "]"}]}], ",", "0"}], "}"}]}], "}"}]}]}], 
     "}"}]}], "]"}], "]"}]], "Output",
 CellChangeTimes->{3.574641259985302*^9, 3.5746415478139*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FormDegree", "[", "%%", "]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641260020506*^9, 3.5746415478602743`*^9}]
}, Open  ]],

Cell[TextData[{
 StyleBox["toComponents",
  FontFamily->"Courier"],
 " understands that, in the expression  ",
 StyleBox["A",
  FontFamily->"Courier"],
 " ",
 StyleBox["+",
  FontFamily->"Courier"],
 " ",
 StyleBox["lamda",
  FontFamily->"Courier"],
 ", the scalar ",
 StyleBox["lamda",
  FontFamily->"Courier"],
 " multiplies the identity matrix:"
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"toComponents", "[", 
   RowBox[{
    RowBox[{"A", " ", "+", " ", "lamda"}], ",", "matComp"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"toComponents", "[", 
   RowBox[{
    RowBox[{"A", "+", "lamda"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"At", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "1"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "3"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "3"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"S", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "3"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "3"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"U", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"uc", "[", "3", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"uc", "[", "2", "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"uc", "[", "3", "]"}]}], ",", "0", ",", 
           RowBox[{"uc", "[", "1", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"uc", "[", "2", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"uc", "[", "1", "]"}]}], ",", "0"}], "}"}]}], "}"}]}]}], 
     "}"}]}], "]"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.5746412600564528`*^9, 3.57464154791494*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tr", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"tr", "[", 
  RowBox[{"toComponents", "[", 
   RowBox[{
    RowBox[{"A", "+", "lamda"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"At", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "1"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "3"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "3"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"S", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "3"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "3"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"U", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"uc", "[", "3", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"uc", "[", "2", "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"uc", "[", "3", "]"}]}], ",", "0", ",", 
           RowBox[{"uc", "[", "1", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"uc", "[", "2", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"uc", "[", "1", "]"}]}], ",", "0"}], "}"}]}], "}"}]}]}], 
     "}"}]}], "]"}], "]"}]], "Output",
 CellChangeTimes->{3.574641260085188*^9, 3.574641547960268*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"A", " ", "+", " ", "lamda"}], ")"}], "\[Wedge]", 
  RowBox[{"Transpose", "[", 
   RowBox[{"A", " ", "+", " ", "lamda"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"A", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"A", "+", "lamda"}], "]"}]}], "+", 
  RowBox[{"lamda", " ", 
   RowBox[{"Transpose", "[", 
    RowBox[{"A", "+", "lamda"}], "]"}]}]}]], "Output",
 CellChangeTimes->{3.5746412601185017`*^9, 3.574641548014679*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tr", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"tr", "[", 
  RowBox[{
   RowBox[{"A", " ", 
    RowBox[{"Transpose", "[", 
     RowBox[{"A", "+", "lamda"}], "]"}]}], "+", 
   RowBox[{"lamda", " ", 
    RowBox[{"Transpose", "[", 
     RowBox[{"A", "+", "lamda"}], "]"}]}]}], "]"}]], "Output",
 CellChangeTimes->{3.574641260153263*^9, 3.574641548059945*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", 
  RowBox[{"toComponents", "[", 
   RowBox[{"%%", ",", "matComp"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"toComponents", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"A", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"A", "+", "lamda"}], "]"}]}], "+", 
     RowBox[{"lamda", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"A", "+", "lamda"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"At", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "1"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "3"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "3"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"S", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "3"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "3"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"U", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"uc", "[", "3", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"uc", "[", "2", "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"uc", "[", "3", "]"}]}], ",", "0", ",", 
           RowBox[{"uc", "[", "1", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"uc", "[", "2", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"uc", "[", "1", "]"}]}], ",", "0"}], "}"}]}], "}"}]}]}], 
     "}"}]}], "]"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.5746412601856203`*^9, 3.574641548115302*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SymQ", "[", "%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"SymQ", "[", 
  RowBox[{"toComponents", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"A", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"A", "+", "lamda"}], "]"}]}], "+", 
     RowBox[{"lamda", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"A", "+", "lamda"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"At", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "1"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "3"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "3"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"S", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "3"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "3"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"U", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"uc", "[", "3", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"uc", "[", "2", "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"uc", "[", "3", "]"}]}], ",", "0", ",", 
           RowBox[{"uc", "[", "1", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"uc", "[", "2", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"uc", "[", "1", "]"}]}], ",", "0"}], "}"}]}], "}"}]}]}], 
     "}"}]}], "]"}], "]"}]], "Output",
 CellChangeTimes->{3.574641260219841*^9, 3.5746415481626263`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tr", "[", "%%", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"tr", "[", 
  RowBox[{"toComponents", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"A", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"A", "+", "lamda"}], "]"}]}], "+", 
     RowBox[{"lamda", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"A", "+", "lamda"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"At", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "1"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "3"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "3"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"S", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "3"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "3"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"U", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"uc", "[", "3", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"uc", "[", "2", "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"uc", "[", "3", "]"}]}], ",", "0", ",", 
           RowBox[{"uc", "[", "1", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"uc", "[", "2", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"uc", "[", "1", "]"}]}], ",", "0"}], "}"}]}], "}"}]}]}], 
     "}"}]}], "]"}], "]"}]], "Output",
 CellChangeTimes->{3.5746412602533073`*^9, 3.574641548209835*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{"%", ",", "lamda", ",", "Factor"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"tr", "[", 
  RowBox[{"toComponents", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"A", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"A", "+", "lamda"}], "]"}]}], "+", 
     RowBox[{"lamda", " ", 
      RowBox[{"Transpose", "[", 
       RowBox[{"A", "+", "lamda"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"A", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"At", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "1"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "1"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "2"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Ac", "[", 
            RowBox[{"1", ",", "3"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"2", ",", "3"}], "]"}], ",", 
           RowBox[{"Ac", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"S", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "1"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "2"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Sc", "[", 
            RowBox[{"1", ",", "3"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"2", ",", "3"}], "]"}], ",", 
           RowBox[{"Sc", "[", 
            RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]}], ",", 
      RowBox[{"U", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"uc", "[", "3", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"uc", "[", "2", "]"}]}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"uc", "[", "3", "]"}]}], ",", "0", ",", 
           RowBox[{"uc", "[", "1", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"uc", "[", "2", "]"}], ",", 
           RowBox[{"-", 
            RowBox[{"uc", "[", "1", "]"}]}], ",", "0"}], "}"}]}], "}"}]}]}], 
     "}"}]}], "]"}], "]"}]], "Output",
 CellChangeTimes->{3.574641260284668*^9, 3.5746415482673063`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"matDimension", "=."}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["CHrul",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 StyleBox["[n_Integer, mat_:$]",
  FontFamily->"Courier"],
 ":: returns a rule for implementing the Cayley-Hamilton theorem for the n x \
n  0-form matrix ",
 StyleBox["mat",
  FontFamily->"Courier"],
 ". The second argument is optional; if it is missing ",
 StyleBox["CHrul",
  FontFamily->"Courier"],
 " returns a delayed rule that can be applied to any n x n  0-form matrix. ",
 StyleBox["CHrul",
  FontFamily->"Courier"],
 " introduces the symbol ",
 StyleBox["$",
  FontFamily->"Courier"],
 " as a 0-form matrix. After calling ",
 StyleBox["CHrul",
  FontFamily->"Courier"],
 ", ",
 StyleBox["matDimension",
  FontFamily->"Courier"],
 " is set to ",
 StyleBox["n",
  FontFamily->"Courier"],
 ". "
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CHrul", "[", 
  RowBox[{"3", ",", "A"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"CHrul", "[", 
  RowBox[{"3", ",", "A"}], "]"}]], "Output",
 CellChangeTimes->{3.574641260354177*^9, 3.574641548340625*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CH3", "=", 
  RowBox[{"CHrul", "[", "3", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"CHrul", "[", "3", "]"}]], "Output",
 CellChangeTimes->{3.574641260420278*^9, 3.5746415484570713`*^9}]
}, Open  ]],

Cell[TextData[{
 StyleBox["The rule applies only when ",
  FontWeight->"Plain"],
 StyleBox["$",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[" is a 0-form matrix expression. The pattern matches products of \
matrices also:",
  FontWeight->"Plain"]
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{
   "A", "\[Wedge]", "B", "\[Wedge]", "A", "\[Wedge]", "B", "\[Wedge]", "A", 
    "\[Wedge]", "B", "\[Wedge]", "A"}], "/.", "CH3"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReplaceAll", "::", "\<\"reps\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(\\*StyleBox[\\!\\({\\(CHrul[3]\\)}\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/ReplaceAll/reps\\\", \
ButtonNote -> \\\"ReplaceAll::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.574641260500289*^9, 3.574641548493621*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["A", "4"], " ", 
   SuperscriptBox["B", "3"]}], "/.", "\[InvisibleSpace]", 
  RowBox[{"CHrul", "[", "3", "]"}]}]], "Output",
 CellChangeTimes->{3.574641260501368*^9, 3.5746415484958572`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CH4", "=", 
  RowBox[{"CHrul", "[", "4", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"CHrul", "[", "4", "]"}]], "Output",
 CellChangeTimes->{3.5746412605689783`*^9, 3.5746415485480623`*^9}]
}, Open  ]],

Cell[TextData[{
 "Now ",
 StyleBox["matDimension",
  FontFamily->"Courier"],
 " is set to 4, so ",
 StyleBox["CH3",
  FontFamily->"Courier"],
 " has no effect:"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{
   "A", "\[Wedge]", "B", "\[Wedge]", "A", "\[Wedge]", "B", "\[Wedge]", "A", 
    "\[Wedge]", "B", "\[Wedge]", "A"}], "/.", "CH3"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReplaceAll", "::", "\<\"reps\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(\\*StyleBox[\\!\\({\\(CHrul[3]\\)}\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" is neither a list of \
replacement rules nor a valid dispatch table, and so cannot be used for \
replacing.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/ReplaceAll/reps\\\", \
ButtonNote -> \\\"ReplaceAll::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.574641260603483*^9, 3.5746415485948353`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SuperscriptBox["A", "4"], " ", 
   SuperscriptBox["B", "3"]}], "/.", "\[InvisibleSpace]", 
  RowBox[{"CHrul", "[", "3", "]"}]}]], "Output",
 CellChangeTimes->{3.574641260604331*^9, 3.5746415485983267`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["\t",
  FontWeight->"Bold"],
 StyleBox["Warning",
  FontWeight->"Bold",
  FontColor->RGBColor[1, 0, 0]],
 StyleBox[" ",
  FontWeight->"Bold"],
 ": ",
 StyleBox["The rules returned by ",
  FontWeight->"Plain"],
 StyleBox["CHrul",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[" must never be applied repeatedly (",
  FontWeight->"Plain"],
 StyleBox["//.",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox["), as there is a term on the rhs that matches the lhs (",
  FontWeight->"Plain"],
 StyleBox["tr[lhs]",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox["),  To apply these rules repeatedly, one must use another symbol, \
say ",
  FontWeight->"Plain"],
 StyleBox["trnA",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[", for the trace of the product of n A matrices.",
  FontWeight->"Plain"]
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"TimeConstrained", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"A", "\[Wedge]", "A", "\[Wedge]", "A"}], "//.", 
    RowBox[{"CHrul", "[", 
     RowBox[{"3", ",", "A"}], "]"}]}], ",", "3"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReplaceRepeated", "::", "\<\"reps\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(\\*StyleBox[\\!\\({\\(CHrul[\\(\\(3, \
A\\)\\)]\\)}\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" is \
neither a list of replacement rules nor a valid dispatch table, and so cannot \
be used for replacing.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/ReplaceRepeated/reps\\\", ButtonNote -> \\\
\"ReplaceRepeated::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.5746412606390963`*^9, 3.574641548644478*^9}],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["A", "3"], "//.", "\[InvisibleSpace]", 
  RowBox[{"CHrul", "[", 
   RowBox[{"3", ",", "A"}], "]"}]}]], "Output",
 CellChangeTimes->{3.574641260639941*^9, 3.574641548647986*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{
   RowBox[{"A", "\[Wedge]", "A", "\[Wedge]", "A"}], "//.", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"CHrul", "[", 
      RowBox[{"3", ",", "A"}], "]"}], "/.", 
     RowBox[{
      RowBox[{"tr", "[", 
       RowBox[{"A", "\[Wedge]", "A", "\[Wedge]", "A"}], "]"}], "->", 
      "tr3A"}]}], ")"}]}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ReplaceRepeated", "::", "\<\"reps\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\[NoBreak]\\!\\(\\*StyleBox[\\!\\({\\(CHrul[\\(\\(3, \
A\\)\\)]\\)}\\), \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" is \
neither a list of replacement rules nor a valid dispatch table, and so cannot \
be used for replacing.\\\\\\\"\\\", \\\"MT\\\"]\\) \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/ReplaceRepeated/reps\\\", ButtonNote -> \\\
\"ReplaceRepeated::reps\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.57464126067001*^9, 3.574641548695099*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0007020000000004245`", ",", 
   RowBox[{
    SuperscriptBox["A", "3"], "//.", "\[InvisibleSpace]", 
    RowBox[{"CHrul", "[", 
     RowBox[{"3", ",", "A"}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.574641260670846*^9, 3.574641548699347*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Note ",
  FontWeight->"Bold"],
 ": ",
 StyleBox["Wedge,",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[" instead of ",
  FontWeight->"Plain"],
 StyleBox["Dot",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[",  must be used to multiply matrices together and scalar \
differential forms with matrices. ",
  FontWeight->"Plain"],
 StyleBox["Wedge",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[" can handle both symbolic and explicit matrices (list of lists). ",
  
  FontWeight->"Plain"],
 StyleBox["Wedge",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[" also gives the correct result when multiplying explicit matrices \
(two-dim arrays) with vectors (one-dim arrays), but operations with symbolic \
vectors are not supported. For example:",
  FontWeight->"Plain"]
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mat", "=", 
  RowBox[{"A", "/.", "matComp"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"1", ",", "1"}], "]"}], ",", 
     RowBox[{"Ac", "[", 
      RowBox[{"1", ",", "2"}], "]"}], ",", 
     RowBox[{"Ac", "[", 
      RowBox[{"1", ",", "3"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"2", ",", "1"}], "]"}], ",", 
     RowBox[{"Ac", "[", 
      RowBox[{"2", ",", "2"}], "]"}], ",", 
     RowBox[{"Ac", "[", 
      RowBox[{"2", ",", "3"}], "]"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Ac", "[", 
      RowBox[{"3", ",", "1"}], "]"}], ",", 
     RowBox[{"Ac", "[", 
      RowBox[{"3", ",", "2"}], "]"}], ",", 
     RowBox[{"Ac", "[", 
      RowBox[{"3", ",", "3"}], "]"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.574641260703274*^9, 3.574641548743833*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Vec", "=", 
  RowBox[{"Array", "[", 
   RowBox[{"v", ",", 
    RowBox[{"{", "3", "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"v", "[", "1", "]"}], ",", 
   RowBox[{"v", "[", "2", "]"}], ",", 
   RowBox[{"v", "[", "3", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.574641260735794*^9, 3.574641548797971*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"DeclareForms", "[", 
  RowBox[{"1", ",", 
   RowBox[{"v", "[", "_", "]"}]}], "]"}]], "Input"],

Cell[TextData[{
 "(i.e., ",
 StyleBox["Vec",
  FontFamily->"Courier"],
 " is an 1-form vector)"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Mat", 
  StyleBox["\[Wedge]", "Output\[Times]"], "Vec"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"1", ",", "1"}], "]"}], " ", 
      RowBox[{"v", "[", "1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"1", ",", "2"}], "]"}], " ", 
      RowBox[{"v", "[", "1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"1", ",", "3"}], "]"}], " ", 
      RowBox[{"v", "[", "1", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"v", "[", "2", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"2", ",", "2"}], "]"}], " ", 
      RowBox[{"v", "[", "2", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"2", ",", "3"}], "]"}], " ", 
      RowBox[{"v", "[", "2", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"3", ",", "1"}], "]"}], " ", 
      RowBox[{"v", "[", "3", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"v", "[", "3", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"3", ",", "3"}], "]"}], " ", 
      RowBox[{"v", "[", "3", "]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.5746412608018513`*^9, 3.574641548874783*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Vec", 
  StyleBox["\[Wedge]", "Output\[Times]"], "Mat"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"1", ",", "1"}], "]"}], " ", 
      RowBox[{"v", "[", "1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"1", ",", "2"}], "]"}], " ", 
      RowBox[{"v", "[", "1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"1", ",", "3"}], "]"}], " ", 
      RowBox[{"v", "[", "1", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"2", ",", "1"}], "]"}], " ", 
      RowBox[{"v", "[", "2", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"2", ",", "2"}], "]"}], " ", 
      RowBox[{"v", "[", "2", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"2", ",", "3"}], "]"}], " ", 
      RowBox[{"v", "[", "2", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"3", ",", "1"}], "]"}], " ", 
      RowBox[{"v", "[", "3", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"3", ",", "2"}], "]"}], " ", 
      RowBox[{"v", "[", "3", "]"}]}], ",", 
     RowBox[{
      RowBox[{"Ac", "[", 
       RowBox[{"3", ",", "3"}], "]"}], " ", 
      RowBox[{"v", "[", "3", "]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.5746412608351297`*^9, 3.5746415489147587`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"Vec", 
   StyleBox["\[Wedge]", "Output\[Times]"], "Mat", 
   StyleBox["\[Wedge]", "Output\[Times]"], "Vec"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"v", "[", "1", "]"}], ",", 
    RowBox[{"v", "[", "2", "]"}], ",", 
    RowBox[{"v", "[", "3", "]"}]}], "}"}], "\[Wedge]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"v", "[", "1", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"v", "[", "1", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"1", ",", "3"}], "]"}], " ", 
       RowBox[{"v", "[", "1", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"v", "[", "2", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"v", "[", "2", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       RowBox[{"v", "[", "2", "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"3", ",", "1"}], "]"}], " ", 
       RowBox[{"v", "[", "3", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"3", ",", "2"}], "]"}], " ", 
       RowBox[{"v", "[", "3", "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"3", ",", "3"}], "]"}], " ", 
       RowBox[{"v", "[", "3", "]"}]}]}], "}"}]}], "}"}]}]], "Output",
 CellChangeTimes->{3.5746412608741493`*^9, 3.574641548948936*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Vec", 
  StyleBox["\[Wedge]", "Output\[Times]"], 
  RowBox[{"d", "[", "Vec", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"v", "[", "1", "]"}], ",", 
    RowBox[{"v", "[", "2", "]"}], ",", 
    RowBox[{"v", "[", "3", "]"}]}], "}"}], "\[Wedge]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"d", "[", 
     RowBox[{"v", "[", "1", "]"}], "]"}], ",", 
    RowBox[{"d", "[", 
     RowBox[{"v", "[", "2", "]"}], "]"}], ",", 
    RowBox[{"d", "[", 
     RowBox[{"v", "[", "3", "]"}], "]"}]}], "}"}]}]], "Output",
 CellChangeTimes->{3.5746412609026003`*^9, 3.574641548995212*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Vec", 
  StyleBox["\[Wedge]", "Output\[Times]"], "Mat", 
  StyleBox["\[Wedge]", "Output\[Times]"], 
  RowBox[{"d", "[", "Vec", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"v", "[", "1", "]"}], ",", 
    RowBox[{"v", "[", "2", "]"}], ",", 
    RowBox[{"v", "[", "3", "]"}]}], "}"}], "\[Wedge]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"1", ",", "1"}], "]"}], " ", 
       RowBox[{"d", "[", 
        RowBox[{"v", "[", "1", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"1", ",", "2"}], "]"}], " ", 
       RowBox[{"d", "[", 
        RowBox[{"v", "[", "1", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"1", ",", "3"}], "]"}], " ", 
       RowBox[{"d", "[", 
        RowBox[{"v", "[", "1", "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"d", "[", 
        RowBox[{"v", "[", "2", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       RowBox[{"d", "[", 
        RowBox[{"v", "[", "2", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"2", ",", "3"}], "]"}], " ", 
       RowBox[{"d", "[", 
        RowBox[{"v", "[", "2", "]"}], "]"}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"3", ",", "1"}], "]"}], " ", 
       RowBox[{"d", "[", 
        RowBox[{"v", "[", "3", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"3", ",", "2"}], "]"}], " ", 
       RowBox[{"d", "[", 
        RowBox[{"v", "[", "3", "]"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"Ac", "[", 
        RowBox[{"3", ",", "3"}], "]"}], " ", 
       RowBox[{"d", "[", 
        RowBox[{"v", "[", "3", "]"}], "]"}]}]}], "}"}]}], "}"}]}]], "Output",
 CellChangeTimes->{3.574641260939378*^9, 3.574641549049685*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "[", "x", "]"}], 
  StyleBox["\[Wedge]", "Output\[Times]"], "Vec"}]], "Input"],

Cell[BoxData[
 RowBox[{"dx", "\[Wedge]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"v", "[", "1", "]"}], ",", 
    RowBox[{"v", "[", "2", "]"}], ",", 
    RowBox[{"v", "[", "3", "]"}]}], "}"}]}]], "Output",
 CellChangeTimes->{3.574641260970923*^9, 3.574641549094548*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"d", "[", "Mat", "]"}], 
  StyleBox["\[Wedge]", "Output\[Times]"], "Vec"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "}"}]}], "}"}], "\[Wedge]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"v", "[", "1", "]"}], ",", 
    RowBox[{"v", "[", "2", "]"}], ",", 
    RowBox[{"v", "[", "3", "]"}]}], "}"}]}]], "Output",
 CellChangeTimes->{3.574641261025908*^9, 3.574641549149225*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"Vec", 
   StyleBox["\[Wedge]", "Output\[Times]"], "%"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{"v", "[", "1", "]"}], ",", 
    RowBox[{"v", "[", "2", "]"}], ",", 
    RowBox[{"v", "[", "3", "]"}]}], "}"}], "\[Wedge]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"1", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"2", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"2", ",", "3"}], "]"}], "]"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"d", "[", 
       RowBox[{"Ac", "[", 
        RowBox[{"3", ",", "3"}], "]"}], "]"}]}], "}"}]}], "}"}], "\[Wedge]", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"v", "[", "1", "]"}], ",", 
    RowBox[{"v", "[", "2", "]"}], ",", 
    RowBox[{"v", "[", "3", "]"}]}], "}"}]}]], "Output",
 CellChangeTimes->{3.574641261054119*^9, 3.574641549195937*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Introducing Custom Notation", "Text",
  FontFamily->"Times",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[" :", "Text",
  FontFamily->"Times",
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" Sometimes one may want to use a shorthand notation of the form ", 
  "Text",
  FontFamily->"Times",
  FontWeight->"Plain"],
 StyleBox["K[A]", "Text",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[" for an operation with matrices (or other variables) that should \
not be interpreted as a function under ", "Text",
  FontFamily->"Times",
  FontWeight->"Plain"],
 StyleBox["d", "Text",
  FontFamily->"Courier",
  FontWeight->"Plain"],
 StyleBox[". I.e., one wants to avoid the following", "Text",
  FontFamily->"Times",
  FontWeight->"Plain"]
}], "Subsubsection"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Inverse", "[", "S", "]"}], ",", 
    RowBox[{"MyNotation", "[", 
     RowBox[{"form", ",", "vars"}], "]"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", "S", "]"}], " ", 
    RowBox[{
     SuperscriptBox["Inverse", "\[Prime]",
      MultilineFunction->None], "[", "S", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"d", "[", "vars", "]"}], " ", 
     RowBox[{
      SuperscriptBox["MyNotation", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"0", ",", "1"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"form", ",", "vars"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"d", "[", "form", "]"}], " ", 
     RowBox[{
      SuperscriptBox["MyNotation", 
       TagBox[
        RowBox[{"(", 
         RowBox[{"1", ",", "0"}], ")"}],
        Derivative],
       MultilineFunction->None], "[", 
      RowBox[{"form", ",", "vars"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.574641261108778*^9, 3.5746415492508087`*^9}]
}, Open  ]],

Cell[TextData[{
 "This can be achieved by: \t(1) Calling the function ",
 StyleBox["NoDif[heads__]",
  FontFamily->"Courier"],
 ", \n\t\t\t\t(2) Setting the value of ",
 StyleBox["FormDegree[..]",
  FontFamily->"Courier"],
 " if > 0 and\n\t\t\t\t(3) Setting the values of ",
 StyleBox["BasicMatQ[..]",
  FontFamily->"Courier"],
 " / ",
 StyleBox["BasicScalFormQ[..]",
  FontFamily->"Courier"],
 " if ",
 StyleBox["True. \n",
  FontFamily->"Courier"],
 "For example,"
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NoDif", "[", 
   RowBox[{"Inverse", ",", "MyNotation"}], "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"BasicMatQ", "[", 
    RowBox[{"Inverse", "[", "x_", "]"}], "]"}], ":=", 
   RowBox[{"BasicMatQ", "[", "x", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FormDegree", "[", 
    RowBox[{"MyNotation", "[", 
     RowBox[{"x_", ",", "y_"}], "]"}], "]"}], ":=", 
   RowBox[{"FormDegree", "[", "y", "]"}]}], ";"}]}], "Input"],

Cell[TextData[{
 "Now ",
 StyleBox["d",
  FontFamily->"Courier"],
 " has no effect"
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Inverse", "[", "S", "]"}], ",", 
    RowBox[{"MyNotation", "[", 
     RowBox[{"form", ",", "vars"}], "]"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"Inverse", "[", "S", "]"}], "]"}], ",", 
   RowBox[{"d", "[", 
    RowBox[{"MyNotation", "[", 
     RowBox[{"form", ",", "vars"}], "]"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.574641261168724*^9, 3.574641549326716*^9}]
}, Open  ]],

Cell["\<\
One can then assign values for the exterior derivatives of these operations \
and make other definitions:\
\>", "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"Inverse", "[", "x_", "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Inverse", "[", "x", "]"}], "\[Wedge]", 
       RowBox[{"d", "[", "x", "]"}], "\[Wedge]", 
       RowBox[{"Inverse", "[", "x", "]"}]}], ")"}]}], "/;", 
    RowBox[{
     RowBox[{"BasicMatQ", "[", "x", "]"}], "&&", 
     RowBox[{
      RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"x_", "\[Wedge]", 
    RowBox[{"Inverse", "[", "x_", "]"}]}], ":=", 
   RowBox[{"1", "/;", 
    RowBox[{
     RowBox[{"BasicMatQ", "[", "x", "]"}], "&&", 
     RowBox[{
      RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}]}]}]}], ";", 
  RowBox[{
   RowBox[{
    RowBox[{"Inverse", "[", "x_", "]"}], "\[Wedge]", "x_"}], ":=", 
   RowBox[{"1", "/;", 
    RowBox[{
     RowBox[{"BasicMatQ", "[", "x", "]"}], "&&", 
     RowBox[{
      RowBox[{"FormDegree", "[", "x", "]"}], "===", "0"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{"S", "\[Wedge]", 
  RowBox[{"d", "[", 
   RowBox[{"Inverse", "[", "S", "]"}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{"S", " ", 
  RowBox[{"d", "[", 
   RowBox[{"Inverse", "[", "S", "]"}], "]"}]}]], "Output",
 CellChangeTimes->{3.574641261205805*^9, 3.574641549382412*^9}]
}, Open  ]],

Cell[TextData[{
 "Of course, for a single matrix, it is much simpler to use a new symbol  ",
 StyleBox["DeclareMatrixForms[{0,invS,invS}]",
  FontFamily->"Courier"],
 " and then set ",
 StyleBox["d[invS]=-(invS",
  FontFamily->"Courier"],
 "\[Wedge]",
 StyleBox["d[S]",
  FontFamily->"Courier"],
 "\[Wedge]",
 StyleBox["invS);invS",
  FontFamily->"Courier"],
 "\[Wedge]",
 StyleBox["S=1;S",
  FontFamily->"Courier"],
 "\[Wedge]",
 StyleBox["invS=1;",
  FontFamily->"Courier"],
 "!"
}], "Text",
 TextAlignment->Left,
 TextJustification->0,
 FontSize->14]
}, Open  ]]
}, Open  ]],

Cell["\<\

\
\>", "Text"],

Cell[CellGroupData[{

Cell["Sample Applications in Mathematical Physics", "Text",
 ShowGroupOpener->True,
 FontFamily->"Times",
 FontSize->24,
 FontWeight->"Bold",
 FontSlant->"Italic",
 FontColor->GrayLevel[1],
 Background->RGBColor[0, 0, 1]],

Cell[TextData[{
 "\n",
 StyleBox["Important",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 ": Before proceeding, evaluate ",
 StyleBox["matEDCcode.nb",
  FontWeight->"Bold"],
 " to clear all previously defined symbols.\n\t",
 StyleBox["(All timings refer to an Apple iBook G3/900 computer running ",
  FontSize->14,
  FontWeight->"Plain"],
 StyleBox["Mathematica",
  FontSize->14,
  FontWeight->"Plain",
  FontSlant->"Italic"],
 StyleBox[" 3.0 under Mac OS 9.2.2)",
  FontSize->14,
  FontWeight->"Plain"]
}], "Text",
 PageWidth->WindowWidth,
 FontColor->RGBColor[0, 0, 1]],

Cell[CellGroupData[{

Cell["\<\
(1) Computing all Newman-Penrose scalars for the Vaidya metric (~ 25 sec)\
\>", "Subsection",
 ShowGroupOpener->True],

Cell[TextData[{
 "The following code calculates all Newman-Penrose scalars for the Vaidya \
metric and checks the cyclic and Bianchi idendities.\n(Takes  ~ 25 sec with \
",
 StyleBox["matEDCcode",
  FontWeight->"Bold"],
 " and ~ 21 sec with ",
 StyleBox["scalEDCcode",
  FontWeight->"Bold"],
 ". More than half of this time is spent in checking the identities). \nTo do \
the same calculation for other metrics make appropriate changes to the \
null-frame ",
 StyleBox["\[DoubleStruckL],\[DoubleStruckM],\[DoubleStruckM]B,\
\[DoubleStruckN]",
  FontFamily->"Courier",
  FontWeight->"Bold"],
 " definitions. For complicated metrics additional simplification statements \
(or rules in ",
 StyleBox["simpRules",
  FontFamily->"Courier"],
 ") may be needed."
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{
    RowBox[{"General", "::", "\"\<spell\>\""}], ",", 
    RowBox[{"General", "::", "\"\<spell1\>\""}]}], "]"}], ";", 
  RowBox[{
   RowBox[{"Bar", "[", "x_", "]"}], ":=", "x"}], ";", 
  RowBox[{"sT", "=", 
   RowBox[{"TimeUsed", "[", "]"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[TextData[{
 "\tDEFINE NULL FRAME  ",
 StyleBox["\[DoubleStruckL],\[DoubleStruckM],\[DoubleStruckM]B,\
\[DoubleStruckN]",
  FontFamily->"Courier",
  FontWeight->"Bold"]
}], "Subsubsection",
 ShowGroupOpener->True],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Delta0", "=", 
    RowBox[{
     SuperscriptBox["r", "2"], "+", 
     SuperscriptBox["a", "2"]}]}], " ", ";", 
   RowBox[{"Delta", "=", 
    RowBox[{"Delta0", "-", 
     RowBox[{"2", "M", " ", "r"}]}]}], ";", 
   RowBox[{"Sigma", "=", 
    RowBox[{
     SuperscriptBox["r", "2"], "+", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["x", "2"]}]}]}], ";"}], 
  StyleBox[
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"*", " ", 
      StyleBox["x",
       FontColor->RGBColor[0, 0, 1]]}], 
     StyleBox["=",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[
      RowBox[{"Cos", "[", "\[Theta]", "]"}],
      FontColor->RGBColor[0, 0, 1]]}], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], "**)"}],
   FontSlant->"Plain",
   FontTracking->"Plain",
   FontVariations->{"Outline"->False,
   "Shadow"->False,
   "Underline"->False}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"BaseFrame", "=", 
   RowBox[{"reWrite", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"d", "[", "t", "]"}], "-", 
       RowBox[{"a", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["x", "2"]}], ")"}], " ", 
        RowBox[{"d", "[", "\[CurlyPhi]", "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"Sigma", "/", "Delta"}], " ", 
       RowBox[{"d", "[", "r", "]"}]}], ",", 
      RowBox[{
       RowBox[{"-", "Sigma"}], " ", 
       RowBox[{
        RowBox[{"d", "[", "x", "]"}], "/", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          SuperscriptBox["x", "2"]}], "]"}]}]}], ",", 
      RowBox[{
       RowBox[{"a", " ", 
        RowBox[{"d", "[", "t", "]"}]}], "-", 
       RowBox[{"Delta0", " ", 
        RowBox[{"d", "[", "\[CurlyPhi]", "]"}]}]}]}], "}"}], "]"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"*", 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["Transform",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["t",
      FontColor->RGBColor[0, 0, 1]]}], 
    StyleBox[",",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[
     RowBox[{"\[CurlyPhi]", " ", "coordinates"}],
     FontColor->RGBColor[0, 0, 1]]}], " ", "**)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", "t", "]"}], "=", 
    RowBox[{
     RowBox[{"d", "[", "u", "]"}], "+", 
     RowBox[{"Delta0", " ", 
      RowBox[{
       RowBox[{"d", "[", "r", "]"}], "/", "Delta"}]}]}]}], ";", 
   RowBox[{
    RowBox[{"d", "[", "\[CurlyPhi]", "]"}], "=", 
    RowBox[{
     RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], "+", 
     RowBox[{"a", " ", 
      RowBox[{
       RowBox[{"d", "[", "r", "]"}], "/", "Delta"}]}]}]}], ";"}]}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"lCoef", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], ";"}], "\n", 
 RowBox[{"\[DoubleStruckL]", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{"lCoef", ".", "BaseFrame"}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"a", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "x"}], ")"}], " ", 
   RowBox[{"d", "[", "n\[CurlyPhi]", "]"}]}], "+", 
  RowBox[{"d", "[", "u", "]"}]}]], "Output",
 CellChangeTimes->{3.574641261357273*^9, 3.5746415496757402`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nCoef", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "0", ",", "0"}], "}"}], 
    RowBox[{"Delta", "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", "Sigma"}], ")"}]}]}]}], ";"}], "\n", 
 RowBox[{"\[DoubleStruckN]", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{"nCoef", ".", "BaseFrame"}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"a", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "-", 
      RowBox[{"2", " ", "M", " ", "r"}], "+", 
      SuperscriptBox["r", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    RowBox[{"d", "[", "n\[CurlyPhi]", "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}]}]], "+", 
  RowBox[{"d", "[", "r", "]"}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "-", 
      RowBox[{"2", " ", "M", " ", "r"}], "+", 
      SuperscriptBox["r", "2"]}], ")"}], " ", 
    RowBox[{"d", "[", "u", "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.57464126138937*^9, 3.57464154971212*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"mCoef", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"I", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{"1", "-", 
         RowBox[{"x", "^", "2"}]}], "]"}]}]}], "}"}], "/", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"2", " ", "Sigma"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{"\[DoubleStruckM]", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{"mCoef", ".", "BaseFrame"}], "]"}]}]}], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"dx", " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["r", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    RowBox[{"d", "[", "n\[CurlyPhi]", "]"}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]]}]], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    RowBox[{"d", "[", "u", "]"}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]]}]]}]], "Output",
 CellChangeTimes->{3.574641261424634*^9, 3.574641549745269*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[DoubleStruckM]B", "=", 
   RowBox[{"Bar", "[", "\[DoubleStruckM]", "]"}]}], ";"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"LineElement", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"2", "\[DoubleStruckL]", "*", "\[DoubleStruckN]"}], "-", 
    RowBox[{"2", "\[DoubleStruckM]", "*", "\[DoubleStruckM]B"}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["dx", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}]}], 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       SuperscriptBox["a", "2"], " ", "M", " ", "r"}], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["r", "2"]}], "+", 
      SuperscriptBox["r", "4"], "+", 
      RowBox[{
       SuperscriptBox["a", "4"], " ", 
       SuperscriptBox["x", "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["a", "2"], " ", "M", " ", "r", " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["r", "2"], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], "2"]}], 
   RowBox[{
    SuperscriptBox["r", "2"], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox["x", "2"]}]}]], "+", 
  RowBox[{"2", " ", 
   RowBox[{"d", "[", "r", "]"}], " ", 
   RowBox[{"d", "[", "u", "]"}]}], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "M", " ", "r"}], "-", 
      SuperscriptBox["r", "2"], "-", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"d", "[", "u", "]"}], "2"]}], 
   RowBox[{
    SuperscriptBox["r", "2"], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox["x", "2"]}]}]], "+", 
  RowBox[{
   RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "a", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}], " ", 
      RowBox[{"d", "[", "r", "]"}]}], "-", 
     FractionBox[
      RowBox[{"4", " ", "a", " ", "M", " ", "r", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}], " ", 
       RowBox[{"d", "[", "u", "]"}]}], 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["x", "2"]}]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.5746412614877663`*^9, 3.5746415499082003`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"d", "[", "a", "]"}], "=", "0"}], ";", 
   RowBox[{"M", "=", 
    RowBox[{"m", "[", "u", "]"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"*", " ", 
      StyleBox["Vaidya",
       FontColor->RGBColor[0, 0, 1]]}], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["-",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[
      RowBox[{"for", " ", "Kerr", " ", "set", " ", 
       RowBox[{"d", "[", "M", "]"}]}],
      FontColor->RGBColor[0, 0, 1]]}], 
    StyleBox["=",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["0",
     FontColor->RGBColor[0, 0, 1]]}], " ", "**)"}]}]], "Input"],

Cell[TextData[{
 "\t",
 StyleBox["END DEFINE METRIC",
  FontWeight->"Bold"],
 " "
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"iden", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{"I", " ", 
    RowBox[{
    "\[DoubleStruckL]", "\[Wedge]", "\[DoubleStruckN]", "\[Wedge]", 
     "\[DoubleStruckM]", "\[Wedge]", "\[DoubleStruckM]B"}]}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["r", "2"], "+", 
    RowBox[{
     SuperscriptBox["a", "2"], " ", 
     SuperscriptBox["x", "2"]}]}], ")"}], " ", 
  RowBox[{"dx", "\[Wedge]", 
   RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], "\[Wedge]", 
   RowBox[{"d", "[", "r", "]"}], "\[Wedge]", 
   RowBox[{"d", "[", "u", "]"}]}]}]], "Output",
 CellChangeTimes->{3.57464126159382*^9, 3.574641549966967*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"star4", "=", 
  RowBox[{
   RowBox[{"Times", "[", 
    RowBox[{"u__", ",", 
     RowBox[{"Wedge", "[", "x_", "]"}]}], "]"}], ":>", 
   RowBox[{"Times", "[", "u", "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"u__", " ", 
   RowBox[{"Wedge", "[", "x_", "]"}]}], "\[RuleDelayed]", 
  RowBox[{"Times", "[", "u", "]"}]}]], "Output",
 CellChangeTimes->{3.574641261628049*^9, 3.574641550012558*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vol", "=", 
  RowBox[{"iden", "/.", "star4"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  SuperscriptBox["r", "2"], "+", 
  RowBox[{
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox["x", "2"]}]}]], "Output",
 CellChangeTimes->{3.574641261662364*^9, 3.5746415500468693`*^9}]
}, Open  ]],

Cell[TextData[{
 "Define the self-dual 2-forms ",
 StyleBox["f[i]",
  FontFamily->"Courier"],
 ":"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "0", "]"}], "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{"\[DoubleStruckM]", "\[Wedge]", "\[DoubleStruckL]"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]], " ", 
    RowBox[{"dx", "\[Wedge]", 
     RowBox[{"d", "[", "n\[CurlyPhi]", "]"}]}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]]}]], "+", 
  FractionBox[
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]], " ", 
    RowBox[{"dx", "\[Wedge]", 
     RowBox[{"d", "[", "u", "]"}]}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]], " ", 
    RowBox[{
     RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], "\[Wedge]", 
     RowBox[{"d", "[", "u", "]"}]}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]]}]]}]], "Output",
 CellChangeTimes->{3.5746412616964397`*^9, 3.5746415501009197`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "1", "]"}], "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[DoubleStruckM]", "\[Wedge]", "\[DoubleStruckM]B"}], "-", 
      RowBox[{"\[DoubleStruckL]", "\[Wedge]", "\[DoubleStruckN]"}]}], ")"}], 
    "/", "2"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{"a", "+", 
     RowBox[{"\[ImaginaryI]", " ", "r"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "a"}], "+", "r"}], ")"}], " ", 
   RowBox[{"dx", "\[Wedge]", 
    RowBox[{"d", "[", "n\[CurlyPhi]", "]"}]}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "\[ImaginaryI]", " ", "a", " ", 
   RowBox[{"dx", "\[Wedge]", 
    RowBox[{"d", "[", "u", "]"}]}]}], "-", 
  RowBox[{
   FractionBox["1", "2"], " ", "a", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "x"}], ")"}], " ", 
   RowBox[{
    RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "r", "]"}]}]}], "+", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{
    RowBox[{"d", "[", "r", "]"}], "\[Wedge]", 
    RowBox[{"d", "[", "u", "]"}]}]}]}]], "Output",
 CellChangeTimes->{3.574641261724596*^9, 3.574641550147541*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"f", "[", "2", "]"}], "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{"\[DoubleStruckN]", "\[Wedge]", "\[DoubleStruckM]B"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"a", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["a", "2"], "+", 
       SuperscriptBox["r", "2"], "-", 
       RowBox[{"2", " ", "r", " ", 
        RowBox[{"m", "[", "u", "]"}]}]}], ")"}], " ", 
     RowBox[{"dx", "\[Wedge]", 
      RowBox[{"d", "[", "n\[CurlyPhi]", "]"}]}]}], 
    RowBox[{"2", " ", 
     SqrtBox["2"], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}]], " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["x", "2"]}]}]]}]]}], "-", 
  FractionBox[
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]], " ", 
    RowBox[{"dx", "\[Wedge]", 
     RowBox[{"d", "[", "r", "]"}]}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]]}]], "-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["r", "2"], "-", 
      RowBox[{"2", " ", "r", " ", 
       RowBox[{"m", "[", "u", "]"}]}]}], ")"}], " ", 
    RowBox[{"dx", "\[Wedge]", 
     RowBox[{"d", "[", "u", "]"}]}]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["r", "2"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    RowBox[{
     RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], "\[Wedge]", 
     RowBox[{"d", "[", "r", "]"}]}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["r", "2"], "-", 
      RowBox[{"2", " ", "r", " ", 
       RowBox[{"m", "[", "u", "]"}]}]}], ")"}], " ", 
    RowBox[{
     RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], "\[Wedge]", 
     RowBox[{"d", "[", "u", "]"}]}]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    RowBox[{
     RowBox[{"d", "[", "r", "]"}], "\[Wedge]", 
     RowBox[{"d", "[", "u", "]"}]}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}]]}]]}]], "Output",
 CellChangeTimes->{3.574641261760742*^9, 3.574641550206108*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"fB", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"fB", "[", "i", "]"}], "=", 
    RowBox[{"Bar", "[", 
     RowBox[{"f", "[", "i", "]"}], "]"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"df", "[", "i_", "]"}], ":=", 
   RowBox[{
    RowBox[{"df", "[", "i", "]"}], "=", 
    RowBox[{"reWrite", "[", 
     RowBox[{"d", "[", 
      RowBox[{"f", "[", "i", "]"}], "]"}], "]"}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell["CALCULATE THE SPIN COEFFICIENTS:", "Text",
 ShowGroupOpener->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Kappa]", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{"\[DoubleStruckL]", "\[Wedge]", 
       RowBox[{
        RowBox[{"df", "[", "0", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
   "star4"}]}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641261843767*^9, 3.574641550308051*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Sigma]", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{"\[DoubleStruckM]", "\[Wedge]", 
       RowBox[{
        RowBox[{"df", "[", "0", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
   "star4"}]}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641261875366*^9, 3.574641550349865*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Rho]", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{"\[DoubleStruckL]", "\[Wedge]", 
       RowBox[{
        RowBox[{"df", "[", "1", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
   "star4"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox["1", 
   RowBox[{"r", "-", 
    RowBox[{"\[ImaginaryI]", " ", "a", " ", "x"}]}]]}]], "Output",
 CellChangeTimes->{3.574641261909471*^9, 3.574641550385824*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Mu]", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{"\[DoubleStruckN]", "\[Wedge]", 
       RowBox[{
        RowBox[{"df", "[", "1", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
   "star4"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["a", "2"], "+", 
    SuperscriptBox["r", "2"], "-", 
    RowBox[{"2", " ", "r", " ", 
     RowBox[{"m", "[", "u", "]"}]}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "r"}], "-", 
      RowBox[{"\[ImaginaryI]", " ", "a", " ", "x"}]}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "r"}], "+", 
       RowBox[{"a", " ", "x"}]}], ")"}], "2"]}]]}]], "Output",
 CellChangeTimes->{3.574641261942696*^9, 3.574641550431254*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Pi]", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{"\[DoubleStruckM]B", "\[Wedge]", 
       RowBox[{
        RowBox[{"df", "[", "1", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
   "star4"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "x"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "r"}], "+", 
     RowBox[{"a", " ", "x"}]}], ")"}]}], 
  RowBox[{
   SqrtBox["2"], " ", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["x", "2"]}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}], 
    RowBox[{"3", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{3.5746412619761353`*^9, 3.5746415505278597`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Tau]", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{"\[DoubleStruckM]", "\[Wedge]", 
       RowBox[{
        RowBox[{"df", "[", "1", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
   "star4"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"a", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "r"}], "+", 
      RowBox[{"a", " ", "x"}]}], ")"}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["x", "2"]}]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}]]}]], "Output",
 CellChangeTimes->{3.574641262009859*^9, 3.574641550564598*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Nu]", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{"\[DoubleStruckN]", "\[Wedge]", 
       RowBox[{
        RowBox[{"df", "[", "2", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
   "star4"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", "a", " ", "r", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], "2"], " ", 
   RowBox[{
    SuperscriptBox["m", "\[Prime]",
     MultilineFunction->None], "[", "u", "]"}]}], 
  RowBox[{
   SqrtBox["2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}], ")"}], 
    RowBox[{"3", "/", "2"}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}], 
    RowBox[{"3", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{3.5746412620476007`*^9, 3.574641550728208*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Lambda]", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{"\[DoubleStruckM]B", "\[Wedge]", 
       RowBox[{
        RowBox[{"df", "[", "2", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
   "star4"}]}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.57464126207985*^9, 3.5746415507677507`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Gamma]", "=", 
  RowBox[{"Factor", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"NP\[Mu]", "-", 
       RowBox[{"reWrite", "[", 
        RowBox[{"I", " ", 
         RowBox[{"\[DoubleStruckM]", "\[Wedge]", 
          RowBox[{
           RowBox[{"df", "[", "2", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
      "star4"}], ")"}], "/", "2"}], "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{
    RowBox[{"-", "2"}], " ", 
    SuperscriptBox["a", "2"], " ", "r"}], "-", 
   RowBox[{"\[ImaginaryI]", " ", 
    SuperscriptBox["a", "3"], " ", "x"}], "-", 
   RowBox[{"\[ImaginaryI]", " ", "a", " ", 
    SuperscriptBox["r", "2"], " ", "x"}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox["a", "2"], " ", "r", " ", 
    SuperscriptBox["x", "2"]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"m", "[", "u", "]"}]}], "+", 
   RowBox[{"2", " ", "\[ImaginaryI]", " ", "a", " ", "r", " ", "x", " ", 
    RowBox[{"m", "[", "u", "]"}]}], "-", 
   RowBox[{"2", " ", 
    SuperscriptBox["a", "2"], " ", 
    SuperscriptBox["x", "2"], " ", 
    RowBox[{"m", "[", "u", "]"}]}]}], 
  RowBox[{"4", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"r", "-", 
      RowBox[{"\[ImaginaryI]", " ", "a", " ", "x"}]}], ")"}], "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"r", "+", 
      RowBox[{"\[ImaginaryI]", " ", "a", " ", "x"}]}], ")"}], 
    "2"]}]]], "Output",
 CellChangeTimes->{3.574641262132607*^9, 3.574641550803165*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Epsilon]", "=", 
  RowBox[{"Factor", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"NP\[Rho]", "-", 
       RowBox[{"reWrite", "[", 
        RowBox[{"I", " ", 
         RowBox[{"\[DoubleStruckM]B", "\[Wedge]", 
          RowBox[{
           RowBox[{"df", "[", "0", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
      "star4"}], ")"}], "/", "2"}], "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", " ", "x"}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[ImaginaryI]", " ", "r"}], "-", 
     RowBox[{"a", " ", "x"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"r", "-", 
     RowBox[{"\[ImaginaryI]", " ", "a", " ", "x"}]}], ")"}]}]]], "Output",
 CellChangeTimes->{3.574641262171483*^9, 3.574641550851986*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Beta]", "=", 
  RowBox[{"Factor", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"NP\[Tau]", "-", 
       RowBox[{"reWrite", "[", 
        RowBox[{"I", " ", 
         RowBox[{"\[DoubleStruckN]", "\[Wedge]", 
          RowBox[{
           RowBox[{"df", "[", "0", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
      "star4"}], ")"}], "/", "2"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "a", " ", "r"}], "+", 
      RowBox[{
       SuperscriptBox["r", "2"], " ", "x"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "a", " ", "r", " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "3"]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}], ")"}], 
     RowBox[{"3", "/", "2"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["x", "2"]}]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}]]}]], "Output",
 CellChangeTimes->{3.574641262201233*^9, 3.574641550910325*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NP\[Alpha]", "=", 
  RowBox[{"Factor", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"NP\[Pi]", "-", 
       RowBox[{"reWrite", "[", 
        RowBox[{"I", " ", 
         RowBox[{"\[DoubleStruckL]", "\[Wedge]", 
          RowBox[{
           RowBox[{"df", "[", "2", "]"}], "/", "vol"}]}]}], "]"}]}], "/.", 
      "star4"}], ")"}], "/", "2"}], "]"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "x"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], " ", "a", " ", "r"}], "+", 
     RowBox[{"2", " ", 
      SuperscriptBox["a", "2"], " ", "x"}], "+", 
     RowBox[{
      SuperscriptBox["r", "2"], " ", "x"}], "+", 
     RowBox[{"\[ImaginaryI]", " ", "a", " ", "r", " ", 
      SuperscriptBox["x", "2"]}], "-", 
     RowBox[{
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox["x", "3"]}]}], ")"}]}], 
  RowBox[{"2", " ", 
   SqrtBox["2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}], ")"}], 
    RowBox[{"3", "/", "2"}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}], 
    RowBox[{"3", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{3.574641262236354*^9, 3.574641550951661*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Definition of connection 1-forms:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Omega]0", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"NP\[Tau]", "*", "\[DoubleStruckL]"}], "+", 
    RowBox[{"NP\[Kappa]", "*", "\[DoubleStruckN]"}], " ", "-", 
    RowBox[{"NP\[Rho]", "*", "\[DoubleStruckM]"}], "-", 
    RowBox[{"NP\[Sigma]", "*", "\[DoubleStruckM]B"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"\[ImaginaryI]", " ", "dx", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"r", "+", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "x"}]}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "r"}], "+", 
       RowBox[{"a", " ", "x"}]}], ")"}]}], 
    RowBox[{
     SqrtBox["2"], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox["x", "2"]}]}], ")"}], 
      RowBox[{"3", "/", "2"}]]}]]}], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"r", "+", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "x"}]}], ")"}], "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", "r"}], "+", 
      RowBox[{"a", " ", "x"}]}], ")"}], " ", 
    RowBox[{"d", "[", "n\[CurlyPhi]", "]"}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["x", "2"]}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["x", "2"]}]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}]]}]], "Output",
 CellChangeTimes->{3.57464126228522*^9, 3.574641550989952*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Omega]1", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"NP\[Gamma]", "*", "\[DoubleStruckL]"}], "+", 
    RowBox[{"NP\[Epsilon]", "*", "\[DoubleStruckN]"}], " ", "-", 
    RowBox[{"NP\[Alpha]", "*", "\[DoubleStruckM]"}], "-", 
    RowBox[{"NP\[Beta]", "*", "\[DoubleStruckM]B"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox["a", "2"], " ", "dx", " ", "x"}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "r"}], "+", 
      RowBox[{"a", " ", "x"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", "r"}], "+", 
      RowBox[{"a", " ", "x"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"a", " ", "x", " ", 
    RowBox[{"d", "[", "r", "]"}]}], 
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "r"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "a", " ", "x"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "r"}], "+", 
      RowBox[{"a", " ", "x"}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"d", "[", "u", "]"}], " ", 
    RowBox[{"m", "[", "u", "]"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"r", "-", 
       RowBox[{"\[ImaginaryI]", " ", "a", " ", "x"}]}], ")"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"a", " ", "r"}], "-", 
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["a", "2"], " ", "x"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["r", "2"], " ", "x"}], "+", 
      RowBox[{"a", " ", "r", " ", 
       SuperscriptBox["x", "2"]}], "+", 
      RowBox[{"a", " ", 
       RowBox[{"m", "[", "u", "]"}]}], "-", 
      RowBox[{"a", " ", 
       SuperscriptBox["x", "2"], " ", 
       RowBox[{"m", "[", "u", "]"}]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "r"}], "+", 
       RowBox[{"a", " ", "x"}]}], ")"}], "2"]}]]}]], "Output",
 CellChangeTimes->{3.574641262529181*^9, 3.574641551065247*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Omega]2", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"NP\[Nu]", "*", "\[DoubleStruckL]"}], "+", 
    RowBox[{"NP\[Pi]", "*", "\[DoubleStruckN]"}], " ", "-", 
    RowBox[{"NP\[Lambda]", "*", "\[DoubleStruckM]"}], "-", 
    RowBox[{"NP\[Mu]", "*", "\[DoubleStruckM]B"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"a", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "r"}], "+", 
       RowBox[{"a", " ", "x"}]}], ")"}], " ", 
     RowBox[{"d", "[", "r", "]"}]}], 
    RowBox[{
     SqrtBox["2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["x", "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["r", "2"], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox["x", "2"]}]}], ")"}], 
      RowBox[{"3", "/", "2"}]]}]]}], "-", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "dx", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "\[ImaginaryI]"}], " ", "r"}], "+", 
      RowBox[{"a", " ", "x"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["a", "2"], "+", 
      SuperscriptBox["r", "2"], "-", 
      RowBox[{"2", " ", "r", " ", 
       RowBox[{"m", "[", "u", "]"}]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}], ")"}], 
     RowBox[{"3", "/", "2"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["x", "2"]}]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}]], "+", 
  FractionBox[
   RowBox[{"\[ImaginaryI]", " ", "a", " ", "r", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}], "2"], " ", 
    RowBox[{"d", "[", "u", "]"}], " ", 
    RowBox[{
     SuperscriptBox["m", "\[Prime]",
      MultilineFunction->None], "[", "u", "]"}]}], 
   RowBox[{
    SqrtBox["2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}], ")"}], 
     RowBox[{"3", "/", "2"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["x", "2"]}]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}]], "+", 
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "x"}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "+", "x"}], ")"}], "2"], " ", 
    RowBox[{"d", "[", "n\[CurlyPhi]", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["a", "2"], " ", "r"}], "+", 
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["r", "3"]}], "-", 
      RowBox[{
       SuperscriptBox["a", "3"], " ", "x"}], "-", 
      RowBox[{"a", " ", 
       SuperscriptBox["r", "2"], " ", "x"}], "-", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["r", "2"], " ", 
       RowBox[{"m", "[", "u", "]"}]}], "+", 
      RowBox[{"2", " ", "a", " ", "r", " ", "x", " ", 
       RowBox[{"m", "[", "u", "]"}]}], "-", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["a", "2"], " ", "r", " ", 
       RowBox[{
        SuperscriptBox["m", "\[Prime]",
         MultilineFunction->None], "[", "u", "]"}]}], "+", 
      RowBox[{"2", " ", "\[ImaginaryI]", " ", 
       SuperscriptBox["a", "2"], " ", "r", " ", 
       SuperscriptBox["x", "2"], " ", 
       RowBox[{
        SuperscriptBox["m", "\[Prime]",
         MultilineFunction->None], "[", "u", "]"}]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SqrtBox["2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["x", "2"]}], ")"}], 
     RowBox[{"3", "/", "2"}]], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["r", "2"], "+", 
       RowBox[{
        SuperscriptBox["a", "2"], " ", 
        SuperscriptBox["x", "2"]}]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}]]}]], "Output",
 CellChangeTimes->{3.574641262657729*^9, 3.574641551193215*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeUsed", "[", "]"}], "-", "sT"}]], "Input"],

Cell[BoxData["0.7304589999999997`"], "Output",
 CellChangeTimes->{3.574641262795165*^9, 3.574641551232401*^9}]
}, Open  ]],

Cell["Definition of curvature 2-forms:", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "=", 
   RowBox[{
    RowBox[{"d", "[", "\[Omega]0", "]"}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"\[Omega]0", "\[Wedge]", "\[Omega]1"}]}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "=", 
   RowBox[{
    RowBox[{"d", "[", "\[Omega]1", "]"}], "+", 
    RowBox[{"\[Omega]0", "\[Wedge]", "\[Omega]2"}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "=", 
   RowBox[{
    RowBox[{"d", "[", "\[Omega]2", "]"}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"\[Omega]1", "\[Wedge]", "\[Omega]2"}]}]}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalOmega]", "[", "i", "]"}], "=", 
    RowBox[{"reWrite", "[", 
     RowBox[{"\[CapitalOmega]", "[", "i", "]"}], "]"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "0", ",", "2"}], "}"}]}], "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeUsed", "[", "]"}], "-", "sT"}]], "Input"],

Cell[BoxData["1.3289299999999997`"], "Output",
 CellChangeTimes->{3.574641263021669*^9, 3.574641551885298*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\tWEYL COMPONENTS AND SYMMETRIES", "Text",
 ShowGroupOpener->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPsi]0", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "0", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "/", "vol"}]}]}], "]"}]}],
    "/.", "star4"}]}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641263091017*^9, 3.574641551930066*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPsi]1", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "1", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "/", "vol"}]}]}], "]"}]}],
    "/.", "star4"}]}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641263160904*^9, 3.5746415519882183`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"\[CapitalPsi]1", "+", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "0", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "/", "vol"}]}]}], "]"}]}],
    "/.", "star4"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.5746412632871447`*^9, 3.57464155203318*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPsi]3", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "2", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "/", "vol"}]}]}], "]"}]}],
    "/.", "star4"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"\[ImaginaryI]", " ", "a", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", "x"}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"3", " ", "r"}], "+", 
     RowBox[{"\[ImaginaryI]", " ", "a", " ", "x"}]}], ")"}], " ", 
   RowBox[{
    SuperscriptBox["m", "\[Prime]",
     MultilineFunction->None], "[", "u", "]"}]}], 
  RowBox[{"2", " ", 
   SqrtBox["2"], " ", 
   RowBox[{"(", 
    RowBox[{"r", "-", 
     RowBox[{"\[ImaginaryI]", " ", "a", " ", "x"}]}], ")"}], " ", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["x", "2"]}]], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], "+", 
      RowBox[{
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox["x", "2"]}]}], ")"}], 
    RowBox[{"3", "/", "2"}]]}]]], "Output",
 CellChangeTimes->{3.574641263354391*^9, 3.5746415520881433`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"\[CapitalPsi]3", "+", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "1", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "/", "vol"}]}]}], "]"}]}],
    "/.", "star4"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641263484591*^9, 3.574641552286779*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPsi]4", "=", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "2", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "/", "vol"}]}]}], "]"}]}],
    "/.", "star4"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["a", "2"], " ", "r", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", "x"}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "\[ImaginaryI]", " ", 
       RowBox[{
        SuperscriptBox["m", "\[Prime]",
         MultilineFunction->None], "[", "u", "]"}]}], "+", 
      RowBox[{"\[ImaginaryI]", " ", "r", " ", 
       RowBox[{
        SuperscriptBox["m", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "u", "]"}]}], "+", 
      RowBox[{"a", " ", "x", " ", 
       RowBox[{
        SuperscriptBox["m", "\[Prime]\[Prime]",
         MultilineFunction->None], "[", "u", "]"}]}]}], ")"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", "r"}], "+", 
       RowBox[{"a", " ", "x"}]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[ImaginaryI]", " ", "r"}], "+", 
       RowBox[{"a", " ", "x"}]}], ")"}], "3"]}]]}]], "Output",
 CellChangeTimes->{3.5746412635539103`*^9, 3.574641552342637*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"f\[CapitalOmega]02", "=", 
   RowBox[{
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "0", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "/", "vol"}]}]}], "]"}], "/.",
     "star4"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f\[CapitalOmega]20", "=", 
   RowBox[{
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "2", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "/", "vol"}]}]}], "]"}], "/.",
     "star4"}]}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"f\[CapitalOmega]11", "=", 
   RowBox[{
    RowBox[{"reWrite", "[", 
     RowBox[{"I", " ", 
      RowBox[{
       RowBox[{"f", "[", "1", "]"}], "\[Wedge]", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "/", "vol"}]}]}], "]"}], "/.",
     "star4"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalPsi]2", "=", 
  RowBox[{"-", 
   RowBox[{"reWrite", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", "f\[CapitalOmega]11"}], "+", "f\[CapitalOmega]02", "+", 
       "f\[CapitalOmega]20"}], ")"}], "/", "6"}], "]"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"m", "[", "u", "]"}], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"r", "-", 
      RowBox[{"\[ImaginaryI]", " ", "a", " ", "x"}]}], ")"}], 
    "3"]]}]], "Output",
 CellChangeTimes->{3.5746412638250923`*^9, 3.574641552447781*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"f\[CapitalOmega]02", "-", "f\[CapitalOmega]20"}], "]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641263952914*^9, 3.574641552489868*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\tNON-ZERO RICCI COMPONENTS", "Text",
 ShowGroupOpener->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[CapitalLambda]", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "f\[CapitalOmega]11"}], "-", "f\[CapitalOmega]02", "-", 
      "f\[CapitalOmega]20"}], ")"}], "/", "6"}], "]"}]}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641264134687*^9, 3.5746415525346603`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", 
    RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"i", ",", "j"}], "]"}], "=", 
    RowBox[{
     RowBox[{"reWrite", "[", 
      RowBox[{"I", " ", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "i", "]"}], "\[Wedge]", 
        RowBox[{
         RowBox[{"fB", "[", "j", "]"}], "/", "vol"}]}]}], "]"}], "/.", 
     "star4"}]}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"cnt", "=", "0"}], ";", 
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"tmp", "=", 
      RowBox[{"\[CapitalPhi]", "[", 
       RowBox[{"i", ",", "j"}], "]"}]}], ";", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"tmp", "=!=", "0"}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<\[CapitalPhi][\>\"", ",", "i", ",", "\"\<,\>\"", ",", "j", ",", 
          "\"\<] = \>\"", ",", "tmp"}], "]"}], ";", 
        RowBox[{"cnt", "++"}]}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "0", ",", "2"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "2"}], "}"}]}], "]"}], ";", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"cnt", "===", "0"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"\[CapitalLambda]", "===", "0"}], ",", 
      RowBox[{"Print", "[", "\"\<Ricci Flat\>\"", "]"}], ",", 
      RowBox[{"Print", "[", "\"\<Einstein Space\>\"", "]"}]}], "]"}]}], "]"}],
   ";"}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[CapitalPhi][\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\"] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"a", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "x"}], ")"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"r", "-", 
         RowBox[{"\[ImaginaryI]", " ", "a", " ", "x"}]}], ")"}], "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "\[ImaginaryI]"}], " ", "r"}], "+", 
        RowBox[{"a", " ", "x"}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["m", "\[Prime]",
        MultilineFunction->None], "[", "u", "]"}]}], 
     RowBox[{"2", " ", 
      SqrtBox["2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["x", "2"]}], ")"}], 
       RowBox[{"5", "/", "2"}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["x", "2"]}]}], ")"}], 
       RowBox[{"7", "/", "2"}]]}]]}]}],
  SequenceForm[
  "\[CapitalPhi][", 2, ",", 1, "] = ", Rational[-1, 2] 
   2^Rational[-1, 2] $CellContext`a (-1 + $CellContext`x)^3 (
     1 + $CellContext`x)^3 ($CellContext`r + 
     Complex[0, -1] $CellContext`a $CellContext`x)^3 (
    Complex[0, -1] $CellContext`r + $CellContext`a $CellContext`x) (
     1 - $CellContext`x^2)^
    Rational[-5, 2] ($CellContext`r^2 + $CellContext`a^2 $CellContext`x^2)^
    Rational[-7, 2] Derivative[1][$CellContext`m][$CellContext`u]],
  Editable->False]], "Print",
 CellChangeTimes->{3.574641264353497*^9, 3.574641552832539*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[CapitalPhi][\"\>", "\[InvisibleSpace]", "1", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"\[ImaginaryI]", " ", "a", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"r", "+", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "x"}]}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["m", "\[Prime]",
        MultilineFunction->None], "[", "u", "]"}]}], 
     RowBox[{"2", " ", 
      SqrtBox["2"], " ", 
      RowBox[{"(", 
       RowBox[{"r", "-", 
        RowBox[{"\[ImaginaryI]", " ", "a", " ", "x"}]}], ")"}], " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["x", "2"]}]], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["x", "2"]}]}], ")"}], 
       RowBox[{"3", "/", "2"}]]}]]}]}],
  SequenceForm["\[CapitalPhi][", 1, ",", 2, "] = ", Complex[0, 
     Rational[-1, 2]] 
   2^Rational[-1, 2] $CellContext`a (-1 + $CellContext`x) (
    1 + $CellContext`x) ($CellContext`r + 
     Complex[0, -1] $CellContext`a $CellContext`x)^(-1) ($CellContext`r + 
    Complex[0, 1] $CellContext`a $CellContext`x) (1 - $CellContext`x^2)^
    Rational[-1, 2] ($CellContext`r^2 + $CellContext`a^2 $CellContext`x^2)^
    Rational[-3, 2] Derivative[1][$CellContext`m][$CellContext`u]],
  Editable->False]], "Print",
 CellChangeTimes->{3.574641264353497*^9, 3.5746415528345547`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"\[CapitalPhi][\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\",\"\>", "\[InvisibleSpace]", "2", 
   "\[InvisibleSpace]", "\<\"] = \"\>", "\[InvisibleSpace]", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "r", " ", 
         RowBox[{
          SuperscriptBox["m", "\[Prime]",
           MultilineFunction->None], "[", "u", "]"}]}], "+", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         RowBox[{
          SuperscriptBox["m", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "u", "]"}]}], "-", 
        RowBox[{
         SuperscriptBox["a", "2"], " ", 
         SuperscriptBox["x", "2"], " ", 
         RowBox[{
          SuperscriptBox["m", "\[Prime]\[Prime]",
           MultilineFunction->None], "[", "u", "]"}]}]}], ")"}]}], 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["r", "2"], "+", 
         RowBox[{
          SuperscriptBox["a", "2"], " ", 
          SuperscriptBox["x", "2"]}]}], ")"}], "2"]}]]}]}],
  SequenceForm[
  "\[CapitalPhi][", 2, ",", 2, "] = ", 
   Rational[-1, 
     2] $CellContext`r ($CellContext`r^2 + $CellContext`a^2 \
$CellContext`x^2)^(-2) (
    2 $CellContext`r 
     Derivative[1][$CellContext`m][$CellContext`u] + $CellContext`a^2 
     Derivative[
      2][$CellContext`m][$CellContext`u] - $CellContext`a^2 $CellContext`x^2 
    Derivative[2][$CellContext`m][$CellContext`u])],
  Editable->False]], "Print",
 CellChangeTimes->{3.574641264353497*^9, 3.574641552836049*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeUsed", "[", "]"}], "-", "sT"}]], "Input"],

Cell[BoxData["1.8179069999999982`"], "Output",
 CellChangeTimes->{3.574641273152635*^9, 3.574641552899016*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\tVERIFY \[CapitalPhi] SYMMETRY", "Text",
 ShowGroupOpener->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", 
    RowBox[{"0", ",", "1"}], "]"}], "-", 
   RowBox[{"Bar", "[", 
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"1", ",", "0"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641273281287*^9, 3.574641553030396*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", 
    RowBox[{"0", ",", "2"}], "]"}], "-", 
   RowBox[{"Bar", "[", 
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"2", ",", "0"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641273407393*^9, 3.574641553089134*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", 
    RowBox[{"1", ",", "2"}], "]"}], "-", 
   RowBox[{"Bar", "[", 
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641273540051*^9, 3.574641553293309*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", 
    RowBox[{"0", ",", "0"}], "]"}], "-", 
   RowBox[{"Bar", "[", 
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"0", ",", "0"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641273573942*^9, 3.574641553321595*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", 
    RowBox[{"1", ",", "1"}], "]"}], "-", 
   RowBox[{"Bar", "[", 
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641273611527*^9, 3.574641553351481*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"\[CapitalPhi]", "[", 
    RowBox[{"2", ",", "2"}], "]"}], "-", 
   RowBox[{"Bar", "[", 
    RowBox[{"\[CapitalPhi]", "[", 
     RowBox[{"2", ",", "2"}], "]"}], "]"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641273644524*^9, 3.5746415534056*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeUsed", "[", "]"}], "-", "sT"}]], "Input"],

Cell[BoxData["1.9811990000000002`"], "Output",
 CellChangeTimes->{3.574641273677652*^9, 3.574641553440057*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\tVERIFY CYCLIC IDENTITY", "Text",
 ShowGroupOpener->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "-", 
      RowBox[{"Bar", "[", 
       RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "]"}]}], ")"}], "\[Wedge]",
     "\[DoubleStruckM]"}], "+", 
   RowBox[{
    RowBox[{"Bar", "[", 
     RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "]"}], "\[Wedge]", 
    "\[DoubleStruckL]"}], "-", 
   RowBox[{
    RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "\[Wedge]", 
    "\[DoubleStruckN]"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641273802849*^9, 3.574641553576861*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "+", 
       RowBox[{"Bar", "[", 
        RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "]"}]}], ")"}]}], 
    "\[Wedge]", "\[DoubleStruckL]"}], "+", 
   RowBox[{
    RowBox[{"Bar", "[", 
     RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "]"}], "\[Wedge]", 
    "\[DoubleStruckM]"}], "+", 
   RowBox[{
    RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "\[Wedge]", 
    "\[DoubleStruckM]B"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641273968512*^9, 3.574641553605927*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "+", 
       RowBox[{"Bar", "[", 
        RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "]"}]}], ")"}]}], 
    "\[Wedge]", "\[DoubleStruckN]"}], "+", 
   RowBox[{
    RowBox[{"Bar", "[", 
     RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "]"}], "\[Wedge]", 
    "\[DoubleStruckM]B"}], "+", 
   RowBox[{
    RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "\[Wedge]", 
    "\[DoubleStruckM]"}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641274369062*^9, 3.574641553703392*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeUsed", "[", "]"}], "-", "sT"}]], "Input"],

Cell[BoxData["2.231494999999999`"], "Output",
 CellChangeTimes->{3.574641274501606*^9, 3.574641553736923*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\tVERIFY BIANCHI IDENTITIES", "Text",
 ShowGroupOpener->True],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "]"}], "+", 
   RowBox[{"2", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"\[Omega]0", "\[Wedge]", 
       RowBox[{"\[CapitalOmega]", "[", "1", "]"}]}], "-", 
      RowBox[{
       RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "\[Wedge]", 
       "\[Omega]1"}]}], ")"}]}]}], "]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.574641274769238*^9, 3.574641553862061*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{
   RowBox[{"d", "[", 
    RowBox[{"\[CapitalOmega]", "[", "1", "]"}], "]"}], "+", 
   RowBox[{"\[Omega]0", "\[Wedge]", 
    RowBox[{"\[CapitalOmega]", "[", "2", "]"}]}], "-", 
   RowBox[{
    RowBox[{"\[CapitalOmega]", "[", "0", "]"}], "\[Wedge]", "\[Omega]2"}]}], 
  "]"}]], "Input"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.57464127507172*^9, 3.5746415539695463`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"d", "[", 
     RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "]"}], "-", 
    RowBox[{"2", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[Omega]2", "\[Wedge]", 
        RowBox[{"\[CapitalOmega]", "[", "1", "]"}]}], "-", 
       RowBox[{
        RowBox[{"\[CapitalOmega]", "[", "2", "]"}], "\[Wedge]", 
        "\[Omega]1"}]}], ")"}]}]}], "]"}], "//", "Timing"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.8258500000000026`", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.574641275690692*^9, 3.574641554846635*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"TimeUsed", "[", "]"}], "-", "sT"}]], "Input"],

Cell[BoxData["3.287904000000001`"], "Output",
 CellChangeTimes->{3.574641275896359*^9, 3.574641554898068*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"On", "[", 
   RowBox[{
    RowBox[{"General", "::", "\"\<spell\>\""}], ",", 
    RowBox[{"General", "::", "\"\<spell1\>\""}]}], "]"}], ";"}]], "Input"]
}, Open  ]],

Cell[TextData[{
 "More examples of calculations in Riemannian Geometry can be found in the \
package ",
 ButtonBox["Riemannian Geometry and Tensor Calculus",
  BaseStyle->"Hyperlink",
  ButtonData:>{
    URL["http://www.inp.demokritos.gr/~sbonano/RGTC/"], None}],
 " (Sections 5 and 6).",
 "\n"
}], "Text"],

Cell[CellGroupData[{

Cell["(2) Polynomial Matrix Algebra", "Subsection",
 ShowGroupOpener->True],

Cell[TextData[{
 "Suppose one wishes to simplify products of polynomials in a matrix variable \
",
 StyleBox["X",
  FontFamily->"Courier"],
 ", say in 3 dimensions, using the Cayley-Hamilton theorem. ",
 StyleBox["matrixEDCcode",
  FontWeight->"Bold"],
 " cannot easily handle the notation ",
 StyleBox["X^n",
  FontFamily->"Courier"],
 " for powers of a matrix, but one can use the notation ",
 StyleBox["X[n]",
  FontFamily->"Courier"],
 " for the nth power of the matrix ",
 StyleBox["X[1] ",
  FontFamily->"Courier"],
 "and define appropriate rules for wedge-products of  ",
 StyleBox["X[k_]",
  FontFamily->"Courier"],
 " matrices",
 StyleBox[".",
  FontFamily->"Courier"],
 " Thus"
}], "Text",
 TextJustification->0],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DeclareMatrixForms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"X", "[", "_", "]"}], ",", 
    RowBox[{"Xt", "[", "_", "]"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"DeclareMatrixForms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"X", "[", "_", "]"}], ",", 
    RowBox[{"Xt", "[", "_", "]"}]}], "}"}], "]"}]], "Output",
 CellChangeTimes->{3.574641276009709*^9, 3.574641555023322*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"X", "[", "i_", "]"}], "\[Wedge]", 
    RowBox[{"X", "[", "k_", "]"}]}], ":=", 
   RowBox[{"X", "[", 
    RowBox[{"i", "+", "k"}], "]"}]}], ";"}]], "Input"],

Cell[TextData[{
 " Use the Cayley-Hamilton Theorem to reduce the ",
 StyleBox["X[k]",
  FontFamily->"Courier"],
 " "
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CH3", "=", 
  RowBox[{"CHrul", "[", 
   RowBox[{"3", ",", 
    RowBox[{"X", "[", "1", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"CHrul", "[", 
  RowBox[{"3", ",", 
   RowBox[{"X", "[", "1", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.5746412760747023`*^9, 3.5746415551509027`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CH3rhs", "=", 
  RowBox[{
   RowBox[{"CH3", "[", 
    RowBox[{"[", "1", "]"}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Part", "::", "\<\"partd\"\>"}], 
  RowBox[{
  ":", " "}], "\<\"\\!\\(\\*StyleBox[\\\"\\\\\\\"Part specification \
\\\\\\\"\\\", \\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\!\\(3 \
\[LeftDoubleBracket] 2 \[RightDoubleBracket]\\), \
\\\"MT\\\"]\\)\[NoBreak]\\!\\(\\*StyleBox[\\\"\\\\\\\" is longer than depth \
of object.\\\\\\\"\\\", \\\"MT\\\"]\\) \
\\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", \
ButtonFrame->None, ButtonData:>\\\"paclet:ref/message/General/partd\\\", \
ButtonNote -> \\\"Part::partd\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.574641276149787*^9, 3.574641555210367*^9}],

Cell[BoxData[
 RowBox[{"3", "\[LeftDoubleBracket]", "2", 
  "\[RightDoubleBracket]"}]], "Output",
 CellChangeTimes->{3.5746412761528254`*^9, 3.574641555214057*^9}]
}, Open  ]],

Cell[" For simplicity (and to avoid infinite loops!) set", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tr", "[", 
    RowBox[{"X", "[", "1", "]"}], "]"}], "=", "s1"}], ";", 
  RowBox[{
   RowBox[{"tr", "[", 
    RowBox[{"X", "[", "2", "]"}], "]"}], "=", "s2"}], ";", 
  RowBox[{
   RowBox[{"tr", "[", 
    RowBox[{"X", "[", "3", "]"}], "]"}], "=", "s3"}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData["CH3rhs"], "Input"],

Cell[BoxData[
 RowBox[{"3", "\[LeftDoubleBracket]", "2", 
  "\[RightDoubleBracket]"}]], "Output",
 CellChangeTimes->{3.5746412762939587`*^9, 3.574641555284316*^9}]
}, Open  ]],

Cell[TextData[{
 "In this notation ",
 StyleBox["X[0]",
  FontFamily->"Courier"],
 " is the identity matrix. One can either set ",
 StyleBox["X[0]=1",
  FontFamily->"Courier"],
 ", or  set"
}], "Text"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{
    RowBox[{"tr", "[", 
     RowBox[{"X", "[", "0", "]"}], "]"}], "=", "3"}], ";", 
   RowBox[{"Unprotect", "[", "Transpose", "]"}], ";", 
   RowBox[{
    RowBox[{"Transpose", "[", 
     RowBox[{"X", "[", "0", "]"}], "]"}], "=", 
    RowBox[{"X", "[", "0", "]"}]}], ";", " ", 
   RowBox[{"Protect", "[", "Transpose", "]"}], ";"}], " "}]], "Input"],

Cell[TextData[{
 "and use it to rewrite ",
 StyleBox["CH3rhs",
  FontFamily->"Courier"],
 ":"
}], "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CH3rhs", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{"CH3rhs", "\[Wedge]", 
    RowBox[{"X", "[", "0", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
  RowBox[{"X", "[", "0", "]"}]}]], "Output",
 CellChangeTimes->{3.5746412763763943`*^9, 3.574641555369967*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"reWrite", "[", 
   RowBox[{"tr", "[", "%", "]"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"*", " ", 
     StyleBox["check",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["that",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["trace",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["of",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox[" ",
      FontColor->RGBColor[0, 0, 1]], 
     StyleBox["CHrhs",
      FontColor->RGBColor[0, 0, 1]]}], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["=",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[
     RowBox[{"tr", "[", 
      RowBox[{"X", "[", "3", "]"}], "]"}],
     FontColor->RGBColor[0, 0, 1]]}], " ", "**)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"tr", "[", 
  RowBox[{
   RowBox[{"3", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], " ", 
   RowBox[{"X", "[", "0", "]"}]}], "]"}]], "Output",
 CellChangeTimes->{3.574641276395546*^9, 3.574641555427165*^9}]
}, Open  ]],

Cell[TextData[{
 "Now define rules for simplifying ",
 StyleBox["X[i]",
  FontFamily->"Courier"],
 " matrices"
}], "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"X", "[", 
   RowBox[{"i_", "/;", 
    RowBox[{"i", ">", "2"}]}], "]"}], ":=", 
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"X", "[", 
     RowBox[{"i", "-", "3"}], "]"}], "\[Wedge]", "CH3rhs"}], "]"}]}]], "Input"],

Cell["\<\
With these rules one can calculate arbitrary powers of matrix polynomials:\
\>", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"X", "[", "10", "]"}], "//", "Timing"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.00045300000000025875`", ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"3", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     "3"], " ", 
    SuperscriptBox[
     RowBox[{"X", "[", "0", "]"}], "3"], " ", 
    RowBox[{"X", "[", "1", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.574641276459511*^9, 3.5746415555031347`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"X", "[", "5", "]"}], "\[Wedge]", 
    RowBox[{"X", "[", "7", "]"}]}], "]"}], "//", "Timing"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.000385000000001412`", ",", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"3", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     "3"], " ", 
    SuperscriptBox[
     RowBox[{"X", "[", "0", "]"}], "3"], " ", 
    RowBox[{"X", "[", "1", "]"}], " ", 
    RowBox[{"X", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.574641276530308*^9, 3.5746415555415688`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matPoly", "=", 
  RowBox[{
   RowBox[{"X", "[", "0", "]"}], "+", 
   RowBox[{"k1", " ", 
    RowBox[{"X", "[", "1", "]"}]}], "+", 
   RowBox[{"k2", " ", 
    RowBox[{"X", "[", "2", "]"}]}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"X", "[", "0", "]"}], "+", 
  RowBox[{"k1", " ", 
   RowBox[{"X", "[", "1", "]"}]}], "+", 
  RowBox[{"k2", " ", 
   RowBox[{"X", "[", "2", "]"}]}]}]], "Output",
 CellChangeTimes->{3.5746412765625153`*^9, 3.574641555592898*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"reWrite", "[", 
   RowBox[{"matPoly", "\[Wedge]", "matPoly", "\[Wedge]", "matPoly"}], "]"}], "//",
   "Timing"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.0028620000000003643`", ",", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"X", "[", "0", "]"}], "+", 
      RowBox[{"k1", " ", 
       RowBox[{"X", "[", "1", "]"}]}], "+", 
      RowBox[{"k2", " ", 
       RowBox[{"X", "[", "2", "]"}]}]}], ")"}], "3"]}], "}"}]], "Output",
 CellChangeTimes->{3.574641276769207*^9, 3.574641555638941*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["Finding the inverse of  ",
  FontSize->14],
 StyleBox["matPoly",
  FontFamily->"Courier",
  FontSize->14]
}], "Subsubsection",
 ShowGroupOpener->True,
 FontSize->12],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"testPoly", "=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "i", "]"}], 
     RowBox[{"X", "[", "i", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "0", ",", "2"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "0", "]"}], " ", 
   RowBox[{"X", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"X", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"X", "[", "2", "]"}]}]}]], "Output",
 CellChangeTimes->{3.574641276795426*^9, 3.5746415556931143`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"zer0", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{
    RowBox[{"testPoly", "\[Wedge]", "matPoly"}], "-", 
    RowBox[{"X", "[", "0", "]"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"X", "[", "0", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "0", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"X", "[", "0", "]"}], "2"]}], "+", 
  RowBox[{"k1", " ", 
   RowBox[{"a", "[", "0", "]"}], " ", 
   RowBox[{"X", "[", "0", "]"}], " ", 
   RowBox[{"X", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"X", "[", "0", "]"}], " ", 
   RowBox[{"X", "[", "1", "]"}]}], "+", 
  RowBox[{"k1", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"X", "[", "1", "]"}], "2"]}], "+", 
  RowBox[{"k2", " ", 
   RowBox[{"a", "[", "0", "]"}], " ", 
   RowBox[{"X", "[", "0", "]"}], " ", 
   RowBox[{"X", "[", "2", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"X", "[", "0", "]"}], " ", 
   RowBox[{"X", "[", "2", "]"}]}], "+", 
  RowBox[{"k2", " ", 
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"X", "[", "1", "]"}], " ", 
   RowBox[{"X", "[", "2", "]"}]}], "+", 
  RowBox[{"k1", " ", 
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"X", "[", "1", "]"}], " ", 
   RowBox[{"X", "[", "2", "]"}]}], "+", 
  RowBox[{"k2", " ", 
   RowBox[{"a", "[", "2", "]"}], " ", 
   SuperscriptBox[
    RowBox[{"X", "[", "2", "]"}], "2"]}]}]], "Output",
 CellChangeTimes->{3.574641276863062*^9, 3.574641555738901*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqs", "=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"zer0", "/.", 
      RowBox[{
       RowBox[{"X", "[", "0", "]"}], "->", "1"}]}], ",", 
     RowBox[{"zer0", "/.", 
      RowBox[{
       RowBox[{"X", "[", "1", "]"}], "->", "1"}]}], ",", 
     RowBox[{"zer0", "/.", 
      RowBox[{
       RowBox[{"X", "[", "2", "]"}], "->", "1"}]}]}], "}"}], "/.", 
   RowBox[{
    RowBox[{"X", "[", "_", "]"}], "->", "0"}]}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"a", "[", "0", "]"}]}], ",", 
   RowBox[{"k1", " ", 
    RowBox[{"a", "[", "1", "]"}]}], ",", 
   RowBox[{"k2", " ", 
    RowBox[{"a", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.574641276915175*^9, 3.574641555793413*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"invPolyRul", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"eqs", "==", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "[", "0", "]"}], ",", 
       RowBox[{"a", "[", "1", "]"}], ",", 
       RowBox[{"a", "[", "2", "]"}]}], "}"}]}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "0", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.574641277166655*^9, 3.574641555884267*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"invPolyRul", "=", 
  RowBox[{"reWrite", "[", "invPolyRul", "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "0", "]"}], "\[Rule]", "1"}], ",", 
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.574641277198859*^9, 3.574641555908839*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"invPoly", "=", 
  RowBox[{"reWrite", "[", 
   RowBox[{"testPoly", "/.", "invPolyRul"}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"X", "[", "0", "]"}]], "Output",
 CellChangeTimes->{3.5746412772878942`*^9, 3.574641555944174*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"reWrite", "[", 
   RowBox[{"matPoly", "\[Wedge]", "invPoly"}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"*", " ", 
    StyleBox["check",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox[" ",
     FontColor->RGBColor[0, 0, 1]], 
    StyleBox["inverse",
     FontColor->RGBColor[0, 0, 1]]}], " ", "**)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"X", "[", "0", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"X", "[", "0", "]"}], "+", 
    RowBox[{"k1", " ", 
     RowBox[{"X", "[", "1", "]"}]}], "+", 
    RowBox[{"k2", " ", 
     RowBox[{"X", "[", "2", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.574641277319542*^9, 3.574641555970998*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell["", "Text"],

Cell[CellGroupData[{

Cell["(3)  SU(2) algebra: Trace calculations", "Subsection",
 ShowGroupOpener->True],

Cell[BoxData[
 RowBox[{
  RowBox[{"Off", "[", 
   RowBox[{
    RowBox[{"General", "::", "\"\<spell\>\""}], ",", 
    RowBox[{"General", "::", "\"\<spell1\>\""}]}], "]"}], ";"}]], "Input"],

Cell["Introduce notation and define properties of Pauli matrices:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DeclareMatrixForms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"\[Sigma]", "[", "_", "]"}], ",", 
    RowBox[{"\[Sigma]t", "[", "_", "]"}]}], "}"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"DeclareMatrixForms", "[", 
  RowBox[{"{", 
   RowBox[{"0", ",", 
    RowBox[{"\[Sigma]", "[", "_", "]"}], ",", 
    RowBox[{"\[Sigma]t", "[", "_", "]"}]}], "}"}], "]"}]], "Output",
 CellChangeTimes->{3.5746412773498497`*^9, 3.5746415560360823`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"tr", "[", 
    RowBox[{"\[Sigma]", "[", "a_", "]"}], "]"}], "=", "0"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"matDimension", "=", "2"}], ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"delta", "[", 
    RowBox[{"a_", ",", "b_"}], "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"a", "===", "b"}], ",", "1", ",", "0"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"epsilon", "[", 
    RowBox[{"a_", ",", "b_", ",", "c_"}], "]"}], ":=", 
   RowBox[{"Signature", "[", 
    RowBox[{"{", 
     RowBox[{"a", ",", "b", ",", "c"}], "}"}], "]"}]}], ";"}]}], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"\[Sigma]", "[", "a_", "]"}], "\[Wedge]", 
   RowBox[{"\[Sigma]", "[", "b_", "]"}]}], ":=", 
  RowBox[{
   RowBox[{"delta", "[", 
    RowBox[{"a", ",", "b"}], "]"}], "+", 
   RowBox[{"I", " ", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"epsilon", "[", 
        RowBox[{"a", ",", "b", ",", "c"}], "]"}], 
       RowBox[{"\[Sigma]", "[", "c", "]"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"c", ",", "3"}], "}"}]}], "]"}]}]}]}]], "Input"],

Cell["Define A, B  to be two SU(2) algebra vectors:", "Text"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"A", "=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "i", "]"}], 
     RowBox[{"\[Sigma]", "[", "i", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "1", "]"}], " ", 
   RowBox[{"\[Sigma]", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "2", "]"}], " ", 
   RowBox[{"\[Sigma]", "[", "2", "]"}]}], "+", 
  RowBox[{
   RowBox[{"a", "[", "3", "]"}], " ", 
   RowBox[{"\[Sigma]", "[", "3", "]"}]}]}]], "Output",
 CellChangeTimes->{3.574641277402701*^9, 3.5746415562527447`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"B", "=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"b", "[", "i", "]"}], 
     RowBox[{"\[Sigma]", "[", "i", "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "3"}], "}"}]}], "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"b", "[", "1", "]"}], " ", 
   RowBox[{"\[Sigma]", "[", "1", "]"}]}], "+", 
  RowBox[{
   RowBox[{"b", "[", "2", "]"}], " ", 
   RowBox[{"\[Sigma]", "[", "2", "]"}]}], "+", 
  RowBox[{
   RowBox[{"b", "[", "3", "]"}], " ", 
   RowBox[{"\[Sigma]", "[", "3", "]"}]}]}]], "Output",
 CellChangeTimes->{3.574641277429728*^9, 3.5746415562896013`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"A", "\[Wedge]", "B"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], " ", 
     RowBox[{"\[Sigma]", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"a", "[", "2", "]"}], " ", 
     RowBox[{"\[Sigma]", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"a", "[", "3", "]"}], " ", 
     RowBox[{"\[Sigma]", "[", "3", "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"b", "[", "1", "]"}], " ", 
     RowBox[{"\[Sigma]", "[", "1", "]"}]}], "+", 
    RowBox[{
     RowBox[{"b", "[", "2", "]"}], " ", 
     RowBox[{"\[Sigma]", "[", "2", "]"}]}], "+", 
    RowBox[{
     RowBox[{"b", "[", "3", "]"}], " ", 
     RowBox[{"\[Sigma]", "[", "3", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.57464127744726*^9, 3.574641556345944*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"tr", "[", 
   RowBox[{"A", "\[Wedge]", "B"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"tr", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"]}], "+", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}]}], "+", 
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}]}], "+", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"]}], "+", 
   RowBox[{
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}]}], "]"}]], "Output",
 CellChangeTimes->{3.574641277480812*^9, 3.574641556390781*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"tr", "[", 
   RowBox[{"A", "\[Wedge]", "A", "\[Wedge]", "B"}], "]"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"tr", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "3"]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "3"]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}]}], "]"}]], "Output",
 CellChangeTimes->{3.574641277551248*^9, 3.574641556454398*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"tr", "[", 
   RowBox[{"A", "\[Wedge]", "A", "\[Wedge]", "B", "\[Wedge]", "B"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"tr", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "4"]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "3"]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "2", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "3"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "4"]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "2", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "3", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "3", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "3", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "3", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "3", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "3", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "4"]}]}], "]"}]], "Output",
 CellChangeTimes->{3.5746412776139174`*^9, 3.574641556491366*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"reWrite", "[", 
  RowBox[{"tr", "[", 
   RowBox[{"A", "\[Wedge]", "B", "\[Wedge]", "A", "\[Wedge]", "B"}], "]"}], 
  "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"tr", "[", 
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "4"]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "3"]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "2", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "3"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "4"]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "2", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
    RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "3", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "3", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{"4", " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "3", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"], " ", 
    RowBox[{"b", "[", "1", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "1", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "3", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"], " ", 
    RowBox[{"b", "[", "2", "]"}], " ", 
    RowBox[{"b", "[", "3", "]"}], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
   RowBox[{"2", " ", 
    RowBox[{"a", "[", "2", "]"}], " ", 
    RowBox[{"a", "[", "3", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "3", "]"}], "2"], " ", 
    RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "[", "3", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"b", "[", "3", "]"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"\[Sigma]", "[", "3", "]"}], "4"]}]}], "]"}]], "Output",
 CellChangeTimes->{3.574641277680604*^9, 3.574641556546537*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"reWrite", "[", 
   RowBox[{"tr", "[", 
    RowBox[{
    "A", "\[Wedge]", "A", "\[Wedge]", "B", "\[Wedge]", "B", "\[Wedge]", "A", 
     "\[Wedge]", "B"}], "]"}], "]"}], "//", "Timing"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.16255800000000065`", ",", 
   RowBox[{"tr", "[", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "6"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "5"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "5"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "4"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "4"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "3"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "4"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "4"]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "4"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "4"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "3"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "5"]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "5"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "6"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "5"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "5"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"6", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "4"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "4"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "4"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "3"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "4"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"18", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"18", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"18", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"18", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "4"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"6", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "4"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "3"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "4"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "4"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "5"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "5"], " ", 
      RowBox[{"\[Sigma]", "[", "3", "]"}]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "4"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "4"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "3"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "4"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"18", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"18", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "3"], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"36", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"18", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"18", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "3"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "4"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "4"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "3"], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "4"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "2"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"18", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"18", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"18", " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"18", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"9", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "3"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "1", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "4"]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "4"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "1", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "1", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "4"]}], "+", 
     RowBox[{"6", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "4"]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "4"]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "4"]}], "+", 
     RowBox[{"6", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "4"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "2", "]"}], "2"], " ", 
      RowBox[{"b", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "4"]}], "+", 
     RowBox[{"9", " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "4"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "2", "]"}], "2"], " ", 
      RowBox[{"a", "[", "3", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "2", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "4"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"], " ", 
      RowBox[{"b", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "5"]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{"a", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "1", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "5"]}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"], " ", 
      RowBox[{"b", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "2"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "5"]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{"a", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "2"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "3"], " ", 
      RowBox[{"\[Sigma]", "[", "2", "]"}], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "5"]}], "+", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"a", "[", "3", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"b", "[", "3", "]"}], "3"], " ", 
      SuperscriptBox[
       RowBox[{"\[Sigma]", "[", "3", "]"}], "6"]}]}], "]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.574641277748232*^9, 3.574641556726165*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"matDimension", "=."}], ";", 
  RowBox[{"On", "[", 
   RowBox[{
    RowBox[{"General", "::", "\"\<spell\>\""}], ",", 
    RowBox[{"General", "::", "\"\<spell1\>\""}]}], "]"}], ";"}]], "Input"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"d", "[", 
  RowBox[{"x", "^", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.574641251186673*^9, 3.574641252168275*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", "dx", " ", "x"}]], "Output",
 CellChangeTimes->{3.574641277894319*^9, 3.5746415568208237`*^9}]
}, Open  ]]
},
WindowToolbars->{},
CellGrouping->Manual,
WindowSize->{1436, 856},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
MacintoshSystemPageSetup -> \
"00<0001804P000000`d26_oQon@3:`8g0dL5N`?P0080001804P000000]P2:001\n\
0000I00000400`<30?l00BL?00400@0000000000000006P801T1T00000000000\n\
00000000004000000000000000000000",
Magnification->1.25,
FrontEndVersion->"7.0 for Mac OS X x86 (32-bit) (November 10, 2008)",
StyleDefinitions->Notebook[{
   Cell[
    CellGroupData[{
      Cell["Style Definitions", "Subtitle"], 
      Cell[
      "Modify the definitions below to change the default appearance of all \
cells in a given style.  Make modifications to any definition using commands \
in the Format menu.", "Text"], 
      Cell[
       CellGroupData[{
         Cell["Style Environment Names", "Section"], 
         Cell[
          StyleData[All, "Working"], PageWidth -> WindowWidth, ScriptMinSize -> 
          9], 
         Cell[
          StyleData[All, "Printout"], PageWidth -> PaperWidth, ScriptMinSize -> 
          7, FontSize -> 10, 
          PrivateFontOptions -> {"FontType" -> "Outline"}]}, Open]], 
      Cell[
       CellGroupData[{
         Cell["Notebook Options", "Section"], 
         Cell[
         "The options defined for the style below will be used at the \
Notebook level.", "Text"], 
         Cell[
          StyleData["Notebook"], PageHeaders -> {{
             Cell[
              TextData[{
                CounterBox["Page"]}], "PageNumber"], None, 
             Cell[
              TextData[{
                ValueBox["FileName"]}], "Header"]}, {
             Cell[
              TextData[{
                ValueBox["FileName"]}], "Header"], None, 
             Cell[
              TextData[{
                CounterBox["Page"]}], "PageNumber"]}}, 
          PageHeaderLines -> {True, True}, 
          PrintingOptions -> {
           "FacingPages" -> True, "FirstPageHeader" -> False}, 
          CellBracketOptions -> {"Color" -> RGBColor[0, 0, 0.466667]}, 
          StyleMenuListing -> None]}, Open]], 
      Cell[
       CellGroupData[{
         Cell["Header Graphic (to be pasted in)", "Section"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["HeaderCell"], ShowCellBracket -> False, 
             CellMargins -> {{0, 0}, {0, 0}}, Evaluatable -> False, 
             PageBreakBelow -> False, ImageSize -> {350, 24}, 
             ImageMargins -> {{0, 0}, {0, 0}}, 
             ImageRegion -> {{0, 1}, {0, 1}}, StyleMenuListing -> None], 
            Cell[
             GraphicsData[
             "CompressedBitmap", 
              "eJztXD2IM0l67tXPSDPft983u3frkznMCnOcLQyGsaMBOxgwNgw4Gf/BBIad\n\
w3hXxticLlNiUNhphwoVKlSqUKFCgW1Mhwo77LT8Pu9P1VstfXvrwIl9Aqm6\n\
q6urq6vreZ/3r/WX3/zq23/4529+9d0vvpn+xS+/+ddvv/vFYvrn//JLqup/\n\
VhSf/X1RFJNpge1Am/rzT4E+xU1oqTi3bTidz/w907dt2wEf7oeGilNdh3PT\n\
FEOuG0pd03B9Tc2pffFffKz4jov7QJVhczqGsqpCNZ+H9dtbWC0WYb5eh+Vm\n\
E3b7fWgadBTCgbrY4PhyycfpWI+7uQ01ujkcQkWnrl9fQ4kuqEt0sT9QF3Tl\n\
/5Qrf6sDPtG9HGYzVGHA9DsIp+k0zOnU1W4XjlXV14OnySTMyzLUNBB8j5NJ\n\
PAVdvK7KsKYr0VX+Qy7yj3oRTFpLk4i2Y/7th8VqhS3dk9/1Yh72uE3X7o3a\n\
7fY77unfpdtiFI7rI31P4UDfvDwWPWzR+Qdt0zlu+9Ks76vk1F73qJxsHQ9j\n\
Z8fumcWPrgwotTvGvvLtbqnH3PX8eaeLY53rFHwDtFaPVyfA3Vq8XOHuedAd\n\
R97eD03q9rs2NPRU3tmzHBfxyfbik62ozdg92dtwpjaPr8uwXe3CaVuH46am\n\
8hROVB63vE3n0xEs013NbahE3Q51Ner2NUqqq/dctz9jCyXXnel26sNZ6qk8\n\
H859bBS/Fc7HBrtU6pe3G92XskF5kv0G9adGjlHZnK6WPWyQIKghAFDX1C32\n\
rISQqNvi89CeU71s0/fcpnrbtrJp6WZoi/ptG6njL2+zbKIWH+iXQIK6BpKm\n\
1X3ZlhJoTPuyHQbYAFb1MPZ6WscfrftGMdgP82IVFvKllvi9obqS69KxEtty\n\
eOhPsWZ6aupuznuo+5h147tN5afqrd/R97Qttc2ge34vDcKqtOltdgvz60PT\n\
4Y+uDaszvO+bkkH3WmmSr83CcqjPZTl+CdX9QiUzfm9CWTwYJvm7Hz9Su4Wd\n\
UhMH5cJ4GJ7plOfxPCzvq7CalGE5qWhgq2lFna6m67CaVaGcrfHthfJhTSeW\n\
j5tQyZeaVk8bIP9pG6rnLZWoW79sqW7zsgub1y2+VLd53dHlNm+7sI3ffdjO\n\
d3RsO9/T5XYL2qevllSxPBTvw351CDv67u1bWklCirYPVSr31bGPDTrNifRM\n\
PB82VG5U9KFkWQTxt4U0PW1VPCVRBNHTV2kESXQS6SPSqMdyBtKmNhFEB0jK\n\
QCSpzKlF/vQgVCARTyZ6ROx40QKRQNuFiJYRiwUREyYqosigy7QmLEQ8iDiQ\n\
6huFeNspw98KsuVhDuXZPmywJ9/ZmrrEsXd6zL4bO+7KWIdlQefcdOvt3Lh2\n\
UpdFXkfrabZ2w7roQod14+v8UPp2qr8bPrzR0aXLVw+bi8vrnv6mO+v9oDob\n\
3ofusMKKvtvZkiZ9TOQ4Cc14QmrSOBzvn8L8cR9eHmntjmeG4ZfJS3h72Ibt\n\
dEkzUoW3x1M4jycDRe0rHX59PIbddKGwHxLMJ+HpYQEoMhDXzwzCZwEh7QOI\n\
AsnXXQ/YI2LaRAQyCsNunqEv7Je0je9C4AYw9rFFq1IgeJQS0AMUAb/yWAj+\n\
RqKyAJpeddkcVfkg5BESjqwDMP5MFxAdgYF3Yt1gyMgbMd+LHnCWUvg/IvFM\n\
cxdBqLoAyL5m4AlGVRegEhg1RN4R8pT0u0RfJ1Q2TPo11Bvh8CZyOQ4LhzM4\n\
+4zOfqRvUnWB0gYPPUS67gITPyFRcStUTE/4byJgGZokmklYlyywSVhL9VRk\n\
9TTKahwKK24Sm5J811LbrfB1x1Af2+h5pbWdWp9lbC/1PJyejAW88ZPs/Njf\n\
fbpG3I/jTf2VuI9JGredj/0VcxPu9zbV35fa78X4tO1Q7uve2vN143Ry3Vjn\n\
CPeBg1/ES6PbeJs2hbgkhknAXjzswoJAvHzY8/aSvhVuY/KsVtMwvM5Kbrua\n\
bfScvUJ3wNrxw3TFAmP+eDQh0EBpni2IatfAMSGbUS2gHiqot1wSpBPDCrjf\n\
M6AvgD0/SLk8CLCpFJAfBsB1D/DtgUpvFMIM2+qYUehhE62kDYMT+zmMWZ2H\n\
2WD8qXsE43eizu8EvrFUdf5kKnxS7Qm3RJgKa4Vz1OPrpMd7PPcFz6LA4wD9\n\
fpVwXSuuc4U9tHVSyAHktvaKeQPF3CnizLTKwGNRxE0JB3IjuhnYgupBUrCl\n\
VGAXfxhXGB4ZJg3yFrKwegQY1vysoTExSGilQG/Bg4FstgcEdQgPzNphXaAd\n\
5DnqsY9+7Twc27i2uB4vCVarjowAtPd9oG8sJ2xTHyLqP3ATDB0rNQ1tL8Ml\n\
RRGnoDvcBo4zdaz09Du5msKfr7YURsHVcYqODEvzWPx2lHQ8kO1JJgETQKct\n\
qR66MrrBg8Nqw8qBuoqbNaUPN4zRbf0kbXTySAD0o06zIUhvwdUK55uwmLxS\n\
HdQV4XnAmtoYGe+I4p+mC9ZgliQZzuNpRPvDbJ5I+ok0FsD56wRlU5hRqpKc\n\
aNrRNaNZy6VQNso9I9u0Zdk3TZkfPei6kse7r3iSla7Hgm+l64NzoShl9xnu\n\
fZ7wYwbzoTK3igBRm5W1hwpzg3Sy2NmKP2i9KtBnan8+RAveVGeBNmksYpaf\n\
k/6cUJ6hO5rjUY++SWhXZCvKjaqbZGVHULNl3RioHWVLaaBuE1U79br408ia\n\
eOCYMnzw9ISdS346+MC+M/DjdvBBiTXLnkB6KrzOpqK7Aj344HZwHtphGx88\n\
ZdY5tR59mtTBPtY8xoNHgg/GxaxLggaSl69HqwNI3qjQwQf7eFT48H1RP6jD\n\
B3jDuLCWxUU54jbcH13XdGEeU2zT5/GgnlZ4Ya5NjA0aB8/bo7tXeqToR0x0\n\
tP0AHZ77xPzgA9R833zh+ZLG008mjjwKYuz6/nGgLsfF/WOYTN9IkqzECFGL\n\
gZo5ffueSHvOtvGStPdmfB8hDj0cMo8N4idl7AFDHBPGUH/dijn8hZrHl0jf\n\
GX8r0iHjTBlnpAPVgnSaDyjlg3BwSFcmB7wN8IB5z4O9ax9vIthFPR+x4I3c\n\
rqq58bm4577yNrIYx57TI/DPHuyqmnc4Xcv6oFxefHnpp/OGsqrsl8AHvTtq\n\
P7Pa3tLiylm96brdktON1JQ2utAy0Ecwue3CIP8HcbFgWQLWEBnwHEHRhtaI\n\
58BigB61V4KtDucAdngeUEpLPQ91DL0HVY5Bpk95nSn082LJ9Zhcg6ZprQwT\n\
Wm50Ppw8pCL/icCb+jetdkHXxbLEpGPs6IcVZNCligOsGbRD/yyy2hDdVJh4\n\
u+fSjQfKodWjLcOazsV2mrd1eNP2ICscA7mxmBmroj+ruB8scyw67GPt8nw9\n\
dOZrluYGNP4yIwWfyJlg8Ujm9Yow3EZ67ocXwv4rqFucE6wBkLJ+EcAYkwYA\n\
in+aldH1VlOb54fScC9gN439Til+F8tPAL8P1Pdwz9SlWeMZtS/3YoR/4bB+\n\
8IxufjDxi62PSYOvLmITIG82xA3pJ4f0jkGuiH8fNfdLLV6QfvKIP9QD5XcH\n\
dAX4OAe4Y3Pd77Pq/rvmFFNMO5Pcq+y5DZ6BGzBszm3G6ChDE3JDvGkTuJPH\n\
TIHe/p3i/Ou4tmW9VTwFojqueR0aleJk7JthbZSLNYr1jAuy4Unbb7TWMdVC\n\
qYITrG2TD1gJy0kyXPn8urX2Uv1HfKq/DIa5ULjhqVsd2Nd8AajDlPPwIaYq\n\
0VYwvxg2LhWHprbyUTVu89ujTxZj812C3LiMGo2JIps2GxOuAcjjmeIzl3Zy\n\
Oz8SNBM20BUe5admyxB+un8Kp/Ek7It7pmlECIvJW5jOloVR/IHqngj+3pUp\n\
WsBDFAUnOn9O4uAcvevvwmY8JVt/bdo7G+XVMxkWz9uoMKkqr/7uLxnb1wge\n\
5M4kr4b5brG/IHi2xkiN37FtTpi/Ecybwy1hfsC8PnR8fjRjPcbwjub33tTJ\n\
eN8mv5uQvEbhEB42bV7IXdB/491uDum1eOCSG1xQDuTfdCi+MRNejPX3yuzn\n\
T0bbcvS34oR7n4G/VfC3Hvy5vS4OuFGKmxnOzSEnfrc8EJa8b7Rk4uo1Y50e\n\
J2YAHicGIBr+WTQll1LNvZyVQ1eOQ035sYt5gNh5ACID1lbpfQIiQGMeKeNY\n\
TNdiXGZ94AFxWzoXx00A4Dyz6VlXOcsdQzDg4aLO9BXucyp6hx+7nbOaJecj\n\
C5D1yZAp6vaYh9OouHorFnFbRZ3g/fOwwp2qr+3aTLU6UyvFbOPo+0x41xBX\n\
pGpou/C/leLwZ0pfsfFecYs7VelfZktxsimu1xLVet5KMGskbrbobssAzQGs\n\
nUSxvkhRLI/mpStXB3OAxFDWoTRfOsMaSGY9vZPLkMewzCi/NejyskvxK7ft\n\
2VshbS50YW/P2gnfNOnC3qPkbnNYzlxvsN1d2Fy+Z/W+9T1tq02eEOxD4VdD\n\
4lKyQ7346NjbbPLWo1ii3QnBmaquaDb3zkpxAPugh1VOz89wZHoo1ryRFS4d\n\
8UUlLsUEqbo1JpNwrivtLum5DpemM+zU/N+zZ4se9x/HKk9qOO2s3IhHb3dv\n\
xwE7dpLRpYErFjfHhrehHuB8eLkYplBDlJfRHksVx2sFl/XJQ6TbMtV7pRa5\n\
F0Pm0Xil65i6s0iqvE7B+6gq8XS1+XTVMl3Ri0bgv1Nhu1InW+k0LXQFdZys\n\
9Vtu9iFsiKKXgOujat0G3+dNNLczahZnufOVD1m92JmvfMEetkJU8EH0k2sp\n\
NHzLbvMUjj5Gv+pBMUzqdxYHYxW8usByYYZ2cp6foifN5cawJ83zsXKyHvsi\n\
J+OMmJPRfU65MYmNNRmG9r0D/afqZmtiZkyXlyUw1n5CEzcizk3sVveTNi4Z\n\
LeJv+zxp523KagldTdzqFM9men8dzV+/RnGLpa5bwc+RIYlHgfXLEG9Dtnax\n\
PvEIIdsN9qx631ep73Hp+Gula/33xJWupifO4ZVH/Qil5hjxVC5eqoOKm2Q6\n\
oz+cZ+PAMsK10Se2gUl8sPIRJig1VwPnvKosUFmRYmHOc4cyxcLuGPPeK7lR\n\
uVE6eo+6+Th6Fg7Xpssik32m6e10ocq30O1m8szhMudhi0IZMXGCuNrVIg52\n\
tL94OkjayZOmnyhdRyv7XbKuFeprEPWrd6abI92yTsZZ1gnz9cJCY87a7gs1\n\
C2UXvRjojhZ3hLun6kjZkm6iavedxszsW0fY5+p4bZSNQxdGt0bCr6Bd1O4x\n\
M7l3p9fmUhfwC9TfJfXbEt8+7VUvesrf5zrCXutusgQ3p4f3sEEiqvXquGdw\n\
n69menmTaNuzdzLAvelmJA4EbRV1+Gw16rQYr3RFLy+YbqXRZ0yfOdTYTz5N\n\
od+lt34jkn4/tsEHC8wMfZTGnCw1FO2GcHOUmY8/U5yrUzzXYlSsAdDDMSkG\n\
E3IZz6n48Zc6DoxTHHmVD3AzKmk9r+4rAy+q1yqrgChTVdADXXHAzT5KHFzD\n\
8xeTNKmyB7FkQK85saUZTzQr9I6TXg6TJw2U7S4eXiZWbpni1zMy71kGcBqp\n\
5ss8UIuS+H4v0QP8Js4vvBCIrnbnatu8bTNhEDV3GuIu87Xvu7xvirsIg2FM\n\
Pdu7vJcUNO/61WMgLQoAc7Ux2B3vp8Qz3h+oKd7xssWM1xz3Q8b9wGW5WvKL\n\
8fqN4/QmgV2zWQ3XqqUzrsV1fndVPY8gb6Ka3rfUs+hoM4DHkFnKTHNfwbmS\n\
+VA1Rw50Q5qqERpxOZGYjz0XZU1ZPj8T3VohZITL4V9aEktJcLwgWyNFVlKD\n\
s7uV+DYOKAzxaRWVaiNfG1ql6V+qMItbIEkL8xwc1UTGClu5S6G0aB5LMOjv\n\
QLwONfry1MVgADJAGgGjXbxNdT2Us5TPifVkOTHU3oJyEAPqFkxWkgbBkbfS\n\
40DYUHNetoxp7tYRuMN2EcXNg2Af4Ea5fJSyJMWd2gueB05/Z24XSH8VA+RR\n\
hbfygtclQL5bqIct2uKO19mzttdctkGWTkrbKWymKn0Mm91EbhfPeidcdhdj\n\
411EW3xckd230LhT5tUKj6HxU7TEa3WjDZICL2HxLMn0EP3oYowPUnKplILw\n\
UUJ4J2SWMfn50rPWgMkRIBskzIv+3tcsVO9Mp7LHHrVhykFPfvTI46NMY4/O\n\
L+bbU4wJ8+qdOc2bhgzUMPgkBqzL7HciixnwjfzQzgJN+JiDjDmVRvZSzLle\n\
DP9VzKAzJxp4gT1VysfGz5oyPi41u4fHSSgm7VuGP86Gjy7Mk4XFxNneGPnP\n\
s0Nsf2MW2AfTsOZi7gg8jDlngy/5SWD52+i1S27L+lVI/nq2G1RkJRfhKvZp\n\
ugBrHUnX75vZ4JyfucL+PnOMllceaM71mgos8XvOAXhcR71e8L+RVHJYT8/b\n\
bnaMZZJnVD73meR9r9PDlF8ipCbpq9EBZ3HzG5cdo751CZgL6G+d/e5zWTM/\n\
XGbHJ27PHXA39j5LInPY73vJkrkIlCvsP89Vd5cAV7vAeIqbnTUDTrxuznRX\n\
r9s7l/d2xeNWZ5HxIoN8Ut4F8sOY6ubeM9GXSYbG6Zm1nmWy3ifdr5NQEr3h\n\
zhXFiSzaFRZItC8/RksaA1xoYqzlhOAhWd4KjuPB8TaNWtYARjTgieccFuIe\n\
VnuEDfF8QUdi+wRObbGQqBczauBrm2FypFnaC78VgWPv+dn7lJiViiSTEyZy\n\
MER+TU26xB2ZH5BtfHb/4NiPpUsNtZuFYwEkm1BTZ3i2iKDQl8mDGLMTJ5u5\n\
AzzmVxc4XufNB93mmUffnV1ZWr69RQLYR/i75PU+kC9ov2XlPbnd94p6iZ9p\n\
oow67T6q173jefcvkWSANw2e6xPVuwB6pP31MQumrZnqC/HCf8xi6BH8uzrb\n\
5nJfd7NgNYF9lCe2H7I4ugqE4UU4LQXUR5032prkx4uu+KHG09rMJS96/gf3\n\
plrTFQbRf9d0LPnAZB+Da04HiILh1wXX7nK+iJHvNT8XAy/RltGR53kwZNIB\n\
fh4D52tW1hPQsHyQU4b8uIV6nW0BgmeY+bQtZ6+qVs3JOoQaLFwomFLu2JhA\n\
37z8XiW1o3Secs71i5CpLO/MgKbpeTLqn0RnmmTFpdx6MJ95vCx/HXeG4xix\n\
jcD0+51mGJqfn/pSpruL2pV3qFumIN+h2BA2yVd4vfj1x/r+WDGwX31fR0if\n\
hEOy37NwW9H3TjwNo38uZN8lfE1GTjnuPowuxA/O32mu3N7lyqU4+iFx/buU\n\
NlN1ffZd3jfYjy/eX/FpM1SKE+82SYBPZs7411jOFxKAPXYQAO9S7O1wRQtw\n\
2TSNZb+L8j/I8uTOdevjcG1Kl8vB7g38Rj16yV8fY3BZFk3IfPXiwWu9B89c\n\
PREetHhZXNEdYaLYVyU40bajGDvHhGDOMSJesNHKvItw91qF1KWXWMrpWl7y\n\
+KC7yS4vnbSw5kbRdnxlp480Gy1PCiil+QVOnPmvmBhl53bbmN2cLltFT0U5\n\
i+2iULGblSENDYl2Q1dG9D9D9fVjMsqbdOxxncQqXvqD4nP3A6JyjPgepwIP\n\
0ruhwvGi1N86J/3eOekz/5zi+8uUG7fKnHQxP45LnxNXuax3ezl0ffTvqeUY\n\
dwH2nc+bucvNekfnnXfWBMxfRas+D801XbM+ueevvp9+Tq+2MNL1PTX37nlk\n\
8vRaS08zXnPtXt5s6dubLcbg8RVyD+pw8eo4ofuvBeNDXZrxXTV5UavfWTKW\n\
mqpNBv8Lq/Q3x374MfZePuK5CUGrI04T90HQI2eQbznCFnNZX2GBb/QFtL1L\n\
Zt9fRtmWWZRt0MlvSy+V8hsrgxhL7/6/RwquCVZvlI+vBdO2SA5iuKYQ+vV3\n\
0WJOTJ6zLnluKaet80qaOdudHp7p4ChF11bjPAXW+snZPkqvlrLvzefDNGqR\n\
950SblgdXaazpr+AELPczNpokye0Fv+my2Lzm/L/YVnZG/qD6JarHu0FFuLw\n\
cfTKe4+cueO3SKaBoj72wbXsRRbFv5joQzXNc+7uqwzoJMMZd/e9Zb7u5NNs\n\
1DK/dWmuyRFvf/Nw+Xcz6YU1oe8f5zlxO0ffh45l7qPql9H1/D8fBpHGGyk5\n\
WY6kUeaCPzm2tr98qC/S4Lwd3kt5cbcpgp69jOrKT/zVS/xDiNcCfymAxLFX\n\
/b7Bjf2b6v9b1UOOD7xxlcQV5sVSQn/81zN9+Ah6UMaQvJP+GkD/Fkb+MGOV\n\
LIAHsebZmCfVG0q+ue/XL5skLF5dOL6bFe9eV9f4XY9deiMXjd/nTj2x4zkm\n\
X/Lrb5YO7/4Gpsf/FDa8Gotn+51faOVkd++nU6P9LgmIfWaod4zzWl5e/WmO\n\
/0xv76TXdLLaLZ3m7I3wLBG2ybLmmviW6ihHevbOSlv8lXL7Z/8N0qTycw==\n"], "Graphics", 
             ShowCellBracket -> False, 
             CellMargins -> {{0, 0}, {Inherited, 0}}, Evaluatable -> False, 
             ImageSize -> {350, 24}, ImageMargins -> {{0, 0}, {0, 0}}, 
             ImageRegion -> {{0, 1}, {0, 1}}]}, Closed]]}, Open]], 
      Cell[
       CellGroupData[{
         Cell["Styles for Headings", "Section"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Title"], ShowCellBracket -> False, 
             CellMargins -> {{60, 0}, {0, 5}}, PageBreakBelow -> False, 
             LineSpacing -> {0, 37}, 
             CounterAssignments -> {{"Section", 0}, {"Equation", 0}, {
               "Figure", 0}}, FontSize -> 36, FontTracking -> "Plain", 
             FontColor -> GrayLevel[0]], 
            Cell[
             StyleData["Title", "Printout"], CellMargins -> {{9, 0}, {0, 0}}, 
             FontSize -> 24, FontTracking -> "Plain"]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Subtitle"], ShowCellBracket -> False, 
             CellMargins -> {{60, 0}, {0, 5}}, PageBreakBelow -> False, 
             LineSpacing -> {1, 0}, 
             CounterAssignments -> {{"Section", 0}, {"Equation", 0}, {
               "Figure", 0}}, FontFamily -> "Helvetica", FontSize -> 14, 
             FontSlant -> "Italic", FontColor -> GrayLevel[0]], 
            Cell[
             StyleData["Subtitle", "Printout"], 
             CellMargins -> {{9, 0}, {0, 0}}, ParagraphIndent -> -85, 
             FontSize -> 16]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Subsubtitle"], ShowCellBracket -> False, 
             CellMargins -> {{60, 4}, {30, 10}}, PageBreakBelow -> False, 
             CounterAssignments -> {{"Section", 0}, {"Equation", 0}, {
               "Figure", 0}}, FontFamily -> "Helvetica", FontSize -> 12, 
             FontSlant -> "Italic"], 
            Cell[
             StyleData["Subsubtitle", "Printout"], 
             CellMargins -> {{9, 10}, {50, 10}}, FontSize -> 14]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Section"], CellFrame -> {{6, 0}, {0, 1}}, CellDingbat -> 
             None, CellMargins -> {{44, 0}, {10, 35}}, 
             CellGroupingRules -> {"SectionGrouping", 30}, PageBreakBelow -> 
             False, CellFrameMargins -> {{8, 4}, {0, 4}}, 
             LineSpacing -> {0, 22}, CounterIncrements -> "Section", 
             CounterAssignments -> {{"Subsection", 0}, {"Subsubsection", 0}}, 
             FontFamily -> "Times", FontSize -> 24, FontWeight -> "Bold", 
             FontSlant -> "Italic", FontColor -> 
             RGBColor[0.571389, 0.19675, 0.570504]], 
            Cell[
             StyleData["Section", "Printout"], 
             CellMargins -> {{9, 0}, {2, 50}}, 
             CellFrameMargins -> {{5, 4}, {0, 4}}, FontSize -> 14, 
             FontTracking -> "Plain", FontColor -> GrayLevel[0]]}, Open]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Subsection"], CellMargins -> {{60, 0}, {8, 10}}, 
             CellGroupingRules -> {"SectionGrouping", 40}, PageBreakBelow -> 
             False, CounterIncrements -> "Subsection", 
             CounterAssignments -> {{"Subsubsection", 0}}, FontFamily -> 
             "Helvetica", FontSize -> 16, FontWeight -> "Bold"], 
            Cell[
             StyleData["Subsection", "Printout"], 
             CellMargins -> {{9, 0}, {6, 40}}, FontSize -> 12]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Subsubsection"], CellDingbat -> "\[FilledSquare]", 
             CellMargins -> {{60, Inherited}, {8, 12}}, 
             CellGroupingRules -> {"SectionGrouping", 50}, PageBreakBelow -> 
             False, CellFrameLabelMargins -> 6, CounterIncrements -> 
             "Subsubsection", FontFamily -> "Times", FontSize -> 13, 
             FontWeight -> "Bold"], 
            Cell[
             StyleData["Subsubsection", "Printout"], 
             CellMargins -> {{22, 0}, {4, 20}}, FontSize -> 11]}, Closed]]}, 
        Open]], 
      Cell[
       CellGroupData[{
         Cell["Styles for Body Text", "Section"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Text"], CellMargins -> {{54, 25}, {6, 6}}, 
             CellFrameMargins -> {{4, 10}, {6, 0}}, CellFrameLabelMargins -> 
             4, TextJustification -> 1, LineSpacing -> {1.25, 0}, 
             CounterIncrements -> "Text", FontSize -> 14], 
            Cell[
             StyleData["Text", "Printout"], CellMargins -> {{9, 0}, {4, 4}}, 
             ParagraphSpacing -> {0, 6}]}, Open]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Commentary"], CellMargins -> {{60, 20}, {2, 8}}, 
             TextJustification -> 1, LineSpacing -> {1, 2}, FontFamily -> 
             "Helvetica", FontSize -> 12, FontColor -> RGBColor[0, 0, 0.4]], 
            Cell[
             StyleData["Commentary", "Printout"], 
             CellMargins -> {{9, 0}, {4, 4}}, LineSpacing -> {1, 3}, FontSize -> 
             8]}, Open]]}, Open]], 
      Cell[
       CellGroupData[{
         Cell["Styles for Input/Output", "Section"], 
         Cell[
         "The cells in this section define styles used for input and output \
to the kernel.  Be careful when modifying, renaming, or removing these \
styles, because the front end associates special meanings with these style \
names.", "Text"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Input"], CellFrame -> {{3, 0}, {0, 0}}, 
             CellMargins -> {{60, 20}, {0, 0}}, Evaluatable -> True, 
             CellGroupingRules -> "InputGrouping", CellHorizontalScrolling -> 
             True, PageBreakWithin -> False, GroupPageBreakWithin -> False, 
             CellLabelMargins -> {{23, Inherited}, {Inherited, Inherited}}, 
             CellFrameColor -> RGBColor[0.6, 0.2, 0], DefaultFormatType -> 
             DefaultInputFormatType, AutoItalicWords -> {}, FormatType -> 
             InputForm, ShowStringCharacters -> True, NumberMarks -> True, 
             CounterIncrements -> "Input", FontWeight -> "Bold", Background -> 
             RGBColor[1, 0.8, 0.4]], 
            Cell[
             StyleData["Input", "Printout"], CellFrame -> False, 
             CellMargins -> {{37, 0}, {6, 6}}, Background -> GrayLevel[0.8]]},
            Closed]], 
         Cell[
          StyleData["InlineInput"], Evaluatable -> True, CellGroupingRules -> 
          "InputGrouping", CellHorizontalScrolling -> True, PageBreakWithin -> 
          False, GroupPageBreakWithin -> False, DefaultFormatType -> 
          DefaultInputFormatType, AutoItalicWords -> {}, FormatType -> 
          InputForm, ShowStringCharacters -> True, NumberMarks -> True, 
          CounterIncrements -> "Input", FontWeight -> "Bold"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Output"], CellFrame -> {{3, 0}, {0, 0}}, 
             CellMargins -> {{60, 20}, {15, 0}}, CellEditDuplicate -> True, 
             CellGroupingRules -> "OutputGrouping", CellHorizontalScrolling -> 
             True, PageBreakWithin -> False, GroupPageBreakWithin -> False, 
             GeneratedCell -> True, CellAutoOverwrite -> True, 
             CellLabelMargins -> {{23, Inherited}, {Inherited, Inherited}}, 
             CellFrameColor -> RGBColor[0, 0.500008, 0.6], DefaultFormatType -> 
             DefaultOutputFormatType, AutoItalicWords -> {}, FormatType -> 
             InputForm, CounterIncrements -> "Output", Background -> 
             RGBColor[1, 0.900008, 0.900008]], 
            Cell[
             StyleData["Output", "Printout"], CellFrame -> False, 
             CellMargins -> {{37, 0}, {6, 2}}, Background -> 
             GrayLevel[0.900008]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Graphics"], CellFrame -> {{3, 0}, {0, 0}}, 
             CellMargins -> {{60, 20}, {0, 0}}, CellGroupingRules -> 
             "GraphicsGrouping", CellHorizontalScrolling -> True, 
             PageBreakWithin -> False, GeneratedCell -> True, 
             CellAutoOverwrite -> True, ShowCellLabel -> False, 
             CellFrameColor -> RGBColor[0, 0.6, 0.6], DefaultFormatType -> 
             DefaultOutputFormatType, FormatType -> InputForm, 
             CounterIncrements -> "Graphics", ImageSize -> {250, 250}, 
             Background -> RGBColor[1, 0.900008, 0.900008]], 
            Cell[
             StyleData["Graphics", "Printout"], CellFrame -> False, 
             CellMargins -> {{37, 0}, {6, 2}}, ImageSize -> {250, 250}, 
             ImageMargins -> {{28, Inherited}, {Inherited, 0}}]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Message"], 
             CellMargins -> {{72, 20}, {Inherited, Inherited}}, 
             CellGroupingRules -> "OutputGrouping", PageBreakWithin -> False, 
             GroupPageBreakWithin -> False, GeneratedCell -> True, 
             CellAutoOverwrite -> True, ShowCellLabel -> False, 
             CellLabelMargins -> {{23, Inherited}, {Inherited, Inherited}}, 
             DefaultFormatType -> DefaultOutputFormatType, FormatType -> 
             InputForm, StyleMenuListing -> None, FontColor -> 
             RGBColor[1, 0, 0]], 
            Cell[
             StyleData["Message", "Printout"], 
             CellMargins -> {{44, Inherited}, {Inherited, Inherited}}, 
             FontColor -> GrayLevel[0]]}, Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["Print"], 
             CellMargins -> {{72, 20}, {Inherited, Inherited}}, 
             CellGroupingRules -> "OutputGrouping", CellHorizontalScrolling -> 
             True, PageBreakWithin -> False, GroupPageBreakWithin -> False, 
             GeneratedCell -> True, CellAutoOverwrite -> True, ShowCellLabel -> 
             False, CellLabelMargins -> {{23, Inherited}, {
               Inherited, Inherited}}, DefaultFormatType -> 
             DefaultOutputFormatType, FormatType -> InputForm, 
             StyleMenuListing -> None], 
            Cell[
             StyleData["Print", "Printout"], 
             CellMargins -> {{44, Inherited}, {Inherited, Inherited}}]}, 
           Closed]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["CellLabel"], StyleMenuListing -> None, FontFamily -> 
             "Helvetica", FontSize -> 9, FontWeight -> "Plain", FontSlant -> 
             "Italic", FontTracking -> "Extended", FontColor -> 
             RGBColor[0, 0, 1]], 
            Cell[
             StyleData["CellLabel", "Printout"], FontFamily -> "Courier", 
             FontSize -> 8, FontSlant -> "Italic", FontColor -> 
             GrayLevel[0]]}, Open]]}, Open]], 
      Cell[
       CellGroupData[{
         Cell["Unique Styles", "Section"], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["DisplayText"], CellFrame -> 0.5, 
             CellMargins -> {{60, 20}, {15, 5}}, LineSpacing -> {0, 12}, 
             ParagraphSpacing -> {0, 6}, FontFamily -> "Helvetica", FontSize -> 
             14, FontWeight -> "Bold", FontSlant -> "Plain", Background -> 
             None], 
            Cell[
             StyleData["DisplayText", "Printout"], 
             CellMargins -> {{9, 0}, {4, 4}}, ParagraphSpacing -> {0, 6}, 
             FontSize -> 10, Background -> GrayLevel[0.900008]]}, Open]], 
         Cell[
          CellGroupData[{
            Cell[
             StyleData["PictureGroup"], CellFrame -> {{3, 0}, {0, 0}}, 
             CellMargins -> {{60, Inherited}, {0, 0}}, CellGroupingRules -> 
             "GraphicsGrouping", CellHorizontalScrolling -> True, 
             PageBreakWithin -> False, ShowCellLabel -> False, CellFrameColor -> 
             RGBColor[0, 0.6, 0.6], CounterIncrements -> "Graphics", 
             ImageSize -> {250, 250}, Background -> 
             RGBColor[1, 0.900008, 0.900008]], 
            Cell[
             StyleData["PictureGroup", "Printout"], CellFrame -> False, 
             CellMargins -> {{37, Inherited}, {6, 2}}, 
             ImageSize -> {250, 250}, 
             ImageMargins -> {{28, Inherited}, {Inherited, 0}}]}, Open]]}, 
        Open]], 
      Cell[
       CellGroupData[{
         Cell["Styles for Headers and Footers", "Section"], 
         Cell[
          StyleData["Header"], CellMargins -> {{0, 0}, {4, 1}}, 
          StyleMenuListing -> None, FontFamily -> "Helvetica", FontSize -> 9, 
          FontSlant -> "Italic"], 
         Cell[
          StyleData["Footer"], CellMargins -> {{0, 0}, {0, 4}}, 
          StyleMenuListing -> None, FontFamily -> "Helvetica", FontSize -> 6], 
         Cell[
          StyleData["PageNumber"], CellMargins -> {{0, 0}, {4, 1}}, 
          StyleMenuListing -> None, FontFamily -> "Helvetica", FontSize -> 9, 
          FontWeight -> "Bold"]}, Open]]}, Open]]}, Visible -> False, 
  FrontEndVersion -> "7.0 for Mac OS X x86 (32-bit) (November 10, 2008)", 
  StyleDefinitions -> "Default.nb"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[545, 20, 28, 3, 54, "Text"],
Cell[CellGroupData[{
Cell[598, 27, 291, 13, 180, "Text"],
Cell[892, 42, 118, 6, 54, "Text"],
Cell[1013, 50, 1271, 47, 185, "Text"]
}, Closed]],
Cell[2299, 100, 25, 3, 50, "Text"],
Cell[CellGroupData[{
Cell[2349, 107, 186, 7, 52, "Text"],
Cell[2538, 116, 706, 22, 185, "Text"],
Cell[3247, 140, 882, 22, 135, "Text"],
Cell[4132, 164, 692, 15, 110, "Text"],
Cell[4827, 181, 1010, 31, 110, "Text"],
Cell[5840, 214, 349, 14, 35, "Text"],
Cell[6192, 230, 918, 20, 135, "Text"],
Cell[7113, 252, 506, 18, 35, "Text"],
Cell[7622, 272, 367, 11, 35, "Text"]
}, Open  ]],
Cell[8004, 286, 25, 3, 54, "Text"],
Cell[CellGroupData[{
Cell[8054, 293, 187, 7, 52, "Text"],
Cell[8244, 302, 518, 15, 75, "Text"],
Cell[CellGroupData[{
Cell[8787, 321, 478, 19, 33, "Text"],
Cell[CellGroupData[{
Cell[9290, 344, 459, 15, 35, "Input"],
Cell[9752, 361, 600, 18, 53, "Output"]
}, Open  ]],
Cell[10367, 382, 295, 11, 32, "Text"],
Cell[CellGroupData[{
Cell[10687, 397, 519, 18, 35, "Input"],
Cell[11209, 417, 598, 18, 53, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11856, 441, 332, 13, 32, "Text"],
Cell[CellGroupData[{
Cell[12213, 458, 264, 8, 35, "Input"],
Cell[12480, 468, 1024, 34, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[13541, 507, 55, 1, 35, "Input"],
Cell[13599, 510, 2064, 60, 73, "Output"]
}, Open  ]],
Cell[15678, 573, 114, 3, 32, "Text"],
Cell[CellGroupData[{
Cell[15817, 580, 163, 5, 35, "Input"],
Cell[15983, 587, 711, 21, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16731, 613, 77, 2, 35, "Input"],
Cell[16811, 617, 366, 11, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17214, 633, 101, 3, 35, "Input"],
Cell[17318, 638, 221, 6, 58, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[17588, 650, 1976, 71, 126, "Text"],
Cell[CellGroupData[{
Cell[19589, 725, 141, 4, 35, "Input"],
Cell[19733, 731, 884, 28, 53, "Output"]
}, Open  ]],
Cell[20632, 762, 202, 8, 32, "Text"],
Cell[CellGroupData[{
Cell[20859, 774, 608, 18, 35, "Input"],
Cell[21470, 794, 1605, 44, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23112, 843, 60, 1, 35, "Input"],
Cell[23175, 846, 331, 8, 58, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[23555, 860, 356, 14, 42, "Subsubsection"],
Cell[23914, 876, 1116, 56, 58, "Text"],
Cell[CellGroupData[{
Cell[25055, 936, 572, 20, 44, "Input"],
Cell[25630, 958, 4059, 137, 157, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29726, 1100, 61, 1, 35, "Input"],
Cell[29790, 1103, 9097, 294, 291, "Output"]
}, Open  ]],
Cell[38902, 1400, 500, 21, 54, "Text"],
Cell[39405, 1423, 207, 7, 35, "Input"],
Cell[39615, 1432, 94, 5, 32, "Text"],
Cell[CellGroupData[{
Cell[39734, 1441, 61, 1, 35, "Input"],
Cell[39798, 1444, 4829, 158, 192, "Output"]
}, Open  ]],
Cell[44642, 1605, 48, 0, 32, "Text"],
Cell[CellGroupData[{
Cell[44715, 1609, 88, 2, 35, "Input"],
Cell[44806, 1613, 94, 1, 53, "Output"]
}, Open  ]],
Cell[44915, 1617, 92, 3, 35, "Input"]
}, Open  ]],
Cell[45022, 1623, 371, 13, 32, "Text"],
Cell[CellGroupData[{
Cell[45418, 1640, 2383, 84, 182, "Text"],
Cell[47804, 1726, 295, 9, 35, "Input"],
Cell[CellGroupData[{
Cell[48124, 1739, 85, 2, 35, "Input"],
Cell[48212, 1743, 198, 5, 53, "Output"]
}, Open  ]],
Cell[48425, 1751, 148, 5, 32, "Text"],
Cell[CellGroupData[{
Cell[48598, 1760, 75, 1, 35, "Input"],
Cell[48676, 1763, 234, 6, 53, "Output"]
}, Open  ]],
Cell[48925, 1772, 126, 3, 32, "Text"],
Cell[49054, 1777, 583, 19, 35, "Input"],
Cell[CellGroupData[{
Cell[49662, 1800, 496, 15, 35, "Input"],
Cell[50161, 1817, 149, 3, 53, "Output"]
}, Open  ]],
Cell[50325, 1823, 1711, 75, 96, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52073, 1903, 720, 25, 54, "Text"],
Cell[CellGroupData[{
Cell[52818, 1932, 149, 5, 35, "Input"],
Cell[52970, 1939, 203, 5, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53210, 1949, 139, 4, 35, "Input"],
Cell[53352, 1955, 424, 12, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53813, 1972, 242, 7, 35, "Input"],
Cell[54058, 1981, 328, 9, 53, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[54435, 1996, 590, 24, 54, "Text"],
Cell[55028, 2022, 378, 11, 35, "Input"],
Cell[CellGroupData[{
Cell[55431, 2037, 84, 2, 55, "Input"],
Cell[55518, 2041, 204, 5, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55759, 2051, 89, 2, 55, "Input"],
Cell[55851, 2055, 208, 5, 53, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[56108, 2066, 221, 8, 42, "Subsubsection"],
Cell[56332, 2076, 505, 19, 54, "Text"],
Cell[CellGroupData[{
Cell[56862, 2099, 246, 8, 35, "Input"],
Cell[57111, 2109, 1675, 49, 75, "Output"]
}, Open  ]],
Cell[58801, 2161, 251, 6, 32, "Text"],
Cell[59055, 2169, 254, 8, 55, "Input"],
Cell[59312, 2179, 144, 5, 32, "Text"],
Cell[CellGroupData[{
Cell[59481, 2188, 279, 9, 35, "Input"],
Cell[59763, 2199, 584, 17, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60384, 2221, 57, 1, 35, "Input"],
Cell[60444, 2224, 231, 6, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60712, 2235, 101, 3, 35, "Input"],
Cell[60816, 2240, 230, 6, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61083, 2251, 104, 3, 35, "Input"],
Cell[61190, 2256, 1126, 32, 58, "Output"]
}, Open  ]],
Cell[62331, 2291, 141, 3, 32, "Text"],
Cell[CellGroupData[{
Cell[62497, 2298, 152, 5, 35, "Input"],
Cell[62652, 2305, 600, 17, 58, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[63291, 2327, 25, 3, 54, "Text"],
Cell[CellGroupData[{
Cell[63341, 2334, 187, 7, 52, "Text"],
Cell[63531, 2343, 1307, 40, 96, "Text"],
Cell[CellGroupData[{
Cell[64863, 2387, 1341, 46, 96, "Text"],
Cell[CellGroupData[{
Cell[66229, 2437, 395, 13, 35, "Input"],
Cell[66627, 2452, 370, 10, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67034, 2467, 133, 4, 35, "Input"],
Cell[67170, 2473, 150, 3, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[67357, 2481, 63, 1, 35, "Input"],
Cell[67423, 2484, 92, 1, 53, "Output"]
}, Open  ]],
Cell[67530, 2488, 214, 6, 32, "Text"],
Cell[CellGroupData[{
Cell[67769, 2498, 548, 17, 35, "Input"],
Cell[68320, 2517, 561, 16, 53, "Output"]
}, Open  ]],
Cell[68896, 2536, 792, 35, 54, "Text"],
Cell[CellGroupData[{
Cell[69713, 2575, 199, 5, 35, "Input"],
Cell[69915, 2582, 250, 6, 53, "Output"]
}, Open  ]],
Cell[70180, 2591, 644, 24, 75, "Text"]
}, Open  ]],
Cell[70839, 2618, 466, 17, 54, "Text"],
Cell[CellGroupData[{
Cell[71330, 2639, 707, 35, 54, "Text"],
Cell[CellGroupData[{
Cell[72062, 2678, 445, 17, 32, "Text"],
Cell[CellGroupData[{
Cell[72532, 2699, 470, 15, 44, "Input"],
Cell[73005, 2716, 509, 15, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73551, 2736, 61, 1, 35, "Input"],
Cell[73615, 2739, 564, 17, 62, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[74240, 2763, 564, 23, 32, "Text"],
Cell[74807, 2788, 502, 14, 35, "Input"],
Cell[CellGroupData[{
Cell[75334, 2806, 79, 2, 55, "Input"],
Cell[75416, 2810, 689, 19, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[76142, 2834, 84, 2, 55, "Input"],
Cell[76229, 2838, 729, 19, 53, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[77007, 2863, 1333, 45, 118, "Text"],
Cell[CellGroupData[{
Cell[78365, 2912, 284, 8, 35, "Input"],
Cell[78652, 2922, 347, 9, 53, "Output"]
}, Open  ]],
Cell[79014, 2934, 305, 11, 32, "Text"],
Cell[79322, 2947, 828, 25, 35, "Input"],
Cell[CellGroupData[{
Cell[80175, 2976, 763, 26, 35, "Input"],
Cell[80941, 3004, 550, 15, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81528, 3024, 586, 20, 35, "Input"],
Cell[82117, 3046, 550, 15, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[82704, 3066, 704, 24, 35, "Input"],
Cell[83411, 3092, 548, 15, 62, "Output"]
}, Open  ]],
Cell[83974, 3110, 1391, 52, 75, "Text"],
Cell[85368, 3164, 321, 13, 32, "Text"],
Cell[CellGroupData[{
Cell[85714, 3181, 315, 11, 35, "Input"],
Cell[86032, 3194, 274, 8, 62, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[86355, 3208, 1661, 62, 139, "Text"],
Cell[CellGroupData[{
Cell[88041, 3274, 862, 28, 55, "Input"],
Cell[88906, 3304, 3672, 112, 111, "Output"]
}, Open  ]],
Cell[92593, 3419, 234, 6, 32, "Text"],
Cell[92830, 3427, 587, 20, 55, "Input"],
Cell[93420, 3449, 118, 3, 35, "Input"],
Cell[CellGroupData[{
Cell[93563, 3456, 33, 0, 35, "Input"],
Cell[93599, 3458, 3344, 103, 111, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[96980, 3566, 209, 6, 35, "Input"],
Cell[97192, 3574, 3801, 109, 125, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101030, 3688, 55, 1, 35, "Input"],
Cell[101088, 3691, 3765, 107, 111, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104890, 3803, 64, 1, 35, "Input"],
Cell[104957, 3806, 94, 1, 53, "Output"]
}, Open  ]],
Cell[105066, 3810, 420, 19, 32, "Text"],
Cell[CellGroupData[{
Cell[105511, 3833, 174, 5, 35, "Input"],
Cell[105688, 3840, 3806, 109, 125, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109531, 3954, 55, 1, 35, "Input"],
Cell[109589, 3957, 3771, 107, 111, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113397, 4069, 191, 5, 35, "Input"],
Cell[113591, 4076, 298, 8, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113926, 4089, 55, 1, 35, "Input"],
Cell[113984, 4092, 331, 9, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[114352, 4106, 133, 3, 35, "Input"],
Cell[114488, 4111, 4003, 115, 144, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[118528, 4231, 57, 1, 35, "Input"],
Cell[118588, 4234, 3971, 113, 130, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122596, 4352, 56, 1, 35, "Input"],
Cell[122655, 4355, 3969, 113, 130, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126661, 4473, 102, 2, 35, "Input"],
Cell[126766, 4477, 3969, 113, 130, "Output"]
}, Open  ]],
Cell[130750, 4593, 56, 1, 35, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[130843, 4599, 796, 29, 54, "Text"],
Cell[CellGroupData[{
Cell[131664, 4632, 81, 2, 35, "Input"],
Cell[131748, 4636, 146, 3, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131931, 4644, 83, 2, 35, "Input"],
Cell[132017, 4648, 125, 2, 53, "Output"]
}, Open  ]],
Cell[132157, 4653, 333, 12, 32, "Text"],
Cell[CellGroupData[{
Cell[132515, 4669, 211, 5, 35, "Input"],
Cell[132729, 4676, 637, 11, 26, "Message"],
Cell[133369, 4689, 243, 6, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133649, 4700, 83, 2, 35, "Input"],
Cell[133735, 4704, 127, 2, 53, "Output"]
}, Open  ]],
Cell[133877, 4709, 172, 8, 32, "Text"],
Cell[CellGroupData[{
Cell[134074, 4721, 211, 5, 35, "Input"],
Cell[134288, 4728, 639, 11, 26, "Message"],
Cell[134930, 4741, 243, 6, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135210, 4752, 938, 35, 54, "Text"],
Cell[CellGroupData[{
Cell[136173, 4791, 226, 6, 35, "Input"],
Cell[136402, 4799, 669, 11, 26, "Message"],
Cell[137074, 4812, 217, 5, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137328, 4822, 366, 11, 35, "Input"],
Cell[137697, 4835, 666, 11, 26, "Message"],
Cell[138366, 4848, 291, 7, 62, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[138718, 4862, 917, 31, 75, "Text"],
Cell[CellGroupData[{
Cell[139660, 4897, 81, 2, 35, "Input"],
Cell[139744, 4901, 855, 27, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[140636, 4933, 132, 4, 35, "Input"],
Cell[140771, 4939, 234, 6, 53, "Output"]
}, Open  ]],
Cell[141020, 4948, 117, 3, 35, "Input"],
Cell[141140, 4953, 107, 5, 32, "Text"],
Cell[CellGroupData[{
Cell[141272, 4962, 91, 2, 35, "Input"],
Cell[141366, 4966, 1397, 45, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142800, 5016, 91, 2, 35, "Input"],
Cell[142894, 5020, 1399, 45, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144330, 5070, 177, 4, 35, "Input"],
Cell[144510, 5076, 1617, 51, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146164, 5132, 119, 3, 35, "Input"],
Cell[146286, 5137, 510, 15, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146833, 5157, 169, 4, 35, "Input"],
Cell[147005, 5163, 1921, 60, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[148963, 5228, 117, 3, 35, "Input"],
Cell[149083, 5233, 269, 7, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[149389, 5245, 119, 3, 35, "Input"],
Cell[149511, 5250, 1363, 42, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150911, 5297, 124, 3, 35, "Input"],
Cell[151038, 5302, 1527, 47, 73, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[152614, 5355, 814, 26, 64, "Subsubsection"],
Cell[CellGroupData[{
Cell[153453, 5385, 208, 6, 35, "Input"],
Cell[153664, 5393, 892, 29, 62, "Output"]
}, Open  ]],
Cell[154571, 5425, 538, 20, 96, "Text"],
Cell[155112, 5447, 475, 14, 74, "Input"],
Cell[155590, 5463, 155, 8, 32, "Text"],
Cell[CellGroupData[{
Cell[155770, 5475, 208, 6, 35, "Input"],
Cell[155981, 5483, 302, 8, 53, "Output"]
}, Open  ]],
Cell[156298, 5494, 189, 6, 32, "Text"],
Cell[CellGroupData[{
Cell[156512, 5504, 1154, 37, 74, "Input"],
Cell[157669, 5543, 177, 4, 53, "Output"]
}, Open  ]],
Cell[157861, 5550, 553, 23, 54, "Text"]
}, Open  ]]
}, Open  ]],
Cell[158441, 5577, 25, 3, 54, "Text"],
Cell[CellGroupData[{
Cell[158491, 5584, 221, 7, 52, "Text"],
Cell[158715, 5593, 574, 21, 75, "Text"],
Cell[CellGroupData[{
Cell[159314, 5618, 127, 3, 42, "Subsection"],
Cell[159444, 5623, 766, 21, 96, "Text"],
Cell[160213, 5646, 318, 9, 35, "Input"],
Cell[CellGroupData[{
Cell[160556, 5659, 217, 7, 41, "Subsubsection"],
Cell[160776, 5668, 922, 33, 40, "Input"],
Cell[161701, 5703, 894, 28, 44, "Input"],
Cell[162598, 5733, 1011, 34, 55, "Input"],
Cell[CellGroupData[{
Cell[163634, 5771, 281, 8, 55, "Input"],
Cell[163918, 5781, 346, 10, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164301, 5796, 367, 11, 55, "Input"],
Cell[164671, 5809, 1149, 38, 88, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[165857, 5852, 493, 15, 55, "Input"],
Cell[166353, 5869, 1567, 57, 98, "Output"]
}, Open  ]],
Cell[167935, 5929, 129, 3, 35, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[168101, 5937, 242, 6, 35, "Input"],
Cell[168346, 5945, 2806, 92, 136, "Output"]
}, Open  ]],
Cell[171167, 6040, 750, 26, 35, "Input"],
Cell[171920, 6068, 93, 5, 32, "Text"],
Cell[CellGroupData[{
Cell[172038, 6077, 252, 7, 35, "Input"],
Cell[172293, 6086, 428, 12, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[172758, 6103, 206, 6, 35, "Input"],
Cell[172967, 6111, 218, 5, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173222, 6121, 82, 2, 35, "Input"],
Cell[173307, 6125, 213, 6, 58, "Output"]
}, Open  ]],
Cell[173535, 6134, 110, 5, 32, "Text"],
Cell[CellGroupData[{
Cell[173670, 6143, 176, 5, 35, "Input"],
Cell[173849, 6150, 1604, 58, 98, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[175490, 6213, 320, 9, 35, "Input"],
Cell[175813, 6224, 1017, 31, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[176867, 6260, 177, 5, 35, "Input"],
Cell[177047, 6267, 3929, 138, 165, "Output"]
}, Open  ]],
Cell[180991, 6408, 217, 7, 35, "Input"],
Cell[181211, 6417, 253, 8, 35, "Input"],
Cell[CellGroupData[{
Cell[181489, 6429, 72, 1, 32, "Text"],
Cell[CellGroupData[{
Cell[181586, 6434, 285, 9, 35, "Input"],
Cell[181874, 6445, 92, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182003, 6451, 285, 9, 35, "Input"],
Cell[182291, 6462, 92, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182420, 6468, 283, 9, 35, "Input"],
Cell[182706, 6479, 201, 5, 74, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182944, 6489, 282, 9, 35, "Input"],
Cell[183229, 6500, 585, 18, 82, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[183851, 6523, 283, 9, 35, "Input"],
Cell[184137, 6534, 738, 26, 89, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[184912, 6565, 283, 9, 35, "Input"],
Cell[185198, 6576, 776, 27, 89, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[186011, 6608, 282, 9, 35, "Input"],
Cell[186296, 6619, 844, 28, 88, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187177, 6652, 287, 9, 35, "Input"],
Cell[187467, 6663, 93, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[187597, 6669, 402, 12, 35, "Input"],
Cell[188002, 6683, 1125, 32, 82, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189164, 6720, 406, 12, 35, "Input"],
Cell[189573, 6734, 378, 11, 74, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[189988, 6750, 402, 12, 35, "Input"],
Cell[190393, 6764, 1074, 35, 91, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191504, 6804, 402, 12, 35, "Input"],
Cell[191909, 6818, 1098, 36, 91, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[193056, 6860, 49, 0, 32, "Text"],
Cell[CellGroupData[{
Cell[193130, 6864, 333, 7, 35, "Input"],
Cell[193466, 6873, 1640, 55, 93, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195143, 6933, 338, 7, 35, "Input"],
Cell[195484, 6942, 1902, 60, 85, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197423, 7007, 329, 7, 35, "Input"],
Cell[197755, 7016, 4526, 145, 154, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[202330, 7167, 80, 2, 35, "Input"],
Cell[202413, 7171, 110, 1, 53, "Output"]
}, Open  ]],
Cell[202538, 7175, 48, 0, 32, "Text"],
Cell[202589, 7177, 246, 7, 35, "Input"],
Cell[202838, 7186, 220, 6, 35, "Input"],
Cell[203061, 7194, 246, 7, 35, "Input"],
Cell[203310, 7203, 286, 8, 35, "Input"],
Cell[CellGroupData[{
Cell[203621, 7215, 80, 2, 35, "Input"],
Cell[203704, 7219, 110, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203851, 7225, 72, 1, 32, "Text"],
Cell[CellGroupData[{
Cell[203948, 7230, 320, 10, 35, "Input"],
Cell[204271, 7242, 92, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[204400, 7248, 320, 10, 35, "Input"],
Cell[204723, 7260, 94, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[204854, 7266, 336, 10, 35, "Input"],
Cell[205193, 7278, 93, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205323, 7284, 320, 10, 35, "Input"],
Cell[205646, 7296, 965, 31, 90, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[206648, 7332, 336, 10, 35, "Input"],
Cell[206987, 7344, 92, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207116, 7350, 320, 10, 35, "Input"],
Cell[207439, 7362, 1235, 37, 82, "Output"]
}, Open  ]],
Cell[208689, 7402, 325, 10, 35, "Input"],
Cell[209017, 7414, 325, 10, 35, "Input"],
Cell[209345, 7426, 325, 10, 35, "Input"],
Cell[CellGroupData[{
Cell[209695, 7440, 285, 8, 35, "Input"],
Cell[209983, 7450, 291, 9, 79, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210311, 7464, 117, 2, 35, "Input"],
Cell[210431, 7468, 92, 1, 53, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[210572, 7475, 67, 1, 32, "Text"],
Cell[CellGroupData[{
Cell[210664, 7480, 263, 7, 35, "Input"],
Cell[210930, 7489, 94, 1, 53, "Output"]
}, Open  ]],
Cell[211039, 7493, 478, 15, 35, "Input"],
Cell[CellGroupData[{
Cell[211542, 7512, 1022, 30, 55, "Input"],
Cell[212567, 7544, 1933, 52, 60, "Print"],
Cell[214503, 7598, 1757, 44, 62, "Print"],
Cell[216263, 7644, 1638, 44, 63, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[217950, 7694, 80, 2, 35, "Input"],
Cell[218033, 7698, 110, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[218180, 7704, 71, 1, 32, "Text"],
Cell[CellGroupData[{
Cell[218276, 7709, 248, 7, 35, "Input"],
Cell[218527, 7718, 92, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[218656, 7724, 248, 7, 35, "Input"],
Cell[218907, 7733, 92, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219036, 7739, 248, 7, 35, "Input"],
Cell[219287, 7748, 92, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219416, 7754, 248, 7, 35, "Input"],
Cell[219667, 7763, 92, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219796, 7769, 248, 7, 35, "Input"],
Cell[220047, 7778, 92, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220176, 7784, 248, 7, 35, "Input"],
Cell[220427, 7793, 90, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[220554, 7799, 80, 2, 35, "Input"],
Cell[220637, 7803, 110, 1, 53, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[220796, 7810, 64, 1, 32, "Text"],
Cell[CellGroupData[{
Cell[220885, 7815, 545, 16, 35, "Input"],
Cell[221433, 7833, 92, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[221562, 7839, 571, 17, 35, "Input"],
Cell[222136, 7858, 92, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222265, 7864, 571, 17, 35, "Input"],
Cell[222839, 7883, 92, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[222968, 7889, 80, 2, 35, "Input"],
Cell[223051, 7893, 109, 1, 53, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[223209, 7900, 67, 1, 32, "Text"],
Cell[CellGroupData[{
Cell[223301, 7905, 412, 12, 35, "Input"],
Cell[223716, 7919, 92, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[223845, 7925, 335, 9, 35, "Input"],
Cell[224183, 7936, 93, 1, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[224313, 7942, 452, 13, 35, "Input"],
Cell[224768, 7957, 155, 3, 53, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[224972, 7966, 80, 2, 35, "Input"],
Cell[225055, 7970, 109, 1, 53, "Output"]
}, Open  ]],
Cell[225179, 7974, 186, 5, 35, "Input"]
}, Open  ]],
Cell[225380, 7982, 306, 9, 54, "Text"],
Cell[CellGroupData[{
Cell[225711, 7995, 75, 1, 42, "Subsection"],
Cell[225789, 7998, 722, 25, 75, "Text"],
Cell[CellGroupData[{
Cell[226536, 8027, 189, 5, 35, "Input"],
Cell[226728, 8034, 254, 6, 53, "Output"]
}, Open  ]],
Cell[226997, 8043, 215, 7, 35, "Input"],
Cell[227215, 8052, 128, 5, 32, "Text"],
Cell[CellGroupData[{
Cell[227368, 8061, 137, 4, 35, "Input"],
Cell[227508, 8067, 179, 4, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227724, 8076, 162, 5, 35, "Input"],
Cell[227889, 8083, 662, 12, 26, "Message"],
Cell[228554, 8097, 163, 3, 53, "Output"]
}, Open  ]],
Cell[228732, 8103, 66, 0, 32, "Text"],
Cell[228801, 8105, 316, 10, 35, "Input"],
Cell[CellGroupData[{
Cell[229142, 8119, 32, 0, 35, "Input"],
Cell[229177, 8121, 163, 3, 53, "Output"]
}, Open  ]],
Cell[229355, 8127, 201, 8, 32, "Text"],
Cell[229559, 8137, 399, 11, 35, "Input"],
Cell[229961, 8150, 105, 5, 32, "Text"],
Cell[CellGroupData[{
Cell[230091, 8159, 154, 4, 35, "Input"],
Cell[230248, 8165, 211, 4, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[230496, 8174, 986, 34, 35, "Input"],
Cell[231485, 8210, 240, 5, 53, "Output"]
}, Open  ]],
Cell[231740, 8218, 122, 5, 32, "Text"],
Cell[231865, 8225, 255, 8, 35, "Input"],
Cell[232123, 8235, 98, 2, 32, "Text"],
Cell[CellGroupData[{
Cell[232246, 8241, 84, 2, 35, "Input"],
Cell[232333, 8245, 384, 10, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[232754, 8260, 180, 5, 35, "Input"],
Cell[232937, 8267, 422, 11, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[233396, 8283, 227, 7, 35, "Input"],
Cell[233626, 8292, 260, 7, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[233923, 8304, 158, 4, 35, "Input"],
Cell[234084, 8310, 398, 11, 62, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[234519, 8326, 192, 8, 42, "Subsubsection"],
Cell[CellGroupData[{
Cell[234736, 8338, 253, 8, 35, "Input"],
Cell[234992, 8348, 369, 11, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[235398, 8364, 185, 5, 35, "Input"],
Cell[235586, 8371, 1348, 40, 83, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[236971, 8416, 462, 15, 35, "Input"],
Cell[237436, 8433, 331, 10, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[237804, 8448, 359, 11, 35, "Input"],
Cell[238166, 8461, 327, 9, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[238530, 8475, 101, 2, 35, "Input"],
Cell[238634, 8479, 327, 9, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[238998, 8493, 130, 3, 35, "Input"],
Cell[239131, 8498, 121, 2, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[239289, 8505, 346, 11, 35, "Input"],
Cell[239638, 8518, 343, 10, 53, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[240020, 8533, 16, 0, 32, "Text"],
Cell[CellGroupData[{
Cell[240061, 8537, 84, 1, 42, "Subsection"],
Cell[240148, 8540, 187, 5, 35, "Input"],
Cell[240338, 8547, 75, 0, 32, "Text"],
Cell[CellGroupData[{
Cell[240438, 8551, 203, 5, 35, "Input"],
Cell[240644, 8558, 272, 6, 53, "Output"]
}, Open  ]],
Cell[240931, 8567, 135, 4, 35, "Input"],
Cell[241069, 8573, 78, 2, 35, "Input"],
Cell[241150, 8577, 446, 14, 55, "Input"],
Cell[241599, 8593, 512, 16, 35, "Input"],
Cell[242114, 8611, 61, 0, 32, "Text"],
Cell[CellGroupData[{
Cell[242200, 8615, 243, 8, 35, "Input"],
Cell[242446, 8625, 390, 11, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[242873, 8641, 243, 8, 35, "Input"],
Cell[243119, 8651, 390, 11, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[243546, 8667, 90, 2, 35, "Input"],
Cell[243639, 8671, 791, 24, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[244467, 8700, 120, 3, 35, "Input"],
Cell[244590, 8705, 1755, 48, 87, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[246382, 8758, 137, 3, 35, "Input"],
Cell[246522, 8763, 4605, 126, 135, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[251164, 8894, 157, 4, 35, "Input"],
Cell[251324, 8900, 11213, 309, 255, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[262574, 9214, 157, 4, 35, "Input"],
Cell[262734, 9220, 11211, 309, 255, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[273982, 9534, 230, 6, 35, "Input"],
Cell[274215, 9542, 40625, 1078, 762, "Output"]
}, Open  ]],
Cell[314855, 10623, 226, 6, 35, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[315130, 10635, 143, 3, 35, "Input"],
Cell[315276, 10640, 127, 2, 53, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

